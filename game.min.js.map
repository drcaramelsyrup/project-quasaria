{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/app.js","src/assets.js","src/objects/AreaTransitionWindow.js","src/objects/Argument.js","src/objects/ArgumentManager.js","src/objects/BattleUi.js","src/objects/Card.js","src/objects/Clickable.js","src/objects/ConversationManager.js","src/objects/DialogueWindow.js","src/objects/HealthBar.js","src/objects/Icon.js","src/objects/MemoryBankWindow.js","src/objects/NPC.js","src/objects/Placeable.js","src/objects/Player.js","src/objects/Room.js","src/objects/SaveButton.js","src/objects/Scrollbar.js","src/objects/Tactic.js","src/objects/Toast.js","src/states/Battleground.js","src/states/Boot.js","src/states/Credits.js","src/states/Game.js","src/states/GameOver.js","src/states/MainMenu.js","src/states/Preloader.js","src/states/index.js","src/utils/CustomActions.js","static/assets/areas.json","static/assets/items.json","static/assets/npcs.json","static/assets/tactics.json","static/assets/textstyles.json"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"game.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/*\n * `app` module\n * ============\n *\n * Provides the game initialization routine.\n */\n\n'use strict';\n\n// Import game states.\nvar states = require('./states');\n\nexports.init = function () {\n  var game = new Phaser.Game(800, 600, Phaser.AUTO);\n\n  // Dynamically add all required game states.\n  Object\n    .keys(states)\n    .forEach(function (key) {\n      game.state.add(key, states[key]);\n    });\n\n  game.state.start('Boot');\n\n  return game;\n};\n","/*\n * `assets` module\n * ===============\n *\n * Declares static asset packs to be loaded using the `Phaser.Loader#pack`\n * method. Use this module to declare game assets.\n */\n\n'use strict';\n\n// -- Splash screen assets used by the Preloader.\nexports.boot = [{\n  key: 'splash-screen',\n  type: 'image'\n}, {\n  key: 'progress-bar',\n  type: 'image'\n}];\n\nexports.main_menu = [{\n  key: 'quasaria-logo-MM',\n  type: 'image'\n}, {\n  key: 'continueButton',\n  type: 'image'\n}, {\n  key: 'menu_screen',\n  type: 'image',\n  url: 'backgrounds/menu_screen_scaled.png'\n}];\n\n\n// -- General assets used throughout the game.\nexports.game = [{\n  key: 'quasaria-logo',\n  type: 'image'\n}, {\n  key: 'shuttle',\n  type: 'image',\n  url: 'backgrounds/shuttle.png'\n}, {\n  key: 'hangar',\n  type: 'image',\n  url: 'backgrounds/hangar.png'\n}, {\n  key: 'medbay',\n  type: 'image',\n  url: 'backgrounds/medbay.png'\n}, {\n  key: 'listener',\n  type: 'image',\n  url: 'items/listener.png'\n}, {\n  key: 'note',\n  type: 'image',\n  url: 'items/note.png'\n}, {\n  key: 'biologistApproval',\n  type: 'image',\n  url: 'avatars/talvine.png'\n}, {\n  key: 'psychologistApproval',\n  type: 'image',\n  url: 'avatars/valken.png'\n}, {\n  key: 'shuttle-placeable',\n  type: 'image',\n  url: 'items/shuttle-placeable.png'\n}, {\n  key: 'vesper-npc',\n  type: 'image',\n  url: 'npcs/vesper.png'\n}, {\n  key: 'talvine-npc',\n  type: 'image',\n  url: 'npcs/talvine.png'\n}, {\n  key: 'valken-npc',\n  type: 'image',\n  url: 'npcs/valken.png'\n}, {\n  key: 'gleaming-shoal-npc',\n  type: 'image',\n  url: 'npcs/gleaming-shoal.png'\n}];\n\n// -- UI-specific assets.\nexports.ui = [{\n  key: 'dialogue-choice-button',\n  type: 'image',\n  url: 'ui/dialogue-choice-button.png'\n}, {\n  key: 'dialogue-panel',\n  type: 'image',\n  url: 'ui/dialogue-panel.png'\n}, {\n  key: 'toast',\n  type: 'image',\n  url: 'ui/toast.png'\n}, {\n  key: 'memory-bank-button',\n  type: 'image',\n  url: 'ui/memory-bank-button.png'\n}, {\n  key: 'memory-bank-icon',\n  type: 'image',\n  url: 'ui/memory-bank-icon.png'\n}, {\n  key: 'memory-bank-icon-mask',\n  type: 'image',\n  url: 'ui/memory-bank-icon-mask.png'\n}, {\n  key: 'memory-bank-next',\n  type: 'image',\n  url: 'ui/memory-bank-next.png'\n}, {\n  key: 'memory-bank',\n  type: 'image',\n  url: 'ui/memory-bank.png'\n}, {\n  key: 'saveButton',\n  type: 'image'\n}, {\n  key: 'button',\n  type: 'image',\n  url: 'ui/button.png'\n}, {\n  key: 'battle-background',\n  type: 'image',\n  url: 'ui/battle-background.png'\n}, {\n  key: 'battle-overlay',\n  type: 'image',\n  url: 'ui/battle-overlay-scaled.png'\n}, {\n  key: 'memory-bank-icon-fill',\n  type: 'image',\n  url: 'ui/memory-bank-icon-fill.png'\n}, {\n  key: 'companion-icon',\n  type: 'image',\n  url: 'ui/companion-icon.png'\n}, {\n  key: 'enemy-arg-icon',\n  type: 'image',\n  url: 'ui/enemy-arg-icon.png'\n}];\n\n// -- Conversation jsons and avatars.\nexports.conversations = [{\n  key: 'prologue01',\n  type: 'json',\n  url: 'conversations/prologue01.json'\n}, {\n  key: 'prologue02',\n  type: 'json',\n  url: 'conversations/prologue02.json'\n}, {\n  key: 'vesper01',\n  type: 'json',\n  url: 'conversations/vesper01.json'\n}, {\n  key: 'talvine01',\n  type: 'json',\n  url: 'conversations/talvine01.json'\n}, {\n  key: 'valken01',\n  type: 'json',\n  url: 'conversations/valken01.json'\n}, {\n  key: 'gleaming-shoal01',\n  type: 'json',\n  url: 'conversations/gleaming-shoal01.json'\n}, {\n  key: 'mysterious-voice',\n  type: 'image',\n  url: 'avatars/mysterious-voice.png'\n}, {\n  key: 'kismet',\n  type: 'image',\n  url: 'avatars/kismet.png'\n}, {\n  key: 'gleaming-shoal',\n  type: 'image',\n  url: 'avatars/gleaming-shoal.png'\n}, {\n  key: 'gleaming-shoal-portrait',\n  type: 'image',\n  url: 'avatars/gleaming-shoal-portrait.png'\n}, {\n  key: 'unknown-alien',\n  type: 'image',\n  url: 'avatars/gleaming-shoal-silhouette.png'\n}, {\n  key: 'vesper',\n  type: 'image',\n  url: 'avatars/vesper.png'\n}, {\n  key: 'talvine',\n  type: 'image',\n  url: 'avatars/talvine.png'\n}, {\n  key: 'valken',\n  type: 'image',\n  url: 'avatars/valken.png'\n}, {\n  key: 'invisible',\n  type: 'image',\n  url: 'avatars/invisible.png'\n}];\n\n// -- Sound effects and background music\nexports.sounds = [{\n  key: 'sunrise-from-orbit',\n  type: 'audio',\n  urls: ['music/Sunrise From Orbit (Demo).mp3']\n}, {\n  key: 'menu-theme-terraform',\n  type: 'audio',\n  urls: ['music/Terraforming-Begins_Looping.mp3']\n}, {\n  key: 'off-limits',\n  type: 'audio',\n  urls: ['music/Sector-Off-Limits_Looping.mp3']\n}, {\n  key: 'puzzle1',\n  type: 'audio',\n  urls: ['music/Puzzle-Game_Looping.mp3']\n}, {\n  key: 'puzzle2',\n  type: 'audio',\n  urls: ['music/Puzzle-Game-2_Looping.mp3']\n}, {\n  key: 'lostjungle',\n  type: 'audio',\n  urls: ['music/Lost-Jungle_Looping.mp3']\n}, {\n  key: 'cold-moon',\n  type: 'audio',\n  urls: ['music/Cold-Moon.mp3']\n}, {\n  key: 'correct-card',\n  type: 'audio',\n  urls: ['soundfx/positive/glow_med_L_to_R_002.wav']\n}, {\n  key: 'wrong-card',\n  type: 'audio',\n  urls: ['soundfx/negative/SW011_Alarms_construction-kit-element_081.wav']\n}, {\n  key: 'save-notification',\n  type: 'audio',\n  urls: ['soundfx/SFX-ARCADIA_Notification01.wav']\n}, {\n  key: 'swish-close',\n  type: 'audio',\n  urls: ['soundfx/13th-whoosh-swing-sound.mp3']\n}, {\n  key: 'swish-open',\n  type: 'audio',\n  urls: ['soundfx/swoosh-metal-rod-swing-sound-made-with-bamboo-stick.mp3']\n}, {\n  key: 'inventory-add',\n  type: 'audio',\n  urls: ['soundfx/SFX-ARCADIA_Error03.wav']\n}, {\n  key: 'marble-impact',\n  type: 'audio',\n  urls: ['soundfx/Rupture - Marble_Impacts_06.wav']\n}, {\n  key: 'success',\n  type: 'audio',\n  urls: ['soundfx/positive/success-1.wav']\n}, {\n  key: 'tap',\n  type: 'audio',\n  urls: ['soundfx/glass-tap.wav']\n}];\n\n// --logic battle placeholder images\n\nexports.logic_battle = [{\n  key: 'alien-stare',\n  type: 'image',\n  url: 'battle/alien-stare.png'\n}, {\n  key: 'greek-sphinx',\n  type: 'image',\n  url: 'battle/greek-sphinx.png'\n}, {\n  key: 'cyborg-face',\n  type: 'image',\n  url: 'battle/cyborg-face.png'\n}, {\n  key: 'curly-mask',\n  type: 'image',\n  url: 'battle/curly-mask.png'\n}, {\n  key: 'lunar-module',\n  type: 'image',\n  url: 'battle/lunar-module.png'\n}, {\n  key: 'fencer',\n  type: 'image',\n  url: 'battle/fencer.png'\n}, {\n  key: 'new-born',\n  type: 'image',\n  url: 'battle/new-born.png'\n}, {\n  key: 'saint-basil-cathedral',\n  type: 'image',\n  url: 'battle/saint-basil-cathedral.png'\n}, {\n  key: 'goblin-head',\n  type: 'image',\n  url: 'battle/goblin-head.png'\n}, {\n  key: 'xenobio',\n  type: 'image',\n  url: 'battle/xenobio.png'\n}, {\n  key: 'xenopsych',\n  type: 'image',\n  url: 'battle/xenopsych.png'\n}, {\n  key: 'quasaria-logo-fill',\n  type: 'image'\n}, {\n  key: 'battle01',\n  type: 'json',\n  url: 'battle/battle01.json'\n}, {\n  key: 'question-mark',\n  type: 'image',\n  url: 'ui/question-mark-button.png'\n}, {\n  key: 'sponsor',\n  type: 'image',\n  url: 'battle/sponsor.png'\n}, {\n  key: 'currency',\n  type: 'image',\n  url: 'battle/currency.png'\n}, {\n  key: 'emp',\n  type: 'image',\n  url: 'battle/emp.png'\n}, {\n  key: 'call-bluff',\n  type: 'image',\n  url: 'battle/call-bluff.png'\n}];\n","/*\n * AreaTransition\n * ===============\n *\n * UI window for area transition\n */\n\n'use strict';\n\nvar areas = require('../../static/assets/areas.json');\n\nmodule.exports = AreaTransitionWindow;\n\nfunction areaTransitionButtonToggle() {\n  // unresponsive while animating\n  if (this._isTweening)\n    return;\n\n  this._isTweening = true;\n  var timeToTween = 500;  // milliseconds\n\n  // hide panel\n  if (this.panel.visible) {\n    this._game.sound.play('swish-close');\n    this._game.add.tween(this.panel).to(\n        {x: 0 - this.panelWidth - this._memoryPadding}, timeToTween, Phaser.Easing.Exponential.Out, true\n      ).onComplete.add(\n        function () {\n          this.panel.visible = false;\n          this._isTweening = false;\n        }, this\n      );\n    return;\n  }\n\n  // show panel\n\n  // if memory bank window is open, close it\n  if (this._game.memoryBankWindow.panel.visible) {\n    this._game.memoryBankWindow.panel.visible = false;\n  }\n\n  this.panel.visible = true;\n  this.display();\n  //each time you press the button it should refresh the areas that it displays\n\n  this.panel.x = 0 - this.panelWidth - this._memoryPadding;\n  this._game.sound.play('swish-open');\n  this._game.add.tween(this.panel).to(\n      {x: this._baseX}, timeToTween, Phaser.Easing.Exponential.Out, true\n    ).onComplete.add(function () { this._isTweening = false; }, this);\n}\n\nfunction AreaTransitionWindow(game/*, ...args*/) {\n  Phaser.Group.call(this, game/*, ...args*/);\n\n  this._game = game;\n\n  // private members specifying margin and padding\n  this._memoryTextOriginX = 100;\n  this._memoryTextOriginY = 155;\n  this._memoryPadding = 32;\n  this._itemOriginX = 80;\n  this._itemOriginY = 25;\n  this._baseX = this._memoryPadding / 2;\n  this._baseY = this._memoryPadding * 2;\n\n  // memory bank window dimensions\n  this.panelHeight = game.height * 1/2 - this._memoryPadding / 2;\n  this.panelWidth = game.width - this._memoryPadding;\n  this._rowCapacity = 5;  // items per row\n  this._itemStart = 0;  // determines which row to show\n\n  // window-dependent private member dimensions\n  this._memoryTextWidth = this.panelWidth - 185;\n  this._itemPadding = this.panelWidth / 50;\n  this._nextOriginX = this.panelWidth - 55;\n  this._nextOriginY = 0;\n  this._prevOriginX = -18;\n  this._prevOriginY = 0;\n\n  /**\n   * Panel\n   */\n\n  game.slickUI.add(\n    this.panel = new SlickUI.Element.DisplayObject(\n      this._baseX, this._baseY, game.make.sprite(0,0, 'memory-bank'),\n      this.panelWidth, this.panelHeight));\n  this.panel.displayObject.width = this.panelWidth;\n  this.panel.displayObject.height = this.panelHeight;\n\n  // by default, not displayed\n  this.panel.visible = false;\n  this.panel.alpha = 0.8;\n\n  /**\n   * Toggle button\n   */\n  // until you click on the toggle button\n  game.slickUI.add(\n    this.toggleButton = new SlickUI.Element.DisplayObject(\n      this._memoryPadding,this._memoryPadding, game.make.button(0,0, 'button')));\n  // set scale such that width = 1/8 panel width\n  this.toggleButton.displayObject.scale.setTo(\n    (this.panelWidth / 8) / this.toggleButton.displayObject.width);\n  //this.toggleButton.x = game.width - this._memoryPadding - this.toggleButton.displayObject.width;\n  // show panel callback\n  this.toggleButton.events.onInputDown.add(areaTransitionButtonToggle, this);\n  this.toggleButton.alpha = 0.9;\n\n  var toggleStyle = { font: '14px Goudy Bookletter 1911', fill: '#48f2ff', boundsAlignH: 'center', boundsAlignV: 'middle'};\n  this.toggleButton.add(\n    this.toggleText = new SlickUI.Element.DisplayObject(0, 0, game.make.text(0, 0, 'AREAS', toggleStyle)));\n  this.toggleText.displayObject.setTextBounds(0, this.toastTextY, this.toggleButton.displayObject.width, this.toggleButton.displayObject.height);\n\n  /**\n   * Text - name and description\n   */\n  var nameTextStyle = { font: '14px Goudy Bookletter 1911', fill: '#48f2ff', wordWrap: true, wordWrapWidth: this._memoryTextWidth, fontWeight: 'bold', boundsAlignH: 'center' };\n  this.panel.add(\n    this.nameText = new SlickUI.Element.DisplayObject(\n      this._memoryTextOriginX,\n      this._memoryTextOriginY,\n      game.make.text(0,0, '', nameTextStyle), this._memoryTextWidth));\n  // for alignment purposes\n  var nameTextHeight = this.nameText.displayObject.getBounds().height;\n  this.nameText.displayObject.setTextBounds(0,0, this._memoryTextWidth, nameTextHeight);\n\n  var descTextStyle = { font: '14px Open Sans', fill: '#48f2ff', wordWrap: true, wordWrapWidth: this._memoryTextWidth, align: 'left' };\n  this.panel.add(\n    this.descText = new SlickUI.Element.DisplayObject(\n      this._memoryTextOriginX,\n      this._memoryTextOriginY + nameTextHeight,\n      game.make.text(0,0, '', descTextStyle), this._memoryTextWidth));\n\n  /**\n   * Bookkeeping\n   */\n  // are we currently animating?\n  this._isTweening = false;\n  this._itemDisplayObjects = []; // for deletion purposes\n  this._navButtons = [];\n  this.areasToShow = Object.keys(areas).filter(function(area) {\n    return areas[area]['navigable'] == true;\n  });\n}\n\nAreaTransitionWindow.prototype = Object.create(Phaser.Group.prototype);\nAreaTransitionWindow.prototype.constructor = AreaTransitionWindow;\n\n// Utility functions: instantly hide or show panel/UI\nAreaTransitionWindow.prototype.hidePanel = function () {\n  this.panel.visible = false;\n  this.panel.x = 0 - this.panelWidth - this._memoryPadding;\n};\n\nAreaTransitionWindow.prototype.disable = function () {\n  this.hidePanel();\n  this.toggleButton.visible = false;\n  this.toggleButton.inputEnabled = false;\n};\n\nAreaTransitionWindow.prototype.enable = function () {\n  this.hidePanel();\n  this.toggleButton.visible = true;\n  this.toggleButton.inputEnabled = true;\n  //not sure that this will re-add listeners\n};\n\nAreaTransitionWindow.prototype.display = function () {\n  this.cleanWindow();\n  this.displayAreas();\n  this.showNavButtons();\n};\n\nAreaTransitionWindow.prototype.cleanWindow = function () {\n  for (var i = 0; i < this._itemDisplayObjects.length; i++) {\n    var item = this._itemDisplayObjects[i];\n    item.container.displayGroup.removeAll(true);\n    item.container.displayGroup.destroy();\n  }\n  for (i = 0; i < this._navButtons.length; i++) {\n    var navButton = this._navButtons[i];\n    navButton.container.displayGroup.removeAll(true);\n    navButton.container.displayGroup.destroy();\n  }\n  this._itemDisplayObjects = [];\n  this._navButtons = [];\n};\n\nAreaTransitionWindow.prototype.displayAreas = function () {\n  this.areasToShow = Object.keys(areas).filter(function(area) {\n    let seen = this._game.player.seenAreas.includes(area);\n    //this filter will add rooms seen in the past that should be avaliable in the window\n    return areas[area]['navigable'] == true && this._game.room.name != area && seen;\n  }, this);\n  //this is going to leave things out, or have cycles\n  // we will have to think carefully when adding this information to the json\n  // do we want a given room to only appear if seen or do we want to have a group of\n  // rooms all navigable from one another?\n  // ie hanger must be reached first, but once there you have immediate access to talvine\n  for (let area of this._game.room.area.areaAccess){\n    if (!this.areasToShow.includes(area)){\n      this.areasToShow.push(area);\n    }\n  }\n\n  var itemEnd = this._itemStart + this._rowCapacity < this.areasToShow.length\n    ? this._itemStart + this._rowCapacity\n    : this.areasToShow.length;\n\n  for (var i = this._itemStart; i < itemEnd; i++) {\n    var itemId = this.areasToShow[i];\n\n    // scaled width = 1/7 panel width;\n    var desiredWidth = (this.panelWidth / 7);\n    var assetSprite = this._game.make.sprite(0,0, itemId);\n    assetSprite.scale.setTo(desiredWidth / assetSprite.width);\n\n    var maskSprite = this._game.make.sprite(0,0, 'memory-bank-icon-mask');\n    maskSprite.scale.setTo(desiredWidth / maskSprite.width);\n\n    var maskedBmd = this._game.make.bitmapData(maskSprite.width, maskSprite.height);\n    maskedBmd.alphaMask(assetSprite, maskSprite);\n\n    var itemSprite = this._game.make.sprite(0,0, maskedBmd);\n    var slickItem;\n    this.panel.add(slickItem = new SlickUI.Element.DisplayObject(\n      this._itemOriginX + (i - this._itemStart)*(this._itemPadding + itemSprite.width), this._itemOriginY,\n      itemSprite));\n\n    var borderSprite = this._game.make.sprite(0,0, 'memory-bank-icon');\n    borderSprite.scale.setTo(desiredWidth / borderSprite.width);\n    var slickBorder;\n    this.panel.add(slickBorder = new SlickUI.Element.DisplayObject(\n      this._itemOriginX + (i - this._itemStart)*(this._itemPadding + itemSprite.width), this._itemOriginY,\n      borderSprite));\n\n    itemSprite.inputEnabled = true;\n    itemSprite.input.useHandCursor = true;\n    itemSprite.events.onInputOver.add(function () {\n      this.nameText.displayObject.text = areas[this.itemId]['name'].toUpperCase();\n    }, {nameText: this.nameText, itemId: itemId});\n    itemSprite.events.onInputUp.add(function() {\n      this.game.room.loadArea(this.itemId);\n    }, {game: this._game, itemId: itemId});\n    itemSprite.events.onInputUp.add(areaTransitionButtonToggle, this);\n\n    this._itemDisplayObjects.push(slickItem);\n    this._itemDisplayObjects.push(slickBorder);\n  }\n};\n\nAreaTransitionWindow.prototype.showNavButtons = function () {\n\n  // next buttons\n  if (this._itemStart + this._rowCapacity < this.areasToShow.length) {\n    var nextButton = this._game.make.button(0,0,'memory-bank-next');\n    var slickNext;\n    this.panel.add(slickNext = new SlickUI.Element.DisplayObject(\n      this._nextOriginX, this._nextOriginY, nextButton));\n    // scaled by height, equal to panel height\n    nextButton.scale.setTo(this.panelHeight / nextButton.height);\n    this._navButtons.push(slickNext);\n\n    nextButton.events.onInputUp.add(function () {\n      this.switchRow(true);\n      this.display();\n    }, this);\n\n  }\n\n  // prev buttons\n  if (this._itemStart > 0) {\n    var prevButton = this._game.make.button(0,0,'memory-bank-next');\n    // rotate sprite\n    prevButton.anchor.setTo(0.5, 0.5);\n    prevButton.scale.y *= -1;\n    prevButton.anchor.setTo(1,1);\n\n    var slickPrev;\n    this.panel.add(slickPrev = new SlickUI.Element.DisplayObject(\n      this._prevOriginX, this._prevOriginY,\n      prevButton));\n    this._navButtons.push(slickPrev);\n\n    prevButton.scale.setTo(this.panelHeight / prevButton.height);\n\n    prevButton.events.onInputUp.add(function () {\n      this.switchRow(false);\n      this.display();\n    }, this);\n\n  }\n};\n\nAreaTransitionWindow.prototype.switchRow = function (wantsNextRow) {\n  if (wantsNextRow && this._itemStart + this._rowCapacity < this.areasToShow.length) {\n    this._itemStart += this._rowCapacity;\n    return;\n  }\n  if (!wantsNextRow && this._itemStart - this._rowCapacity >= 0) {\n    this._itemStart -= this._rowCapacity;\n    return;\n  }\n};\n\nAreaTransitionWindow.prototype.update = function () {\n  // TODO: Stub.\n};\n","'use strict';\n\n\nfunction Argument(game, x, y, assetName, match, jsonIdx) {\n  Phaser.Sprite.call(this, game, x, y, assetName);\n  this.assetName = assetName;\n  this.inputEnabled = true;\n  this.input.useHandCursor = true;\n  this.key = match;\n  this.jsonIdx = jsonIdx;\n  this.shown = false;\n}\n\nArgument.prototype = Object.create(Phaser.Sprite.prototype);\nmodule.exports = Argument.prototype.constructor = Argument;\n","/*\n * ArgumentManager\n * ===============\n *\n * Extension of ConversationManager for Logic Battles\n */\n\n'use strict';\n\nvar ConversationManager = require('./ConversationManager');\n\nmodule.exports = ArgumentManager;\n\nfunction ArgumentManager(game, customActions/*, ...args*/) {\n  // TODO:\n  //   1. Edit constructor parameters accordingly.\n  //   2. Adjust object properties.\n\n  ConversationManager.call(this, game, customActions);\n  this.nestedIdx = 0;\n  this.currentParams = [];\n\n  /* Signals */\n  this.specialCompleteSignal = new Phaser.Signal();\n  this.interludeCompleteSignal = new Phaser.Signal();\n\n  /* PRIVATE */\n  // TODO: remove companions from here!\n  this.specialArgumentTypes = ['ability', 'intro', 'custom', \n    'lose', 'win', 'gameover', 'credits'];\n\n}\nArgumentManager.prototype = Object.create(ConversationManager.prototype);\nArgumentManager.prototype.constructor = ArgumentManager;\n\nArgumentManager.prototype.update = function () {\n  // TODO: Stub.\n};\n\n/** BEGIN OVERRIDE FUNCTIONS */\nArgumentManager.prototype.getResponses = function () {\n  if (this.currentParams.length > 0) {\n    return [{ 'target': this.nestedIdx+1, 'text': '[Next]', 'params': this.currentParams }];\n  }\n\n  return [];\n};\n\nArgumentManager.prototype.advanceToTarget = function (targetIdx, params = []) {\n  // pass along current parameters\n  this.currentParams = params;\n  if (params.length > 0) {\n    if (this.specialArgumentTypes.includes(params[0])) {\n      var customType = params[0];\n      var custom = this.conversation[customType];\n\n      if (params.length >= 2) {\n        // Traverse through parameters\n        for (var i = 1; i < params.length; i++) {\n          if (params[i] in custom)\n            custom = custom[params[i]];\n        }\n      }\n\n      if (targetIdx in custom) {\n        this.nestedIdx = targetIdx;\n        return true;\n      }\n\n      // end of this conversation, go back to whatever we were doing\n      this.currentParams = [];\n      this.specialCompleteSignal.dispatch();\n      return false; // do NOT refresh display on end of special argument; DialogueWindow waits for a display call\n\n    } else if (params.length >= 2 && params[0] === 'interlude') {\n      var interludeType = params[1];\n      var argument = this.conversation[this.idx];\n\n      if (interludeType in argument && targetIdx in argument[interludeType]) {\n        this.nestedIdx = targetIdx;\n        return true;\n      }\n\n      this.endArgInterlude();\n      return false; // do NOT refresh display on end of argument interlude\n    }\n  }\n\n  this.idx = targetIdx;\n  return true;\n};\n\nArgumentManager.prototype.endConversation = function() {\n  this.customActions.customAction(this.conversation['onEnd']);  \n};\n\nArgumentManager.prototype.getAvatar = function () {\n  return 'invisible';\n};\n\nArgumentManager.prototype.getCurrentText = function () {\n  if (this.conversation === null)\n    return '';\n\n  var arg = this.getArgument();\n  if (arg === null)\n    return '';\n\n  return arg['text'];\n};\n\nArgumentManager.prototype.getSpeaker = function () {\n  if (this.conversation === null) {\n    return '';\n  }\n\n  var arg = this.getArgument();\n  if (arg === null)\n    return '';\n\n  return arg['speaker']; \n};\n/** END OVERRIDE FUNCTIONS */\n\nArgumentManager.prototype.getArgument = function () {\n  if (this.currentParams.length > 0) {\n    var params = this.currentParams;\n    if (this.specialArgumentTypes.includes(params[0])) {\n      // special argument\n      // support for multiple params\n      var customType = params[0];\n      var custom = this.conversation[customType];\n\n      if (params.length >= 2) {\n        // Traverse through parameters\n        for (var i = 1; i < params.length; i++) {\n          var param = params[i];\n          if (param in custom) {\n            custom = custom[param];\n          }\n        }\n      }\n\n      return custom[this.nestedIdx];\n\n    } else if (params.length >= 2 && params[0] === 'interlude') {\n      // interlude\n      return this.conversation[this.idx][params[1]][this.nestedIdx];\n    }\n  }\n\n  return this.conversation[this.idx];\n};\n\nArgumentManager.prototype.startInterlude = function (type) {\n  this.nestedIdx = 0;\n  this.currentParams = ['interlude', type];\n};\n\nArgumentManager.prototype.endArgInterlude = function () {\n  this.nestedIdx = 0;\n  this.currentParams = [];\n  this.interludeCompleteSignal.dispatch();\n};\n\nArgumentManager.prototype.startSpecialArgument = function (/*... arguments*/) {\n  this.nestedIdx = 0;\n  for (var i = 0; i < arguments.length; i++)\n    this.currentParams.push(arguments[i]);\n};\n\nArgumentManager.prototype.getCurrentCounters = function () {\n  return this.conversation[this.idx]['counters'];\n};\n\nArgumentManager.prototype.isNumberProperty = function (property) {\n  var n = Math.floor(Number(property));\n  return String(n) == property;\n};\n\nArgumentManager.prototype.getAllArguments = function () {\n  // returns as an array\n  var args = [];\n  var keys = Object.keys(this.conversation);\n  var prop;\n  for (prop in keys) {\n    if (this.isNumberProperty(prop) && prop in this.conversation) {\n      args.push(this.conversation[prop]);\n    }\n  }\n  return args;\n};\n\nArgumentManager.prototype.getAllAbilities = function () {\n  var abilities = [];\n  if ('abilities' in this.conversation) {\n    var i;\n    for (i in this.conversation['abilities']) {\n      abilities.push(this.conversation['abilities'][i]);\n    }\n  }\n  return abilities;\n};\n\nArgumentManager.prototype.setArgumentById = function (id) {\n  for (var i = 0; i < this.conversation.length; i++) {\n    if (this.conversation[i]['id'] === id) {\n      this.idx = i;\n      return;\n    }\n  }\n};\n\nArgumentManager.prototype.takeActions = function() {\n  var argument = this.getArgument();\n  if (argument === null)\n    return '';\n\n  if ('actions' in argument) {\n    for (var action in argument['actions']) {\n      ConversationManager.prototype.takeAction.call(this, this._game, action, argument['actions'][action]);\n    }\n  }\n};","/*\n * BattleUi\n * ========\n *\n * User interface for Logic Battle mechanic\n */\n\n'use strict';\n\nmodule.exports = BattleUi;\n\nvar HealthBar = require('./HealthBar.js');\nvar Icon = require('./Icon');\nvar textstyles = require('../../static/assets/textstyles.json');\nvar npcs = require('../../static/assets/npcs.json');\n\nfunction BattleUi(game, playerDeck, enemyDeck/*, ...args*/) {\n  Phaser.Group.call(this, game/*, ...args*/);\n\n  // - this.cardSignal\n  // - this.cardAnimCompleteSignal\n  // - this.argAnimCompleteSignal\n  // - this.playerDeckIcons\n  // - this.enemyDeckIcons\n  // - this.credBar\n\n  /** Signals */\n  this.cardSignal = new Phaser.Signal();\n  this.companionSignal = new Phaser.Signal();\n  this.cardAnimCompleteSignal = new Phaser.Signal();\n  this.argAnimCompleteSignal = new Phaser.Signal();\n\n  this.playerDeckIcons = [];\n  this.enemyDeckIcons = [];\n  this.companionIcons = [];\n\n  /** Private properties */\n  this._game = game;\n  this._portraitSize = 100;\n  this._cardWidth = 70;\n  this._cardHeight; // unspecified\n  this._credSize = 85;\n  this._enemyOriginY = game.height * 0.3;\n  this._centerX = game.width / 2;\n  this._argumentRadius = this._portraitSize;\n  this._playerIconsPerRow = 4;\n\n  /** Background + overlay (this._background, this._overlay) */\n  var roomBg = game.make.sprite(0,0, game.room.area.id);\n  game.add.existing(roomBg);\n\n  this._background = game.add.sprite(0,0,'battle-background');\n  this._background.width = game.width;\n  this._background.height = game.height;\n  this._background.alpha = 0.85;\n\n  this._overlay = game.add.sprite(0,0,'battle-overlay');\n  this._overlay.width = game.width;\n  this._overlay.height = game.height;\n  // hide overlay initially\n  this._overlay.alpha = 0;\n\n  /** Enemy display */\n  var enemyBarConfig = {x: this._centerX, y: 50, height:20, width:150, flipped:true};\n  this.persuadeBar = new HealthBar(game, enemyBarConfig);\n  var enemyIcon = game.add.existing(new Icon(game,\n    this._centerX - this._portraitSize/2, this._enemyOriginY - this._portraitSize/2,\n    'gleaming-shoal-portrait', null, null, this._portraitSize));\n  enemyIcon.alpha = 1;\n\n  /** Enemy deck display */\n  for (var i = 0; i < enemyDeck.length; i++) {\n\n    var argIcon = game.add.existing(new Icon(game, 0,0,\n      'question-mark', 'memory-bank-icon-mask', 'enemy-arg-icon', this._cardWidth));\n\n    this.enemyDeckIcons.push({'id': enemyDeck[i].assetName, 'icon': argIcon});\n\n  }\n  this.positionArguments(game, false);\n\n  /* Current argument position marker */\n  var currentArgMarker = game.add.sprite(0, 0, 'enemy-arg-icon');\n  currentArgMarker.scale.setTo(this._cardWidth * 1.2 / currentArgMarker.width);\n  currentArgMarker.anchor.setTo(0.5, 0.5);\n\n  currentArgMarker.x = this._centerX;\n  currentArgMarker.y = this._enemyOriginY + this._argumentRadius;\n\n  /** Player display */\n  this.credIcon = new SlickUI.Element.DisplayObject(\n    this._centerX - this._credSize/2, game.height * 5 / 8 - this._credSize / 2,\n    new Icon(game, 0,0,\n    'memory-bank-icon-mask', null, 'memory-bank-icon', this._credSize));\n  game.slickUI.add(this.credIcon);\n  this._cardHeight = this.credIcon.displayObject.height;\n\n  this.credIcon.add(\n    this.credText = new SlickUI.Element.DisplayObject(0, 0,\n      game.make.text(0, 0, ''+this._game.cred, textstyles['credibility']))\n  );\n  this.credText.displayObject.setTextBounds(0, 0, this._credSize, this.credIcon.displayObject.height);\n\n  /** Player deck display */\n  for (i = 0; i < playerDeck.length; i++) {\n    this.makeCardIcon(playerDeck[i]);\n  }\n\n  /** Companion display */\n  for (i = 0; i < game.companions.length; i++) {\n    var companionName = npcs[game.companions[i]]['name'];\n    var companionAvatar = npcs[game.companions[i]]['avatar'];\n    var companionIcon = game.add.existing(new Icon(game, 0,0,\n      companionAvatar, 'memory-bank-icon-mask', 'companion-icon', this._cardWidth));\n    companionIcon.borderSprite.tint = 0x00ffff;\n    companionIcon.x = game.width * 1/5 + i*(this._cardWidth);\n    companionIcon.y = this.credIcon.y - this._cardWidth / 2;\n\n    var companionSignal = this.companionSignal;\n    companionIcon.events.onInputDown.add(function () {\n      companionSignal.dispatch(this.game, this.companionName);\n    }, {game: game, companionName: companionName});\n\n    companionIcon.inputEnabled = true;\n    companionIcon.input.useHandCursor = true;\n\n    this.companionIcons.push(companionIcon);\n  }\n\n}\n\nBattleUi.prototype = Object.create(Phaser.Group.prototype);\nBattleUi.prototype.constructor = BattleUi;\n\nBattleUi.prototype.update = function () {\n  // TODO: Stub.\n};\n\nBattleUi.prototype.makeCardIcon = function (card) {\n  var deckOriginX = this._game.width * 3 / 5;\n  var deckOriginY = this.credIcon.y + (this._credSize - this._cardWidth) / 2;\n\n  var iconIdx = this.playerDeckIcons.length;\n\n  // otherwise, make a new card icon\n  var playerCardIcon = this._game.add.existing(new Icon(this._game, 0,0,\n    card.assetName, 'memory-bank-icon-mask', 'memory-bank-icon', this._cardWidth));\n  playerCardIcon.x = deckOriginX + iconIdx%this._playerIconsPerRow * this._cardWidth;\n  playerCardIcon.y = deckOriginY - Math.floor(iconIdx/this._playerIconsPerRow) * this._cardHeight;\n\n  var cardSignal = this.cardSignal;\n  // send signal upon click and delete tooltip\n  playerCardIcon.events.onInputDown.add(function () {\n    cardSignal.dispatch(this.game, this.currentCard);\n  }, {game: this._game, currentCard: card});\n\n  playerCardIcon.inputEnabled = true;\n  playerCardIcon.input.useHandCursor = true;\n\n  this.playerDeckIcons.push(playerCardIcon);\n  this.addTooltip(card, iconIdx,\n    this._centerX + this._argumentRadius, this._enemyOriginY - this._argumentRadius);\n  return playerCardIcon;\n};\n\nBattleUi.prototype.getArgIcon = function (argument) {\n  for (var i = 0; i < this.enemyDeckIcons.length; i++) {\n    var argIconWithIdx = this.enemyDeckIcons[i];\n    if (argument.assetName === argIconWithIdx['id']) {\n      return {'index': i, 'id': argIconWithIdx['id'], 'icon': argIconWithIdx['icon']};\n    }\n  }\n  return {'index': -1, 'icon': null};\n};\n\nBattleUi.prototype.revealCurrent = function () {\n  var currentIconWithId = this.enemyDeckIcons[0];\n  currentIconWithId['icon'] = this.revealArgIcon(\n    currentIconWithId['id'], currentIconWithId['icon']);\n};\n\nBattleUi.prototype.revealArgIcon = function (id, argIcon) {\n  var trash = argIcon;\n  var newIcon = this._game.add.existing(new Icon(this._game, 0,0,\n    id, 'memory-bank-icon-mask', 'enemy-arg-icon', this._cardWidth));\n  newIcon.x = argIcon.x;\n  newIcon.y = argIcon.y;\n  this._game.world.swap(argIcon, newIcon);  // swap display ordering\n  trash.destroy();\n  return newIcon;\n};\n\nBattleUi.prototype.getCardIcon = function (card) {\n  for (var i = 0; i < this.playerDeckIcons.length; i++) {\n    var cardIcon = this.playerDeckIcons[i];\n    if (card.key === cardIcon.id) {\n      return {'index': i, 'icon': cardIcon};\n    }\n  }\n  return {'index': -1, 'icon': null};\n};\n\nBattleUi.prototype.startCorrectCardTween = function (cardIcon, cardIdx, targetedArg) {\n  //this sounds best when it starts at click\n  this._game.sound.play('correct-card');\n  var tween = this._game.add.tween(cardIcon);\n  tween.to(\n    { x: targetedArg.x, y: targetedArg.y }, 1000,\n    Phaser.Easing.Exponential.In, true, 0);\n\n  // create fill sprite\n\n  var shatterSprite = this._game.make.sprite(\n    targetedArg.x + targetedArg.width/2,\n    targetedArg.y + targetedArg.height/2, 'memory-bank-icon-fill');\n  shatterSprite.alpha = 0;\n  // add slight fudge factor\n  shatterSprite.scale.setTo(this._cardWidth*1.05 / shatterSprite.width);\n  shatterSprite.anchor.setTo(0.5, 0.5);\n  this._game.add.existing(shatterSprite);\n  var alphaTween = this._game.add.tween(shatterSprite);\n\n  // start alpha tween after\n  tween.onComplete.add(function () {\n    alphaTween.to({ alpha: 1 }, 1000, Phaser.Easing.Exponential.In, true, 0);\n    alphaTween.onComplete.add(function () {\n      cardIcon.destroy();\n      targetedArg.destroy();\n      shatterSprite.destroy();\n      // arguments update by themselves, player cards do not\n      this.playerDeckIcons.splice(cardIdx, 1);\n    }, this);\n  }, this);\n\n  // return the last tween in the chain\n  return alphaTween;\n};\n\nBattleUi.prototype.startIncorrectCardTween = function (cardIcon, targetedArg) {\n  var tween = this._game.add.tween(cardIcon);\n  var originX = cardIcon.x;\n  var originY = cardIcon.y;\n\n  tween.to({ x: targetedArg.x, y: targetedArg.y }, 1000,\n    Phaser.Easing.Exponential.InOut, false, 0);\n  // add an additional tween to return to original position\n  tween.onComplete.add(function () {\n    this._game.sound.play('wrong-card');\n\n  }, this);\n\n  var lastTween = this._game.add.tween(cardIcon);\n  lastTween.to({ x: originX, y: originY }, 1000,\n    Phaser.Easing.Exponential.In, false, 0);\n\n  tween.chain(lastTween).start();\n\n  // return last tween in the chain\n  return lastTween;\n};\n\nBattleUi.prototype.playCardAnimation = function (card, argument, isCorrect) {\n  // find matching argument icon\n  var targetedArg = undefined;\n  for (var i = 0; i < this.enemyDeckIcons.length; i++) {\n    var argIconId = this.enemyDeckIcons[i]['id'];\n    if (argument.assetName === argIconId) {\n      targetedArg = this.enemyDeckIcons[i]['icon'];\n      break;\n    }\n  }\n  if (typeof targetedArg === 'undefined')\n    return;\n\n  // find matching card icon\n  for (i = 0; i < this.playerDeckIcons.length; i++) {\n    var cardIcon = this.playerDeckIcons[i];\n    if (card.key === cardIcon.id) {\n      var lastTween;\n      // play different animations on correct vs. incorrect card\n      if (isCorrect) {\n        lastTween = this.startCorrectCardTween(cardIcon, i, targetedArg);\n      } else {\n        lastTween = this.startIncorrectCardTween(cardIcon, targetedArg);\n      }\n      lastTween.onComplete.add(function () {\n        if (card.multiUse && isCorrect)\n          this.makeCardIcon(card);\n        this.cardAnimCompleteSignal.dispatch(this._game);\n\n      }, this);\n      return;\n    }\n  }\n};\n\nBattleUi.prototype.updateArguments = function (args, currentArgIdx) {\n  var newEnemyDeckIcons = [];\n\n  for (var i = 0; i < args.length; i++) {\n    var idx = currentArgIdx + i;\n    if (idx >= args.length)\n      idx -= args.length;\n\n    // null argument\n    if (typeof args[idx] === 'undefined' || args[idx] === null)\n      continue;\n\n    var argIconWithId = this.getArgIcon(args[idx]);\n    // not found\n    if (argIconWithId['index'] === -1) {\n      // add a new argument icon\n      argIconWithId['id'] = args[idx]['assetName'];\n      argIconWithId['icon'] = this._game.add.existing(new Icon(this._game, 0,0,\n        'question-mark', 'memory-bank-icon-mask', 'enemy-arg-icon', this._cardWidth));\n      // TODO: hardcoded as center right now.\n      argIconWithId['icon'].x = this._centerX - this._cardWidth/2;\n      argIconWithId['icon'].y = this._enemyOriginY - this._cardWidth/2;\n    }\n    newEnemyDeckIcons.push({\n      'id': argIconWithId['id'], \n      'icon': argIconWithId['icon']\n    });\n  }\n\n  this.enemyDeckIcons = newEnemyDeckIcons;\n};\n\nBattleUi.prototype.positionArguments = function (game, isTweening = true) {\n  var nArgs = this.enemyDeckIcons.length;\n  var argIcon;\n\n  if (!isTweening) {\n    for (var i = 0; i < nArgs; i++) {\n      argIcon = this.enemyDeckIcons[i]['icon'];\n      argIcon.x = this._centerX + Math.sin(i / nArgs * 2*Math.PI) * this._argumentRadius - this._cardWidth / 2;\n      argIcon.y = this._enemyOriginY + Math.cos(i / nArgs * 2*Math.PI) * this._argumentRadius - this._cardWidth / 2;\n    }\n    return;\n  }\n\n  var tweeningPositions = [];\n  var tweens = [];\n  for (var j = 0; j < nArgs; j++) {\n    tweeningPositions.push(\n      new Phaser.Point(\n        this._centerX + Math.sin(j / nArgs * 2*Math.PI) * this._argumentRadius - this._cardWidth / 2,\n        this._enemyOriginY + Math.cos(j / nArgs * 2*Math.PI) * this._argumentRadius - this._cardWidth / 2));\n  }\n  for (j = 0; j < nArgs; j++) {\n    argIcon = this.enemyDeckIcons[j]['icon'];\n    if (typeof argIcon === 'undefined' || argIcon === null)\n      continue;\n    tweens.push(game.add.tween(argIcon).to(\n      { x: tweeningPositions[j].x, y: tweeningPositions[j].y},\n      1000, Phaser.Easing.Quadratic.InOut, false, 0));\n  }\n  for (j = 0; j < tweens.length; j++) {\n    // Notify completion of argument rotation\n    if (j === 0) {\n      tweens[j].onComplete.add(function () {\n        this.argAnimCompleteSignal.dispatch(this._game);\n      }, this);\n    }\n    tweens[j].start();\n  }\n};\n\n/* Gives the impression of arguments randomizing. */\nBattleUi.prototype.rouletteArguments = function () {\n  var lastTween = null;\n  for (var i = 0; i < this.enemyDeckIcons.length; i++) {\n    lastTween = this._game.add.tween(this.enemyDeckIcons[i]['icon']).to(\n      { x: this._centerX - this._cardWidth/2, y: this._enemyOriginY - this._cardWidth/2}, \n      1000, Phaser.Easing.Quadratic.InOut, true, 0);\n  }\n  return lastTween;\n};\n\nBattleUi.prototype.positionCards = function () {\n  var deckOriginX = this._game.width * 3 / 5;\n  var deckOriginY = this.credIcon.y + (this._credSize - this._cardWidth) / 2;\n\n  for (var i = 0; i < this.playerDeckIcons.length; i++) {\n    var tween = this._game.add.tween(this.playerDeckIcons[i]);\n    tween.to({x: deckOriginX + i%this._playerIconsPerRow * this._cardWidth,\n      y: deckOriginY - Math.floor(i/this._playerIconsPerRow) * this._cardHeight},\n      300, Phaser.Easing.Quadratic.InOut, true, 0);\n  }\n};\n\nBattleUi.prototype.battleStart = function () {\n  this.cardsInputEnabled(true);\n  this.revealCurrent();\n};\n\nBattleUi.prototype.introTweens = function () {\n  var tweenTime = 500;\n  this.tweenInOverlay(tweenTime);\n  return this.tweenInBackgroundTint(tweenTime);\n};\n\nBattleUi.prototype.tweenInOverlay = function (tweenTime) {\n  var tween = this._game.add.tween(this._overlay);\n  tween.to( {alpha: 1}, tweenTime, Phaser.Easing.Exponential.In, true, 0);\n  return tween;\n};\n\nBattleUi.prototype.tweenInBackgroundTint = function (tweenTime) {\n  var tween = this._game.add.tween(this._background);\n  tween.to( {tint: 0x33343a}, tweenTime, Phaser.Easing.Exponential.In, true, 0);\n  return tween;\n};\n\nBattleUi.prototype.flickerOverlay = function () {\n  var tween = this._game.add.tween(this._overlay);\n  var timeLeft = 500; // half a second total\n  var flickerTime = 10;\n  var nFlickers = this._game.rnd.integerInRange(2,4);\n  var defaultTint = this._overlay.tint;\n  var tintColor = 0x333535;\n  var firstTween = tween;\n\n  for (var i = 0; i < nFlickers; i++) {\n    // use up all remaining time if it is the last flicker\n    var randTime = i == nFlickers - 1\n      ? timeLeft\n      : this._game.rnd.frac() * timeLeft;\n\n    // flicker instantly if it's the first flicker\n    var splitTime = i == 0 ? 0 : this._game.rnd.frac() * randTime;\n    tween.to( { tint: tintColor }, flickerTime, Phaser.Easing.Linear.In, false, splitTime);\n\n    var nextTween = this._game.add.tween(this._overlay);\n    nextTween.to( { tint: defaultTint }, flickerTime, Phaser.Easing.Linear.In, false, randTime - splitTime);\n    tween.chain(nextTween);\n\n    tween = nextTween;\n    timeLeft -= randTime;\n  }\n  firstTween.start();\n};\n\nBattleUi.prototype.updateCredBar = function (value, isDamage) {\n  // damage indication\n  if (isDamage) {\n    this.flickerOverlay();\n    this._game.sound.play('marble-impact');\n  }\n  this.credText.displayObject.text = value;\n  var originalTint = this.credText.displayObject.tint;\n  var firstTween = this._game.add.tween(this.credText.displayObject);\n  firstTween.to({ tint: 0x970B26 }, 100, Phaser.Easing.Linear.In, false, 0);\n  var secondTween = this._game.add.tween(this.credText.displayObject);\n  secondTween.to({ tint: originalTint }, 500, Phaser.Easing.Linear.In, false, 0);\n  firstTween.chain(secondTween);\n  firstTween.start();\n};\n\nBattleUi.prototype.updatePersuasionBar = function () {\n  this.persuadeBar.setPercent(this._game.persuasion * 25);\n  this._game.sound.play('success');\n};\n\nBattleUi.prototype.cardsInputEnabled = function (isEnabled) {\n  for (var i = 0; i < this.playerDeckIcons.length; i++) {\n    this.playerDeckIcons[i].inputEnabled = isEnabled;\n  }\n  for (i = 0; i < this.companionIcons.length; i++) {\n    this.companionIcons[i].inputEnabled = isEnabled;\n  }\n};\n\nBattleUi.prototype.addTooltip = function (card, cardIdx, x, y) {\n  var playerCardIcon = this.playerDeckIcons[cardIdx];\n\n  var tooltip = function () {\n    var tooltipWidth = 250;\n    var tooltipHeight = 200;\n\n    var bmd = this._game.add.bitmapData(tooltipWidth, tooltipHeight);\n    bmd.ctx.beginPath();\n    bmd.ctx.rect(0, 0, tooltipWidth, tooltipHeight);\n    bmd.ctx.fillStyle = '#424d4f';\n    bmd.ctx.fill();\n\n    this._game.slickUI.add(this.tooltip = new SlickUI.Element.DisplayObject(\n      x,y, this._game.make.sprite(0, 0, bmd)));\n    this.tooltip.alpha = 0.8;\n\n    var nameTextStyle = { font: '14px Goudy Bookletter 1911', fill: '#48f2ff', wordWrap: true, wordWrapWidth: tooltipWidth, fontWeight: 'bold', boundsAlignH: 'center' };\n    var nameText = new SlickUI.Element.DisplayObject(0,0,\n      this._game.make.text(0,0, card.getName().toUpperCase(), nameTextStyle));\n    this.tooltip.add(nameText);\n    // for alignment purposes\n    var nameTextHeight = nameText.displayObject.getBounds().height;\n    nameText.displayObject.setTextBounds(0,0, tooltipWidth, tooltipHeight);\n\n    var descTextStyle = { font: '14px Open Sans', fill: '#48f2ff', wordWrap: true, wordWrapWidth: tooltipWidth, align: 'left' };\n    var descText = new SlickUI.Element.DisplayObject(\n      0, Math.round(nameTextHeight),\n      this._game.make.text(0,0, card.getDescription(), descTextStyle));\n    this.tooltip.add(descText);\n  };\n\n  var deleteTooltip = function () {\n    if (this.tooltip) {\n      this.tooltip.container.displayGroup.removeAll();\n    }\n    this.tooltip = undefined;\n  };\n\n  playerCardIcon.events.onInputDown.add(deleteTooltip, playerCardIcon);\n\n  // tooltip functions\n  playerCardIcon.events.onInputOver.add(tooltip, playerCardIcon);\n  playerCardIcon.events.onInputOut.add(deleteTooltip, playerCardIcon);\n\n};\n","'use strict';\n\nvar items = require('../../static/assets/items.json');\n\nfunction Card(game, x, y, assetName, multiUse = false) {\n  Phaser.Sprite.call(this, game, x, y, assetName);\n  this._game = game;\n  this.assetName = assetName;\n  this.key = assetName;\n  this.description = 'test';\n  this.multiUse = multiUse;\n}\n\nCard.prototype = Object.create(Phaser.Sprite.prototype);\nmodule.exports = Card.prototype.constructor = Card;\n\nCard.prototype.getName = function () {\n  return items[this.key]['name'];\n};\n\nCard.prototype.getDescription = function () {\n  return items[this.key]['desc'];\n};\n","/*\n* Clickable\n* ====\n*\n* A sample prefab (extended game object class), displaying a clickable object in a room.\n*/\n\n'use strict';\n\nvar Toast = require('./Toast');\nvar items = require('../../static/assets/items.json');\n\nfunction Clickable(game, x, y, id, height, width) {\n  Phaser.Sprite.call(this, game, x, y, id);\n  this.height = height;\n  this.width = width;\n\n  this._game = game;\n  this.id = id;\n  this.name = items[this.id]['name'];\n  this.anchor.set(0.5);\n  this.alpha = 0.5;\n  this.inputEnabled = true;\n  this.input.useHandCursor = true;\n  this.events.onInputDown.add(click, this);\n  this.events.onInputOver.add(mouseover, this);\n  this.events.onInputOut.add(mouseout, this);\n\n  this.input.pixelPerfectOver = true;   // checks pixels so that collision only happens with non-transparent areas\n                                        // computationally expensive, but maybe necessary for realism purposes?\n}\n\nfunction click() {\n  this._game.sound.play('inventory-add');\n  this.destroy();\n  this._game.add.existing(new Toast(this._game, 'You\\'ve acquired ' + this.name + '!', 5));\n  this._game.player.inventory.push(this.id);\n  var items = this._game.room.area.items;\n  var remove_item = -1;\n  //because it is checking the id of the item and not the actual item\n  for (let i = 0; i < items.length; i++) {\n    if (items[i].id === this.id){\n      remove_item = i;\n    }\n  }\n  if (remove_item > -1) {\n    items.splice(remove_item, 1);\n  }\n  this._game.dialogueWindow.display(true); // refresh dialogue display, display instantly\n  this._game.memoryBankWindow.display();  // refresh memory bank display\n}\n\nfunction mouseover() {\n  this.alpha = 1;\n  this._game.add.existing(this.toast = new Toast(this._game, this.name, 5));\n}\n\nfunction mouseout() {\n  if (this.toast) {\n    this.toast.toast.container.displayGroup.removeAll();\n    this.toast.destroy();\n  }\n}\n\nClickable.prototype = Object.create(Phaser.Sprite.prototype);\nmodule.exports = Clickable.prototype.constructor = Clickable;\n","/*\n * ConversationManager\n * ===================\n *\n * Handles loading JSON assets for conversation and managing conversation state\n */\n\n'use strict';\n\nmodule.exports = ConversationManager;\n\nvar npcs = require('../../static/assets/npcs.json');\n\nfunction ConversationManager(game, customActions/*, ...args*/) {\n  // PROPERTIES:\n  // - conversation - json conversation\n\n  this._game = game;\n  this.customActions = customActions;\n\n  this.conversation = null;\n  this.idx = 0;\n  this.shown = [];\n}\nConversationManager.prototype.constructor = ConversationManager;\n\n/* Assumes JSON has already been loaded into cache!\n * Use game.load.json otherwise\n */\nConversationManager.prototype.loadJSONConversation = function (jsonKey) {\n  var json = this._game.cache.getJSON(jsonKey);\n\n  this.conversation = json;\n\n  if (this._game.areaTransitionWindow !== null \n    && typeof this._game.areaTransitionWindow !== 'undefined') {\n    this._game.areaTransitionWindow.disable();\n  }\n  //the player object will initialize the start index of a conversation\n  // at the end of a conversation the index will return to 0\n  // so that the next file will start at the begining.\n\n};\n\nConversationManager.prototype.getCurrentText = function () {\n  if (this.conversation === null) {\n    return '';\n  }\n\n  return this.conversation[this.idx]['text'];\n};\n\nConversationManager.prototype.getResponses = function () {\n  if (!this.conversation === null) {\n    return [''];\n  }\n  var responses = this.conversation[this.idx]['responses'];\n  var ret = [];\n  for (var i = 0; i < responses.length; i++) {\n    //check showOnce of target node\n    if (this.shown.indexOf(responses[i]['target']) > -1) {    // this node is marked \"show once\" and has already been shown\n      continue;\n    }\n    //check conditions on response\n    if ('conditions' in responses[i]) {\n      var conditionsNeeded = 0;\n      var conditionsMet = 0;\n      for (var condition in responses[i]['conditions']) {\n        if (this.checkCondition(this._game, condition, responses[i]['conditions'][condition])) {\n          conditionsMet++;\n        }\n        conditionsNeeded++;\n      }\n      if (conditionsMet >= conditionsNeeded) {\n        ret.push(responses[i]); //if all conditions are met, display response\n      }\n    } else {\n      ret.push(responses[i]);   //no conditions on this response, display it\n    }\n  }\n\n  return ret;\n};\n\nConversationManager.prototype.checkCondition = function(game, condition, value) {\n  if (condition.startsWith('var')) {\n    var variable = condition.substring(3);\n    if (value.startsWith('!')) {\n      if (!(variable in game.player.variables) || game.player.variables[variable] !== value.substring(1)) {\n        return true;    //player does not have this variable set, or has it set to a different value\n      }\n    } else if (variable in game.player.variables && game.player.variables[variable] === value) {\n      return true;      //player has this variable set to this value\n    }\n  } else if (condition.startsWith('inv')) {\n    var item = condition.substring(3);\n    if (value.startsWith('!')) {\n      if (game.player.inventory.indexOf(item) === -1) {\n        return true;    //player does not have this inventory item\n      }\n    } else if (game.player.inventory.indexOf(item) > -1) {\n      return true;      //player has this inventory item\n    }\n  } else if (condition.startsWith('seen')) {\n    var visited = value.split(' ');\n    var visitedAll = true;\n    for (var i = 0; i < visited.length; i++) {\n      if (this.shown.indexOf(parseInt(visited[i])) === -1) {\n        visitedAll = false;\n      }\n    }\n    return visitedAll;\n  }\n  return false;\n};\n\nConversationManager.prototype.getSpeaker = function () {\n  if (this.conversation === null) {\n    return [''];\n  }\n\n  return npcs[this.conversation[this.idx]['speaker']]['name'];\n};\n\nConversationManager.prototype.getAvatar = function() {\n  if (this.conversation === null) {\n    return [''];\n  }\n\n  return npcs[this.conversation[this.idx]['speaker']]['avatar'];\n};\n\nConversationManager.prototype.takeActions = function() {\n  if (this.conversation === null) {\n    return;\n  }\n\n  if (this.conversation[this.idx]['showOnce'] === 1 && !this.shown.includes(this.idx)) {\n    //if save at this point keeps getting resaved.\n    this.shown.push(this.idx);\n  }\n\n  if (this.conversation[this.idx]['actions'].length === 0) {\n    return;\n  }\n\n  for (var action in this.conversation[this.idx]['actions']) {\n    this.takeAction(this._game, action, this.conversation[this.idx]['actions'][action]);\n  }\n  return;\n};\n\nConversationManager.prototype.takeAction = function(game, action, value) {\n  if (action.startsWith('var')) {\n    var variable = action.substring(3);\n    if (value.startsWith('!')) {\n      delete game.player.variables[variable]; //remove variable from\n    } else {\n      game.player.variables[variable] = value;  //set variable on player\n    }\n  } else if (action.startsWith('inv')) {\n    var item = action.substring(3);\n    if (value.startsWith('!')) {\n      if (!(item in game.player.inventory)) {\n        var index = game.player.inventory.indexOf(item);\n        if (index > -1) {\n          game.player.inventory.splice(index, 1); //remove item from player inventory\n        }\n      }\n    } else {\n      game.player.inventory.push(item); //add item to player inventory\n    }\n  } else if (action === 'custom') {\n    this.customActions.customAction(value);\n  }\n};\n\nConversationManager.prototype.endConversation = function() {\n  if (this.conversation === null) {\n    return;\n  }\n\n  for (var i = 0; i < this._game.room.npcs.length; i++) {\n    var npc = this._game.room.npcs[i];\n    npc.show();\n  }\n    \n  if ('onEnd' in this.conversation) {\n    this.customActions.customAction(this.conversation['onEnd']);\n  }\n\n  this.shown = [];\n  this.idx = 0;\n  //think this is a cyclic ref. TODO: fix \n  this._game.dialogueWindow.convoFile = null;\n  this._game.areaTransitionWindow.enable();\n};\n\nConversationManager.prototype.advanceToTarget = function (targetIdx) {\n  this.idx = targetIdx;\n  return true;  // returns whether should refresh display.\n};\n\nConversationManager.prototype.update = function () {\n  // TODO: Stub.\n};\n","/*\n* DialogueWindow\n* ==============\n*\n* Handles displaying dialogue (conversation data) to screen\n*/\n\n'use strict';\n\nmodule.exports = DialogueWindow;\n\nvar Scrollbar = require('./Scrollbar');\nvar textstyles = require('../../static/assets/textstyles.json');\n\nfunction DialogueWindow(game, convoManager/*, ...args*/) {\n  Phaser.Group.call(this, game/*, ...args*/);\n\n  // PROPERTIES\n  // - dialogPanel\n  // - speakerText\n  // - dialogText\n  // - convoManager (passed in ConversationManager)\n  // - dialogWidth\n  // - dialogHeight\n  // - buttons\n\n  this.convoManager = convoManager;\n  // messy, but useful if we need a reference to the game\n  this._game = game;\n\n  /* SIGNALS */\n  // private\n  this._onDialogTextFinished = new Phaser.Signal(); // when the char-by-char display finishes\n\n  // private members specifying margin and padding\n  this._dialogTextOriginX = 96;\n  this._dialogTextOriginY = 60;\n  this._dialogPadding = 32;\n\n  // speaker avatar display\n  game.slickUI.add(this.avatar = new SlickUI.Element.DisplayObject(\n    400, 100, game.make.sprite(0, 0, 'invisible'),\n    400, 500));\n\n  this.dialogHeight = game.height * 3 / 8 /* 3/8 height */ - this._dialogPadding / 2;\n  this.dialogWidth = game.width - this._dialogPadding;\n\n  // dialog text dimensions (private)\n  this._dialogTextHeight = this.dialogHeight - this._dialogTextOriginY - 18;\n  this._dialogTextWidth = this.dialogWidth - 185;\n\n  // window coordinates\n  var dialogX = this._dialogPadding / 2;\n  var dialogY = game.height * 5 / 8;  // 5/8 down\n\n  game.slickUI.add(\n    this.dialogPanel = new SlickUI.Element.DisplayObject(\n      dialogX, dialogY, game.make.sprite(0,0, 'dialogue-panel'),\n      this.dialogWidth, this.dialogHeight));\n  this.dialogPanel.displayObject.width = this.dialogWidth;\n  this.dialogPanel.displayObject.height = this.dialogHeight;\n\n  // actual window contents\n  var speakerX = this._dialogPadding + 64;\n  var speakerY = this._dialogPadding / 4;\n  this.dialogPanel.add(\n    this.speakerText = new SlickUI.Element.DisplayObject(\n      Math.round(speakerX), speakerY,\n      game.make.text(0, 0, 'Speaker', textstyles['speaker'])));\n\n  // using a mask for scrolling purposes\n  this._scrollMask = game.make.graphics(0, 0);\n  this._scrollMask.beginFill(0xffffff);\n  this._scrollMask.drawRect( this._dialogTextOriginX, this._dialogTextOriginY, this._dialogTextWidth, this._dialogTextHeight );\n  this._scrollMask.endFill();\n\n  var bodyStyle = textstyles['dialogueBody'];\n  bodyStyle.wordWrapWidth = this._dialogTextWidth;\n  this.dialogPanel.add(\n    this.dialogText = new SlickUI.Element.DisplayObject(this._dialogTextOriginX, this._dialogTextOriginY,\n      game.make.text(0, 0, 'placeholder text', bodyStyle)));\n  this.dialogText.displayObject.lineSpacing = 0;\n\n  this.dialogPanel.add(new SlickUI.Element.DisplayObject(0, 0, this._scrollMask));\n  this.dialogText.displayObject.mask = this._scrollMask;\n\n  this.dialogPanel.alpha = 0.8;\n\n  // for removing player choice buttons\n  this.buttons = [];\n  this.buttonTweens = [];\n  // slider for scrolling overflow\n  this.slider = null;\n  // stores each button Y value\n  // also keeps track of how low our content goes; last element is content bottom\n  this._buttonsY = [];\n\n  //for keeping track of whether the avatar needs to be updated (performance intensive)\n  this.avatarName = 'invisible';\n\n  // will track the conversation file, so that save checkpoints will\n  // go to the correct area in the conversation\n  this.convoFile = null;\n\n  // for rendering lines character by character\n  this.charTimer = null;\n}\n\nDialogueWindow.prototype = Object.create(Phaser.Group.prototype);\nDialogueWindow.prototype.constructor = DialogueWindow;\n\nDialogueWindow.prototype.begin = function(jsonKey) {\n  if (jsonKey) {\n    this.loadJSONConversation(jsonKey);\n    this.show();\n    this.display();\n  } else {\n    this.hide();\n  }\n};\n\nDialogueWindow.prototype.loadJSONConversation = function (jsonKey) {\n  if (jsonKey) {\n    this.convoFile = jsonKey;\n    this.convoManager.loadJSONConversation(jsonKey);\n  }\n};\n\nDialogueWindow.prototype.display = function (displaysInstant = false\n                              /* by default, not set to display text instantly */) {\n  this.cleanWindow();\n  if (this.convoFile) {\n    this.takeActions();\n    this.displayAvatar();\n\n    // On finishing the dialog text display, display our responses\n    // Added before our actual display call in case we display instantly\n    this._onDialogTextFinished.add(function () {\n      this.displayResponses();\n      this._onDialogTextFinished.removeAll();\n    }, this);\n    this.displayText(displaysInstant);\n  }\n};\n\nDialogueWindow.prototype.cleanWindow = function () {\n  // stop all button tweens\n  for (var i = 0; i < this.buttonTweens.length; i++) {\n    this.buttonTweens[i].stop();\n  }\n\n  // remove all buttons\n  for (var j = 0; j < this.buttons.length; j++) {\n    var button = this.buttons[j];\n    button.container.displayGroup.removeAll(true);\n    button.container.displayGroup.destroy();\n    button.container.children = [];\n    button.container = undefined;\n    button.sprite = undefined;\n  }\n  this.buttons = [];\n  this._buttonsY = [];\n\n  // remove scroller and restore dialog text position\n  if (this.slider !== null) {\n    this.slider.destroy();\n    this.slider = null;\n  }\n  this.dialogText.y = this._dialogTextOriginY;\n  this.dialogText.displayObject.inputEnabled = false;\n  this.dialogText.displayObject.events.onInputOver.removeAll();\n  this.dialogText.displayObject.events.onInputOut.removeAll();\n  this._game.input.mouse.mouseWheelCallback = null;\n};\n\nDialogueWindow.prototype.takeActions = function() {\n  this.convoManager.takeActions(this._game);\n};\n\n// if avatar needs to change, fade out the current one and fade in the new one\nDialogueWindow.prototype.displayAvatar = function() {\n  var speaker = this.convoManager.getAvatar();\n  var fadeOut = 200;\n  var fadeIn = 200;\n  if (speaker !== this.avatarName) {\n    var fadeInTween = this._game.add.tween(this.avatar);\n    fadeInTween.to({alpha: 0}, fadeOut, Phaser.Easing.Linear.None, true);\n    fadeInTween.onComplete.add(function() {\n      this.avatar.displayObject.loadTexture(speaker);\n      this._game.add.tween(this.avatar).to({alpha: 1}, fadeIn, Phaser.Easing.Linear.None, true);\n    }, this);\n    this.avatarName = speaker;\n  }\n};\n\nDialogueWindow.prototype.displayText = function (displaysInstant) {\n  this.speakerText.displayObject.text = this.convoManager.getSpeaker().toUpperCase();\n  this.dialogText.displayObject.mask = this._scrollMask;\n\n  if (displaysInstant) {\n    this.dialogText.displayObject.text = this.convoManager.getCurrentText();\n    if (this.charTimer != null) {\n      this._game.time.events.remove(this.charTimer);  // stop characters from rendering one by one, if they are currently rendering\n    }\n    this._onDialogTextFinished.dispatch();\n    return;\n  }\n\n  // character-by-character display\n  this.displayCurrentLine();\n\n};\n\nDialogueWindow.prototype.displayResponses = function () {\n  // start rendering buttons at the bottom of dialogue\n  var responses = this.convoManager.getResponses(this._game);\n\n  var textBottom = this._dialogTextOriginY + this.dialogText.displayObject.getBounds().height;\n  this.nextButtonY = textBottom;\n\n  if (responses.length === 0) {\n    // no responses - waiting on player to do something to progress\n    var waitButton = this.addChoiceButton(this._dialogTextOriginX, this.nextButtonY,\n      'END', null);\n    waitButton.visible = false;\n    this.buttons.push(waitButton);\n  }\n\n  this.buttonTweens = [];\n\n  for (var i = 0; i < responses.length; i++) {\n    // pass along special parameters, if any\n    var params = [];\n    if ('params' in responses[i]) {\n      params = responses[i]['params'];\n    }\n\n    // keep track of buttons to be deleted\n    var responseDelay = 250;\n    var button = this.addChoiceButton(\n      this._dialogTextOriginX, this.nextButtonY,\n      responses[i]['text'], responses[i]['target'], params);\n    button.alpha = 0;\n    var tween = this._game.add.tween(button).to({alpha: 1}, responseDelay, Phaser.Easing.Linear.None, true, responseDelay * i);\n    if (i === responses.length - 1) {\n      tween.onComplete.add(function() {\n        this.addOverflowScroll();\n      }, this);\n    }\n    this.buttonTweens.push(tween);  // for deletion later\n    this.buttons.push(button);\n    this._buttonsY.push(button.y);\n    this.nextButtonY += button.sprite.height;\n  }\n\n  // last element is bottom of content\n  this._buttonsY.push(this.nextButtonY);\n};\n\nDialogueWindow.prototype.addChoiceButton = function (x, y, responseTextField, responseTarget, responseParams = []) {\n  // display text\n  var buttonSidePadding = 32;\n  var buttonTextStyle = textstyles['choiceButton'];\n  buttonTextStyle.wordWrapWidth = this._dialogTextWidth - buttonSidePadding;\n  var responseText = this._game.make.text(0, 0, responseTextField, buttonTextStyle);\n  var buttonText = new SlickUI.Element.DisplayObject(\n    Math.round(this._dialogTextWidth / 2 - responseText.width / 2),0, /* center text */\n    responseText);\n\n  // add to sized button\n  var choiceButton;\n  this.dialogPanel.add(choiceButton = new SlickUI.Element.DisplayObject(\n    x, y,\n    this._game.make.button(0,0, 'dialogue-choice-button'),\n    this.dialogWidth, responseText.height));\n  choiceButton.add(buttonText);\n  choiceButton.sprite.width = this._dialogTextWidth;\n  choiceButton.sprite.height = responseText.height;\n\n  // end of conversation. action deletes window\n  if (responseTarget < 0) {\n    choiceButton.events.onInputUp.add(\n      function () {\n        this.dialogueWindow.hide();\n        this.dialogueWindow.convoManager.endConversation();  // take any actions that trigger when this conversation ends\n      }, {dialogueWindow: this});\n  }\n\n  choiceButton.events.onInputUp.add(\n    function () {\n      this.dialogueWindow._game.sound.play('tap');\n      var shouldRefresh = this.dialogueWindow.convoManager.advanceToTarget(\n        this.responseTarget, this.responseParams);\n      if (shouldRefresh)\n        this.dialogueWindow.display();\n    }, {dialogueWindow: this, responseTarget: responseTarget, responseParams: responseParams});\n  // add mask\n  choiceButton.sprite.mask = this._scrollMask;\n  buttonText.displayObject.mask = this._scrollMask;\n\n  return choiceButton;\n};\n\nDialogueWindow.prototype.addOverflowScroll = function () {\n  // can we fit everything in the current window?\n  var heightDiff = this._buttonsY[this._buttonsY.length - 1]\n    - (this._dialogTextOriginY + this._dialogTextHeight);\n  // add a slider otherwise\n  if (heightDiff > 0) {\n\n    var scrolllineWidth = 1.5;\n    this.slider = new Scrollbar(\n      this._game,\n      this._dialogTextOriginX + this._dialogTextWidth + this._dialogPadding - scrolllineWidth,\n      this._dialogTextOriginY - scrolllineWidth,\n      this.dialogPanel, // parent\n      {\n        'x': [0, this._dialogPadding, 0],\n        'y': [0, this._dialogTextHeight / 2, this._dialogTextHeight]\n      },\n      heightDiff, scrolllineWidth);\n\n    var scrollCallback = function (value) {\n      // mapping height differences to scroll values\n      var scrollValue = heightDiff*value;\n      this.dialogText.y = this._dialogTextOriginY - scrollValue;\n      for (var i = 0; i < this.buttons.length; i++) {\n        // slide all buttons up\n        this.buttons[i].y = this.dialogPanel.y + this._buttonsY[i] - scrollValue;\n      }\n    };\n\n    this.slider.onDrag.add(scrollCallback, this);\n    this.slider.onSetValue.add(scrollCallback, this);\n\n    // Mouse wheel events\n    this.dialogText.displayObject.inputEnabled = true;\n    this.dialogText.displayObject.events.onInputOver.add(\n      function () { this._dialogOver = true; }, this);\n    this.dialogText.displayObject.events.onInputOut.add(\n      function () { this._dialogOver = false; }, this);\n    this._game.input.mouse.mouseWheelCallback = (function (event) {\n      if (!this._dialogOver)\n        return;\n      this.slider.value += (1/heightDiff) * event.deltaY;\n    }).bind(this);\n  }\n};\n\nDialogueWindow.prototype.showAvatar = function() {\n  var fadeInTween = this._game.add.tween(this.avatar);\n  var fadeIn = 200;\n  fadeInTween.to({alpha: 1}, fadeIn, Phaser.Easing.Linear.None, true);\n};\n\nDialogueWindow.prototype.hideAvatar = function() {\n  var fadeOutTween = this._game.add.tween(this.avatar);\n  var fadeOut = 200;\n  fadeOutTween.to({alpha: 0}, fadeOut, Phaser.Easing.Linear.None, true);\n};\n\nDialogueWindow.prototype.show = function() {\n  this.dialogPanel.visible = true;\n  this.showAvatar();\n};\n\nDialogueWindow.prototype.hide = function () {\n  this.cleanWindow();\n  this.dialogPanel.visible = false;\n  this.hideAvatar(); //hide avatar\n};\n\nDialogueWindow.prototype.displayCurrentLine = function () {\n\n  var line = this.convoManager.getCurrentText();\n  this.dialogText.displayObject.text = '';\n\n  //  Split the current line on characters, so one char per array element\n  var split = line.split('');\n\n  //  Reset the word index to zero (the first word in the line)\n  this._cIndex = 0;\n\n  // Add an option to skip the text on clicking down.\n  this.dialogPanel.displayObject.inputEnabled = true;\n  this.dialogPanel.events.onInputDown.add(this.skipText, this);\n\n  var nextChar = function () {\n    // TODO: make this a selectable option\n    var delay = 3;\n    \n    this.dialogText.displayObject.text =\n      this.dialogText.displayObject.text.concat(split[this._cIndex]);\n    if (split[this._cIndex] === ',') {\n      delay = 200;    // brief pause on commas\n    } else if (['.', '?', '!'].indexOf(split[this._cIndex]) > -1) {\n      delay = 300;    // longer pause after each sentence\n    }\n    this._cIndex++;\n    if (this._cIndex == split.length) {\n      // Tell the window when we're done\n      this._onDialogTextFinished.dispatch();\n      this.charTimer = null;\n    } else {\n      // Add the next event in the chain\n      this.charTimer = this._game.time.events.add(delay, nextChar, this);\n    }\n  };\n\n  //  Call the 'nextChar' function and chain until it reaches the end of the line\n  this.charTimer = this._game.time.events.add(0, nextChar, this);\n\n};\n\nDialogueWindow.prototype.skipText = function () {\n  this._game.time.removeAll();\n  this.displayText(true);\n  this.dialogPanel.events.onInputDown.removeAll();\n};\n\nDialogueWindow.prototype.update = function () {\n  // TODO: Stub.\n};\n","/**\nCopyright (c) 2015 Belahcen Marwane (b.marwane@gmail.com)\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nvar HealthBar = function(game, providedConfig) {\n  this.game = game;\n\n  this.setupConfiguration(providedConfig);\n  this.setPosition(this.config.x, this.config.y);\n  this.drawBackground();\n  this.drawHealthBar();\n  this.setFixedToCamera(this.config.isFixedToCamera);\n};\nHealthBar.prototype.constructor = HealthBar;\n\nHealthBar.prototype.setupConfiguration = function (providedConfig) {\n  this.config = this.mergeWithDefaultConfiguration(providedConfig);\n  this.flipped = this.config.flipped;\n};\n\nHealthBar.prototype.mergeWithDefaultConfiguration = function(newConfig) {\n  var defaultConfig= {\n    width: 250,\n    height: 40,\n    x: 0,\n    y: 0,\n    bg: {\n      color: '#808080'\n    },\n    bar: {\n      color: '#651828'\n    },\n    animationDuration: 200,\n    flipped: false,\n    isFixedToCamera: false\n  };\n    \n  if(newConfig.flipped) {\n    defaultConfig.bg.color = '#651828';\n    defaultConfig.bar.color = '#808080';\n  }\n    \n  return mergeObjects(defaultConfig, newConfig);\n};\n\nfunction mergeObjects(targetObj, newObj) {\n  for (var p in newObj) {\n    try {\n      targetObj[p] = newObj[p].constructor==Object ? mergeObjects(targetObj[p], newObj[p]) : newObj[p];\n    } catch(e) {\n      targetObj[p] = newObj[p];\n    }\n  }\n  return targetObj;\n}\n\nHealthBar.prototype.drawBackground = function() {\n\n  var bmd = this.game.add.bitmapData(this.config.width, this.config.height);\n  bmd.ctx.fillStyle = this.config.bg.color;\n  bmd.ctx.beginPath();\n  bmd.ctx.rect(0, 0, this.config.width, this.config.height);\n  bmd.ctx.fill();\n\n  this.bgSprite = this.game.add.sprite(this.x, this.y, bmd);\n  this.bgSprite.anchor.set(0.5);\n\n  if(this.flipped){\n    this.bgSprite.scale.x = -1;\n  }\n};\n\nHealthBar.prototype.drawHealthBar = function() {\n  var bmd = this.game.add.bitmapData(this.config.width, this.config.height);\n  bmd.ctx.fillStyle = this.config.bar.color;\n  bmd.ctx.beginPath();\n  bmd.ctx.rect(0, 0, this.config.width, this.config.height);\n  bmd.ctx.fill();\n\n  this.barSprite = this.game.add.sprite(this.x - this.bgSprite.width/2, this.y, bmd);\n  this.barSprite.anchor.y = 0.5;\n\n  if(this.flipped){\n    this.barSprite.scale.x = -1;\n  }\n};\n\nHealthBar.prototype.setPosition = function (x, y) {\n  this.x = x;\n  this.y = y;\n\n  if(this.bgSprite !== undefined && this.barSprite !== undefined){\n    this.bgSprite.position.x = x;\n    this.bgSprite.position.y = y;\n\n    this.barSprite.position.x = x - this.config.width/2;\n    this.barSprite.position.y = y;\n  }\n};\n\n\nHealthBar.prototype.setPercent = function(newValue){\n  if (newValue < 0) newValue = 0;\n  if (newValue > 100) newValue = 100;\n\n  var newWidth = (newValue * this.config.width) / 100;\n\n  this.setWidth(newWidth);\n};\n\nHealthBar.prototype.setWidth = function(newWidth){\n  if (this.flipped) {\n    newWidth = -1 * newWidth;\n  }\n  this.game.add.tween(this.barSprite).to( { width: newWidth }, this.config.animationDuration, Phaser.Easing.Linear.None, true);\n};\n\nHealthBar.prototype.setFixedToCamera = function(fixedToCamera) {\n  this.bgSprite.fixedToCamera = fixedToCamera;\n  this.barSprite.fixedToCamera = fixedToCamera;\n};\n\nHealthBar.prototype.kill = function() {\n  this.bgSprite.kill();\n  this.barSprite.kill();\n};\n\nmodule.exports = HealthBar;\n","/*\n * Icon\n * ====\n *\n * Icon base class (masked sprite group)\n */\n\n'use strict';\n\nmodule.exports = Icon;\n\nfunction Icon(game, x, y, asset, mask, border, width = 100.0/*, TODO: height = 100.0 ...args*/) {\n  Phaser.Sprite.call(this, game, x, y, asset/*, ...args*/);\n\n  // PROPERTIES\n  // - maskSprite\n  this.maskSprite;\n  // - borderSprite\n  this.borderSprite;\n  // - asset key\n  this.id = asset;\n\n  this._game = game;\n  // expands borders of mask slightly\n  var scaleRelax = 1.05;\n\n  if (typeof mask !== 'undefined' && mask !== null) {\n    this.maskSprite = game.make.sprite(x,y, mask);\n\n    this.maskSprite.scale.setTo(this.width*scaleRelax / this.maskSprite.width);\n\n    var maskedBmd = game.make.bitmapData(this.maskSprite.width, this.maskSprite.height);\n    maskedBmd.alphaMask(this, this.maskSprite);\n    // replace main sprite with bitmap data mask\n    this.loadTexture(maskedBmd);\n  }\n\n  this.scale.setTo(width / this.width);\n  var parentScale = this.scale.x;\n\n  if (typeof border !== 'undefined' && border !== null) {\n    this.borderSprite = game.make.sprite(0,0, border);\n    this.addChild(this.borderSprite);\n    this.borderSprite.scale.setTo((width / this.borderSprite.width) / parentScale);\n  }\n\n}\n\nIcon.prototype = Object.create(Phaser.Sprite.prototype);\nIcon.prototype.constructor = Icon;\n\nIcon.prototype.update = function () {\n  var i = this.children.length;\n  while (i--) {\n    this.getChildAt(i).update();\n  }\n};\n","/*\n * MemoryBankWindow\n * ===============\n *\n * UI window for the memory bank\n */\n\n'use strict';\n\nvar items = require('../../static/assets/items.json');\nvar Icon = require('./Icon');\n\nmodule.exports = MemoryBankWindow;\n\nfunction memoryBankButtonToggle() {\n  // unresponsive while animating\n  if (this._isTweening)\n    return;\n\n  this._isTweening = true;\n  var timeToTween = 500;  // milliseconds\n\n  // hide panel\n  if (this.panel.visible) {\n    this._game.sound.play('swish-close');\n    this._game.add.tween(this.panel).to(\n        {x: this._baseX + this.panelWidth + this._memoryPadding}, timeToTween, Phaser.Easing.Exponential.Out, true\n      ).onComplete.add(\n        function () {\n          this.panel.visible = false;\n          this._isTweening = false;\n        }, this\n      );\n    return;\n  }\n\n  // show panel\n\n  // if area transition window is open, close it\n  if (this._game.areaTransitionWindow.panel.visible) {\n    this._game.areaTransitionWindow.panel.visible = false;\n  }\n  this.panel.visible = true;\n  this.display();\n\n  this.panel.x = this._baseX + this.panelWidth + this._memoryPadding;\n  this._game.sound.play('swish-open');\n  this._game.add.tween(this.panel).to(\n      {x: this._baseX}, timeToTween, Phaser.Easing.Exponential.Out, true\n    ).onComplete.add(function () { this._isTweening = false; }, this);\n}\n\nfunction MemoryBankWindow(game/*, ...args*/) {\n  Phaser.Group.call(this, game/*, ...args*/);\n\n  this._game = game;\n\n  // private members specifying margin and padding\n  this._memoryTextOriginX = 100;\n  this._memoryTextOriginY = 155;\n  this._memoryPadding = 32;\n  this._itemOriginX = 80;\n  this._itemOriginY = 25;\n  this._baseX = this._memoryPadding / 2;\n  this._baseY = this._memoryPadding * 2;\n\n  // memory bank window dimensions\n  this.panelHeight = game.height * 1/2 - this._memoryPadding / 2;\n  this.panelWidth = game.width - this._memoryPadding;\n  this._rowCapacity = 5;  // items per row\n  this._itemStart = 0;  // determines which row to show\n\n  // window-dependent private member dimensions\n  this._memoryTextWidth = this.panelWidth - 185;\n  this._itemPadding = this.panelWidth / 50;\n  this._nextOriginX = this.panelWidth - 55;\n  this._nextOriginY = 0;\n  this._prevOriginX = -18;\n  this._prevOriginY = 0;\n\n  /**\n   * Panel\n   */\n\n  game.slickUI.add(\n    this.panel = new SlickUI.Element.DisplayObject(\n      this._baseX, this._baseY, game.make.sprite(0,0, 'memory-bank'),\n      this.panelWidth, this.panelHeight));\n  this.panel.displayObject.width = this.panelWidth;\n  this.panel.displayObject.height = this.panelHeight;\n\n  // by default, not displayed\n  this.panel.visible = false;\n  this.panel.alpha = 0.8;\n\n  /**\n   * Toggle button\n   */\n  // until you click on the toggle button\n  game.slickUI.add(\n    this.toggleButton = new SlickUI.Element.DisplayObject(\n      0,this._memoryPadding, game.make.button(0,0, 'memory-bank-button')));\n  // set scale such that width = 1/8 panel width\n  this.toggleButton.displayObject.scale.setTo(\n    (this.panelWidth / 8) / this.toggleButton.displayObject.width);\n  this.toggleButton.x = game.width - this._memoryPadding - this.toggleButton.displayObject.width;\n  // show panel callback\n  this.toggleButton.events.onInputDown.add(memoryBankButtonToggle, this);\n  this.toggleButton.alpha = 0.9;\n\n  /**\n   * Text - name and description\n   */\n  var nameTextStyle = { font: '14px Goudy Bookletter 1911', fill: '#48f2ff', wordWrap: true, wordWrapWidth: this._memoryTextWidth, fontWeight: 'bold', boundsAlignH: 'center' };\n  this.panel.add(\n    this.nameText = new SlickUI.Element.DisplayObject(\n      this._memoryTextOriginX,\n      this._memoryTextOriginY,\n      game.make.text(0,0, '', nameTextStyle), this._memoryTextWidth));\n  // for alignment purposes\n  var nameTextHeight = this.nameText.displayObject.getBounds().height;\n  this.nameText.displayObject.setTextBounds(0,0, this._memoryTextWidth, nameTextHeight);\n\n  var descTextStyle = { font: '14px Open Sans', fill: '#48f2ff', wordWrap: true, wordWrapWidth: this._memoryTextWidth, align: 'left' };\n  this.panel.add(\n    this.descText = new SlickUI.Element.DisplayObject(\n      this._memoryTextOriginX,\n      this._memoryTextOriginY + nameTextHeight,\n      game.make.text(0,0, '', descTextStyle), this._memoryTextWidth));\n\n  /**\n   * Bookkeeping\n   */\n  // are we currently animating?\n  this._isTweening = false;\n  this._itemDisplayObjects = []; // for deletion purposes\n  this._navButtons = [];\n}\n\nMemoryBankWindow.prototype = Object.create(Phaser.Group.prototype);\nMemoryBankWindow.prototype.constructor = MemoryBankWindow;\n\nMemoryBankWindow.prototype.display = function () {\n  this.cleanWindow();\n  this.displayItems();\n  this.showNavButtons();\n};\n\nMemoryBankWindow.prototype.cleanWindow = function () {\n  for (var i = 0; i < this._itemDisplayObjects.length; i++) {\n    var item = this._itemDisplayObjects[i];\n    item.container.displayGroup.removeAll(true);\n    item.container.displayGroup.destroy();\n  }\n  for (i = 0; i < this._navButtons.length; i++) {\n    var navButton = this._navButtons[i];\n    navButton.container.displayGroup.removeAll(true);\n    navButton.container.displayGroup.destroy();\n  }\n  this._itemDisplayObjects = [];\n  this._navButtons = [];\n};\n\nMemoryBankWindow.prototype.displayItems = function () {\n  var inventory = this._game.player.inventory;\n\n  var itemEnd = this._itemStart + this._rowCapacity < inventory.length\n    ? this._itemStart + this._rowCapacity\n    : inventory.length;\n\n  // Assumes InventoryItem objects in inventory.\n  for (var i = this._itemStart; i < itemEnd; i++) {\n    var itemId = inventory[i];\n\n    // scaled width = 1/7 panel width;\n    var desiredWidth = (this.panelWidth / 7);\n    var itemIcon = new Icon(this._game, 0,0,\n      itemId, 'memory-bank-icon-mask', 'memory-bank-icon' /* border */, desiredWidth);\n\n    var slickItem;\n    this.panel.add(slickItem = new SlickUI.Element.DisplayObject(\n      this._itemOriginX + (i - this._itemStart)*(this._itemPadding + desiredWidth), this._itemOriginY,\n      itemIcon));\n\n    itemIcon.inputEnabled = true;\n    itemIcon.input.useHandCursor = true;\n    itemIcon.events.onInputOver.add(function () {\n      this.nameText.displayObject.text = items[this.itemId]['name'].toUpperCase();\n      this.descText.displayObject.text = items[this.itemId]['desc'];\n    }, {nameText: this.nameText, descText: this.descText, itemId: itemId});\n\n    this._itemDisplayObjects.push(slickItem);\n  }\n};\n\nMemoryBankWindow.prototype.showNavButtons = function () {\n  // next buttons\n  if (this._itemStart + this._rowCapacity < this._game.player.inventory.length) {\n    var nextButton = this._game.make.button(0,0,'memory-bank-next');\n    var slickNext;\n    this.panel.add(slickNext = new SlickUI.Element.DisplayObject(\n      this._nextOriginX, this._nextOriginY, nextButton));\n    // scaled by height, equal to panel height\n    nextButton.scale.setTo(this.panelHeight / nextButton.height);\n    this._navButtons.push(slickNext);\n\n    nextButton.events.onInputUp.add(function () {\n      this.switchRow(true);\n      this.display();\n    }, this);\n\n  }\n\n  // prev buttons\n  if (this._itemStart > 0) {\n    var prevButton = this._game.make.button(0,0,'memory-bank-next');\n    // rotate sprite\n    prevButton.anchor.setTo(0.5, 0.5);\n    prevButton.scale.y *= -1;\n    prevButton.anchor.setTo(1,1);\n\n    var slickPrev;\n    this.panel.add(slickPrev = new SlickUI.Element.DisplayObject(\n      this._prevOriginX, this._prevOriginY,\n      prevButton));\n    this._navButtons.push(slickPrev);\n\n    prevButton.scale.setTo(this.panelHeight / prevButton.height);\n\n    prevButton.events.onInputUp.add(function () {\n      this.switchRow(false);\n      this.display();\n    }, this);\n\n  }\n};\n\nMemoryBankWindow.prototype.switchRow = function (wantsNextRow) {\n  var inventory = this._game.player.inventory;\n  if (wantsNextRow && this._itemStart + this._rowCapacity < inventory.length) {\n    this._itemStart += this._rowCapacity;\n    return;\n  }\n  if (!wantsNextRow && this._itemStart - this._rowCapacity >= 0) {\n    this._itemStart -= this._rowCapacity;\n    return;\n  }\n};\n\nMemoryBankWindow.prototype.update = function () {\n  // TODO: Stub.\n};\n","/*\n * NPC\n * ====\n *\n * A sample prefab (extended game object class), displaying an NPC in a room.\n */\n\n'use strict';\n\nvar npcs = require('../../static/assets/npcs.json');\nvar Toast = require('./Toast');\n\nfunction NPC(game, x, y, id, height, width) {\n  this.id = id;\n  this.img = npcs[id]['image'];\n  Phaser.Sprite.call(this, game, x, y, this.img);\n  this.height = height;\n  this.width = width;\n  this.name = npcs[id]['name'];\n\n  this._game = game;\n  this.conv = npcs[id]['conv'];\n  this.anchor.set(0.5);\n  this.inputEnabled = true;\n  this.input.useHandCursor = true;\n  this.events.onInputDown.add(click, this);\n  this.events.onInputOver.add(mouseover, this);\n  this.events.onInputOut.add(mouseout, this);\n\n  this.input.pixelPerfectOver = true;   // checks pixels so that collision only happens with non-transparent areas\n                                        // computationally expensive, but maybe necessary for realism purposes?\n}\n\nNPC.prototype = Object.create(Phaser.Sprite.prototype);\nmodule.exports = NPC.prototype.constructor = NPC;\n\nfunction click() {\n  this.hide();\n  this._game.dialogueWindow.begin(this.conv);\n}\n\nfunction mouseover() {\n  this._game.add.existing(this.toast = new Toast(this._game, this.name, 5));\n}\n\nfunction mouseout() {\n  if (this.toast) {\n    this.toast.toast.container.displayGroup.removeAll();\n    this.toast.destroy();\n  }\n}\n\nNPC.prototype.show = function() {\n  var fadeInTween = this._game.add.tween(this);\n  var fadeIn = 200;\n  fadeInTween.to({alpha: 1}, fadeIn, Phaser.Easing.Linear.None, true);\n  this.inputEnabled = true;\n};\n\nNPC.prototype.hide = function() {\n  var fadeOutTween = this._game.add.tween(this);\n  var fadeOut = 200;\n  fadeOutTween.to({alpha: 0}, fadeOut, Phaser.Easing.Linear.None, true);\n  this.inputEnabled = false;\n};\n","/*\n * Placeable\n * ====\n *\n * A sample prefab (extended game object class), displaying an object in a room\n * (usually larger than a clickable) that can be clicked on to display a message,\n * but not added to the player's inventory.\n */\n\n'use strict';\n\nvar Toast = require('./Toast');\nvar items = require('../../static/assets/items.json');\n\nfunction Placeable(game, x, y, id, height, width) {\n  Phaser.Sprite.call(this, game, x, y, id);\n  this.height = height;\n  this.width = width;\n\n  this._game = game;\n  this.id = id;\n  this.name = items[id]['name'];\n  this.message = items[id]['message'];\n  this.anchor.set(0.5);\n  this.inputEnabled = true;\n  this.input.useHandCursor = true;\n  this.events.onInputDown.add(click, this);\n  this.events.onInputOver.add(mouseover, this);\n  this.events.onInputOut.add(mouseout, this);\n\n  this.input.pixelPerfectOver = true;   // checks pixels so that collision only happens with non-transparent areas\n                                        // computationally expensive, but maybe necessary for realism purposes?\n}\n\nfunction click() {\n  this._game.add.existing(new Toast(this._game, this.message, 5));\n}\n\nfunction mouseover() {\n  this._game.add.existing(this.toast = new Toast(this._game, this.name, 5));\n}\n\nfunction mouseout() {\n  if (this.toast) {\n    this.toast.toast.container.displayGroup.removeAll();\n    this.toast.destroy();\n  }\n}\n\nPlaceable.prototype = Object.create(Phaser.Sprite.prototype);\nmodule.exports = Placeable.prototype.constructor = Placeable;","/*\n* Player\n* ====\n*\n* The player object class.\n*/\n\n'use strict';\n\nfunction Player(game) {\n  Phaser.Group.call(this, game);\n  this.inventory = [];\n  this.memoryBank = [];\n  this.seenAreas = []; //areas seen to track what can go in area transition window\n  this.variables = {};\n  this.currentRoom = null;\n  this.convoIdx = 0;\n  this.shownConvo = [];\n  this.convoFile = null;\n\n}\n\nPlayer.prototype = Object.create(Phaser.Group.prototype);\nmodule.exports = Player.prototype.constructor = Player;\n\nPlayer.prototype.serialize = function(game){\n  var fields = [\n    'inventory',\n    'memoryBank',\n    'seenAreas',\n    'variables'\n  ];\n\n  var obj = {};\n\n  for (let i in fields){\n    let field = fields[i];\n    obj[field] = this[field];\n  }\n  //since the room info contains all the objects in room, can I pop off there?\n  obj['currentRoom'] = game.room.area;\n  obj['convoIdx'] = game.dialogueWindow.convoManager.idx;\n  obj['shownConvo'] = game.dialogueWindow.convoManager.shown;\n  //since the convoFile is not stored in the game, we will just store it with the\n  //player whenever a new file is started.\n  //or we could store that also in the Dialogue manager??\n  obj['convoFile'] = game.dialogueWindow.convoFile;\n  return JSON.stringify(obj);\n};\n\nPlayer.unserialize = function(playerState, game){\n\n  if (typeof playerState === 'string'){\n    playerState = JSON.parse(playerState, (key, value) => {\n      return value;     // return the unchanged property value.\n    });\n  }\n\n  game.player = game.add.existing(new Player(game));\n\n  for (let field in playerState){\n    game.player[field] = playerState[field];\n  }\n\n};\n","/*\n * Room\n * ====\n *\n * A sample prefab (extended game object class), displaying a room background.\n */\n\n'use strict';\n\nvar Clickable = require('../objects/Clickable');\nvar Placeable = require('../objects/Placeable');\nvar NPC = require('../objects/NPC');\nvar areas = require('../../static/assets/areas.json');\n\nfunction Room(game, room) {\n  this._game = game;\n  this.name = room;\n\n  this.area = areas[room];\n  this.items = [];\n  this.placeables = [];\n  this.npcs = [];//how does this interact with the conversation manager?\n  //this is causing the glitch where the room blinks on load\n  //though even a new game blinks\n  Phaser.Sprite.call(this, game, game.world.centerX, game.world.centerY, this.area['bg']);\n  this.anchor.set(0.5);\n\n}\n\nRoom.prototype = Object.create(Phaser.Sprite.prototype);\nmodule.exports = Room.prototype.constructor = Room;\n\nRoom.prototype.addItems = function() {\n  //would prefer this in load areas TODO restructure\n  if (typeof this._game.music !== 'undefined' && this._game.music !== null)\n    this._game.music.fadeOut(1000); // fade out previous music\n  this._game.music = this._game.sound.play(this.area.music);\n  this._game.music.loopFull(1);\n\n  for (var i = 0; i < this.area['items'].length; i++) {\n    var item = this.area['items'][i];\n    this._game.add.existing(item = new Clickable(this._game, item['x'], item['y'], item['id'], item['height'], item['width']));\n    this.items.push(item);\n  }\n  for (i = 0; i < this.area['placeables'].length; i++) {\n    var placeable = this.area['placeables'][i];\n    this._game.add.existing(placeable = new Placeable(this._game, placeable['x'], placeable['y'], placeable['id'], placeable['height'], placeable['width']));\n    this.placeables.push(placeable);\n  }\n  for (i = 0; i < this.area['npcs'].length; i++) {\n    var npc = this.area['npcs'][i];\n\n    var showNPC = true;       // check to see if NPC meets conditions to be shown in this area\n    if ('showif' in npc) {\n      for (var condition in npc['showif']) {\n        if (this._game.player.variables[condition] != npc['showif'][condition]) {\n          showNPC = false;\n        }\n      }\n    }\n    if (!showNPC) {\n      continue; // if NPC doesn't meet conditions to be shown, skip them\n    }\n    this._game.add.existing(npc = new NPC(this._game, npc['x'], npc['y'], npc['id'], npc['height'], npc['width']));\n    if (npc.conv === this._game.player.convoFile){\n      npc.alpha = 0;\n    }\n    // if we want to re-enter a room and talk to a character again\n    // then we don't want to pop them off of the stack\n    this.npcs.push(npc);\n  }\n  this._game.world.bringToTop(this._game.slickUI.container.displayGroup);\n};\n\nRoom.prototype.clearItems = function() {\n  for (var i = 0; i < this.items.length; i++) {\n    this.items[i].destroy();\n  }\n  for (i = 0; i < this.placeables.length; i++) {\n    this.placeables[i].destroy();\n  }\n  for (i = 0; i < this.npcs.length; i++) {\n    this.npcs[i].destroy();\n  }\n  this.items = [];\n  this.placeables = [];\n  this.npcs = [];\n};\n\nRoom.prototype.loadArea = function(area) {\n  this.area = areas[area];\n\n  //below should track areas seen so that when area transition is pressed\n  //it will update with what the specific player has access to.\n  if (!this._game.player.seenAreas.includes(area)){\n    this._game.player.seenAreas.push(area);\n  }\n  this.name = area;\n  this._game.camera.fade('#000000', 2000);\n  this._game.camera.onFadeComplete.addOnce(function() {\n    this.clearItems();\n    this._game.camera.flash('#000000', 2000);\n    this.loadTexture(this.area['bg']);\n    this.addItems();\n  }, this);\n};\n","/*\n * SaveButton\n * ====\n * Save button, flush player Object to local store.\n *\n */\n\n'use strict';\n\nvar Toast = require('./Toast');\n\nfunction SaveButton(game) {\n  Phaser.Sprite.call(this, game, 25, 20, 'saveButton');\n  this.height = 30;\n  this.width = 50;\n\n  this._game = game;\n  this.id = 'saveButton';\n  this.name = 'Save Button';\n  this.anchor.set(0.5);\n  this.alpha = 0.5;\n  this.inputEnabled = true;\n  this.input.useHandCursor = true;\n  this.events.onInputDown.add(click, this);\n  this.events.onInputOver.add(mouseover, this);\n  this.events.onInputOut.add(mouseout, this);\n}\n\nfunction click() {\n  this._game.sound.play('save-notification');\n  this._game.add.existing(new Toast(this._game, 'Game Saved!', 5));\n  this._game.dialogueWindow.display(true); // refresh dialogue display\n  var saveString = this._game.player.serialize(this._game);\n  localStorage.setItem('playerState', saveString);\n}\n\nfunction mouseover() {\n  this.alpha = 1;\n  this._game.add.existing(this.toast = new Toast(this._game, this.name, 3));\n}\n\nfunction mouseout() {\n  if (this.toast) {\n    this.alpha = 0.5;\n    this.toast.toast.container.displayGroup.removeAll();\n    this.toast.destroy();\n  }\n}\n\nSaveButton.prototype = Object.create(Phaser.Sprite.prototype);\nmodule.exports = SaveButton.prototype.constructor = SaveButton;\n","/*\n * Scrollbar\n * =========\n *\n * Bitmap scrollbar that follows a set of given points.\n */\n\n'use strict';\n\nmodule.exports = Scrollbar;\n\nfunction Scrollbar(game, x, y, uiParent, points, maxScroll, lineWidth = 2, scrollbarWidth = 6) {\n  Phaser.Group.call(this, game/*, ...args*/);\n\n  this._game = game;\n  // Dispatch signals; others may attach events to these signals\n  this.onDragStart = new Phaser.Signal();\n  this.onDrag = new Phaser.Signal();\n  this.onDragStop = new Phaser.Signal();\n  this.onSetValue = new Phaser.Signal();\n\n  // Initial value\n  this._value = 0;\n  // How wide is our scrollbar?\n  this._scrollbarWidth = scrollbarWidth;\n  // How many pixels down can we scroll?\n  this._maxScroll = maxScroll;\n  // Determines path of scrollbar, as well as bounds\n  this.points = points;\n\n  // Draw bitmap path\n  this.maxWidth = Math.max(...this.points.x);\n  this.maxHeight = Math.max(...this.points.y);\n\n  var bmdPath = this._game.make.bitmapData(this.maxWidth + lineWidth, this.maxHeight + lineWidth);\n  var interpInc = 1 / this.maxHeight;\n  for (var i = 0; i < 1; i += interpInc) {\n    var px = this._game.math.linearInterpolation(this.points.x, i);\n    var py = this._game.math.linearInterpolation(this.points.y, i);\n    bmdPath.rect(px, py, lineWidth, lineWidth, '#48f2ff');\n  }\n\n  this.scrollbarLine = new SlickUI.Element.DisplayObject(\n    x, y, this._game.make.sprite(0,0, bmdPath));\n\n  // Draw scrollbar\n  this._scrollbarRatio = (this.maxHeight + this._scrollbarWidth - this._maxScroll) / this.maxHeight;\n\n  // Bitmap data for scrollbar\n  this._bmdScroll = this._game.make.bitmapData(\n    this.maxWidth + this._scrollbarWidth, \n    this.maxHeight + this._scrollbarWidth);\n\n  for (i = 0; i < this._scrollbarRatio; i += interpInc) {\n    px = this._game.math.linearInterpolation(points.x, i);\n    py = this._game.math.linearInterpolation(points.y, i);\n    this._bmdScroll.rect(px, py, this._scrollbarWidth, this._scrollbarWidth, '#48f2ff');\n  }\n  var scrollbarSprite = this._game.make.sprite(0,0, this._bmdScroll);\n  this.scrollbar = new SlickUI.Element.DisplayObject(\n    x-this._scrollbarWidth/2, \n    y-this._scrollbarWidth/2, \n    scrollbarSprite);\n\n  // Display events\n  scrollbarSprite.inputEnabled = true;\n  scrollbarSprite.input.useHandCursor = true;\n  \n  // Handle mouse input\n  scrollbarSprite.events.onInputDown.add(function (sprite, pointer) {\n    this._dragging = true;\n    this._dragPoint = pointer.y;\n    this._dragValue = this._value;\n\n    this.onDragStart.dispatch(this._value);\n  }, this);\n  scrollbarSprite.events.onInputUp.add(function () {\n    this._dragging = false;\n\n    this.onDragStop.dispatch(this._value);\n  }, this);\n\n  this._game.input.addMoveCallback(function (pointer, pointerX, pointerY) {\n    if (!this._dragging)\n      return;\n\n    // Measure scroll relative to dragPoint\n    var start = this._dragPoint - this._dragValue*this._maxScroll;\n    var clampedDelta = Math.min(Math.max(0, pointerY - start), this._maxScroll);\n\n    // Update value\n    this._value = (1/this._maxScroll)*clampedDelta;\n\n    // Redraw bitmap to update sprite\n    this.redraw();\n\n    this.onDrag.dispatch(this._value);\n    \n  }, this);\n\n  // Add to SlickUI parent\n  uiParent.add(this.scrollbarLine);\n  uiParent.add(this.scrollbar);\n  \n}\nScrollbar.prototype = Object.create(Phaser.Group.prototype);\nScrollbar.prototype.constructor = Scrollbar;\n\nScrollbar.prototype.redraw = function () {\n  this._bmdScroll.clear();\n  // Redraw bitmap to update sprite\n  var startBitmap = this._value*this._maxScroll / this.maxHeight;\n  var interpInc = 1/this.maxHeight;\n  for (var i = startBitmap; i < startBitmap + this._scrollbarRatio; i += interpInc) {\n    var px = this._game.math.linearInterpolation(this.points.x, i);\n    var py = this._game.math.linearInterpolation(this.points.y, i);\n    this._bmdScroll.rect(px, py, this._scrollbarWidth, this._scrollbarWidth, '#48f2ff');\n  }\n};\n\nScrollbar.prototype.destroy = function () {\n  // if display container exists (i.e. not destroyed)\n  if (typeof this.scrollbarLine.container !== 'undefined' && this.scrollbarLine.container !== null) {\n    this.scrollbarLine.container.displayGroup.removeAll(true);\n    this.scrollbarLine.container.displayGroup.destroy();\n    this.scrollbarLine.container = undefined;\n  }\n  \n  if (typeof this.scrollbar.container !== 'undefined' && this.scrollbar.container !== null) {\n    this.scrollbar.container.displayGroup.removeAll(true);\n    this.scrollbar.container.displayGroup.destroy();\n    this.scrollbar.container = undefined;\n  }\n  this.scrollbarLine.sprite = undefined;\n  this.scrollbar.sprite = undefined;\n};\n\nScrollbar.prototype.update = function () {\n  // TODO: Stub.\n};\n\n/** Explicitly define setters and getters */\n// value\nObject.defineProperty(Scrollbar.prototype, 'value', {\n  get: function () {\n    return this._value;\n  },\n  set: function (value) {\n    this._value = Math.min(Math.max(0, value), 1);\n    this.redraw();\n    this.onSetValue.dispatch(this._value);\n  }\n});\n","'use strict';\n\nvar Card = require('./Card');\nvar tactics = require('../../static/assets/tactics.json');\n\nfunction Tactic(game, x, y, assetName, multiUse = false) {\n  Card.call(this, game, x, y, assetName, multiUse);\n}\n\nTactic.prototype = Object.create(Card.prototype);\nmodule.exports = Tactic.prototype.constructor = Tactic;\n\n/* BEGIN OVERRIDE FUNCTIONS */\nTactic.prototype.getName = function () {\n  return tactics[this.key]['name'];\n};\n\nTactic.prototype.getDescription = function () {\n  return tactics[this.key]['desc'];\n};\n/* END OVERRIDE FUNCTIONS */","/*\n * Toast\n * ====\n *\n * A sample prefab (extended game object class), displaying a toast (popup at top of game screen) that displays\n * text and disappears after several seconds.\n */\n\n'use strict';\n\nvar textstyles = require('../../static/assets/textstyles.json');\n\nfunction Toast(game, message, timeout) {\n  Phaser.Group.call(this, game);\n\n  this._game = game;\n  this.message = message;\n  this.timeout = timeout;\n\n  if (game.toast) {\n    game.toast.toast.container.displayGroup.removeAll();\n    game.toast.destroy();\n  }\n\n  // private members specifying margin and padding\n  this.toastTextY = 16;\n\n  this.toastHeight = game.height * 1/12;\n  this.toastWidth = game.width * 1/2;\n\n  this.toastX = game.width * 1/2 - this.toastWidth * 1/2;\n  this.toastY = 8;\n\n  game.slickUI.add(this.toast = new SlickUI.Element.DisplayObject(\n    this.toastX, this.toastY, game.make.sprite(0, 0, 'toast'),\n    this.toastWidth, this.toastHeight));\n  this.toast.displayObject.width = this.toastWidth;\n  this.toast.displayObject.height = this.toastHeight;\n\n  game.toast = this;\n\n  this.toast.add(\n    this.toastText = new SlickUI.Element.DisplayObject(0, 0, \n      game.make.text(0, this.toastTextY, message, textstyles['toast']))\n  );\n  this.toastText.displayObject.setTextBounds(0, this.toastTextY, this.toastWidth, this.toastHeight);\n\n  this.toast.alpha = 0.8;\n\n  game.time.events.add(Phaser.Timer.SECOND * timeout, destroyPopup, this);\n}\n\nfunction destroyPopup() {\n  this.toast.container.displayGroup.removeAll();\n  this.destroy();\n}\n\nToast.prototype = Object.create(Phaser.Group.prototype);\nmodule.exports = Toast.prototype.constructor = Toast;","'use strict';\n\nvar Card = require('../objects/Card');\nvar Tactic = require('../objects/Tactic');\nvar Argument = require('../objects/Argument');\nvar items = require('../../static/assets/items.json');\nvar Player = require('../objects/Player');\nvar Room = require('../objects/Room');\n\nvar BattleUi = require('../objects/BattleUi.js');\nvar ArgumentManager = require('../objects/ArgumentManager');\nvar DialogueWindow = require('../objects/DialogueWindow');\nvar CustomActions = require('../utils/CustomActions');\n\nexports.preload = function(game) {\n  // preload all UI menu themes.\n  game.slickUI.load('ui/kenney-theme/kenney.json');\n};\n\nexports.create = function (game) {\n  if (game.player === null || typeof game.player === 'undefined') {\n    game.player = game.add.existing(new Player(game));\n    // DUMMY DATA\n    game.player.inventory.push('listener');\n    game.player.inventory.push('note');\n    game.room = (new Room(game, 'hangar'));\n    // END DUMMY DATA\n  }\n  // Companions\n  game.companions = ['Mysterious Voice', 'Kismet'];  // DUMMY DATA\n\n  // Music\n  \n\n  game.argumentManager = new ArgumentManager(game);\n  var customActions = new CustomActions(game);\n  game.argumentManager = new ArgumentManager(game, customActions);\n\n  game.argumentManager.loadJSONConversation('battle01');\n  game.currentArgument = 0;\n  game.playerTurn = true;\n  game.cred = 4;\n  game.persuasion = 5;\n  game.turnCount = 0;\n\n  // adding in player cards and face\n  game.playerDeck = [];\n  for (var i = 0; i < game.player.inventory.length; i++) {\n    game.playerDeck.push(new Card(game, 0,0, items[game.player.inventory[i]]['id']));\n  }\n\n  // adding opponent face and opponent cards --to do: fetch these from main game state\n  game.opponentDeck = [];\n  game.args = game.argumentManager.getAllArguments();\n  for (i = 0; i < game.args.length; i++) {\n    // TODO: support for multiple counters\n    if ('bluff' in game.args[i] && game.args[i]['bluff'] === true) {\n      // do not include bluffs\n      continue;\n    }\n    if (game.args[i]['counters'].length <= 0)\n      continue;\n    game.opponentDeck.push(new Argument(game, 0,0, game.args[i]['id'], game.args[i]['counters'][0], i));\n  }\n\n  game.battleUi = new BattleUi(game, game.playerDeck, game.opponentDeck);\n  game.battleUi.cardSignal.add(cardAction, this);\n  game.battleUi.companionSignal.add(companionText, this);\n\n  game.dialogueWindow = new DialogueWindow(game, game.argumentManager);\n  startLogicBattle(game);\n};\n\nfunction startLogicBattle(game) {\n  // Load JSON\n  game.dialogueWindow.loadJSONConversation('battle01');\n\n  // Play intro sequence and display\n  game.argumentManager.startSpecialArgument('intro');\n  game.dialogueWindow.display();\n\n  // Disable and then reenable input\n  game.battleUi.cardsInputEnabled(false);\n  game.argumentManager.specialCompleteSignal.add(function () {\n    /* Fun intro display stuff */\n    // Display overlay and intro text\n    var introTween = game.battleUi.introTweens();\n    introTween.onComplete.add(function () {\n      game.battleUi.battleStart();  // enable cards and reveal current arg\n      game.dialogueWindow.display();\n   \n      // Start music\n      if (typeof game.music !== 'undefined' && game.music !== null)\n        game.music.fadeOut(1000); // fade out previous music\n      game.music = game.sound.play('off-limits');\n      game.music.fadeIn(1000);\n      game.music.loopFull(1);\n    });\n\n    game.argumentManager.specialCompleteSignal.removeAll();\n  });\n\n  game.turnCount = 1;\n}\n\nfunction cardAction(game, card) {\n  if (game.playerTurn) {\n    game.dialogueWindow.skipText();\n\n    game.playerTurn = false;\n    game.battleUi.cardsInputEnabled(false);\n\n    var argument = game.opponentDeck[game.currentArgument];\n\n    var isCorrect = card.key === argument.key;\n\n    if (isCorrect) {\n\n      game.battleUi.playCardAnimation(card, argument, true);\n      game.opponentDeck[game.currentArgument] = undefined;\n      argument.destroy();\n      if (!card.multiUse) {\n        card.destroy();\n      }\n        \n    } else {\n      game.battleUi.playCardAnimation(card, argument, false);\n\n    }\n\n    var textType = isCorrect ? 'correct' : 'incorrect';\n\n    game.battleUi.cardAnimCompleteSignal.add(argumentInterlude, this, game, textType);\n  }\n}\n\nfunction companionText(game, speaker) {\n  if (game.playerTurn) {\n    game.dialogueWindow.skipText();\n    game.battleUi.cardsInputEnabled(false);\n\n    game.argumentManager.startInterlude(speaker);\n    game.dialogueWindow.display();\n\n    game.argumentManager.interludeCompleteSignal.add(function () {\n      game.battleUi.cardsInputEnabled(true);\n      game.dialogueWindow.display();\n      game.argumentManager.interludeCompleteSignal.removeAll();\n    });\n  }\n}\n\nfunction argumentInterlude(game, type) {\n  game.argumentManager.startInterlude(type);\n  game.dialogueWindow.display();\n  game.argumentManager.interludeCompleteSignal.add(function () {\n    opponentTurn(game);\n    game.argumentManager.interludeCompleteSignal.removeAll();\n  });\n\n  game.battleUi.cardAnimCompleteSignal.removeAll();\n}\n\nfunction gleamingShoalBluff(game) {\n  game.argumentManager.startSpecialArgument('ability', 'bluff');\n  game.dialogueWindow.display();\n\n  // special bluff. hard-coded.\n  var lastArgument = game.opponentDeck.pop();\n  for (var i = 0; i < game.args.length; i++) {\n    if ('bluff' in game.args[i] && game.args[i]['bluff'] === true) {\n      // TODO: use Mersenne-Twister for more randomness\n      var randPosition = Math.random();\n      var newBluff = new Argument(game, 0,0, game.args[i]['id'], game.args[i]['counters'][0], i);\n      if (randPosition > 0.5) {\n        game.opponentDeck.unshift(newBluff);\n      } else {\n        game.opponentDeck.push(newBluff);\n      }\n    }\n  }\n  // add last argument to the end.\n  game.opponentDeck.push(lastArgument);\n}\n\nfunction giveCallBluffTactic(game) {\n  // Give player a special Call Bluff tactic.\n  var callBluff = new Tactic(game, 0, 0, 'call-bluff', true /* multiUse */);\n  game.playerDeck.push(callBluff);\n  game.battleUi.makeCardIcon(callBluff);\n}\n\n/** TODO: HARDCODED SPECIAL ACTIONS = AWFUL */\nfunction checkSpecialActions(game) {\n  return game.turnCount === 2;\n}\nfunction specialActions(game) {\n  if (game.turnCount === 2) {\n    // on the second turn, bluff\n    gleamingShoalBluff(game); // adds arguments into model\n    // when we finish the ability text...\n    game.argumentManager.specialCompleteSignal.add(function () {\n      // shuffle\n      var rouletteTween = game.battleUi.rouletteArguments();\n      rouletteTween.onComplete.add(function () {\n        // add arguments into ui view\n        updateCurrentArgument(game);\n        game.battleUi.updateArguments(game.opponentDeck, game.currentArgument);\n        game.battleUi.positionArguments(game);\n        game.battleUi.argAnimCompleteSignal.add(function () {\n          finishOpponentTurn(game);\n          giveCallBluffTactic(game);\n          game.battleUi.argAnimCompleteSignal.removeAll();\n        });\n      }, this);\n      game.argumentManager.specialCompleteSignal.removeAll();\n    });\n    \n    return true;\n  }\n  // TODO: randomly entrench or shuffle\n  if (game.turnCount > 2) {\n    // do nothing for now.\n    return false;\n  }\n}\n\nfunction opponentTurn(game) {\n  game.turnCount++;\n\n  if (game.opponentDeck[game.currentArgument] === undefined) {\n    game.persuasion -= 1;\n    game.battleUi.updatePersuasionBar();    \n  } else if (game.opponentDeck[game.currentArgument]) {\n\n    game.cred -= 1;\n    game.battleUi.updateCredBar(game.cred, true); // update cred bar with damage indication\n  } else {\n    game.persuasion -= 1;\n    game.battleUi.updatePersuasionBar();\n  }\n\n  updateCurrentArgument(game);\n  game.battleUi.updateArguments(game.opponentDeck, game.currentArgument);\n  game.battleUi.positionArguments(game, true);\n  // Display arguments on animation completion\n  game.battleUi.argAnimCompleteSignal.add(function () {\n    var hasSpecialAction = checkSpecialActions(game);\n    if (hasSpecialAction) {\n      game.battleUi.argAnimCompleteSignal.removeAll();\n      specialActions(game);\n      return;\n    }\n    finishOpponentTurn(game);\n    game.battleUi.argAnimCompleteSignal.removeAll();\n  }, this);\n\n}\n\nfunction finishOpponentTurn(game) {\n  // upon finishing argument positioning\n  // reveal current argument\n  game.battleUi.revealCurrent();\n\n  // reenable player input and start player turn\n  updateArgumentWindow(game);\n  game.battleUi.positionCards();\n  game.battleUi.cardsInputEnabled(true);\n  game.playerTurn = true;\n}\n\n// For ArgumentManager\nfunction currentArgumentJsonIdx(game) {\n  var currentArgument = game.opponentDeck[game.currentArgument];\n  if (!currentArgument)\n    return -1;\n  return currentArgument.jsonIdx;\n}\n\nfunction updateArgumentWindow(game) {\n  game.argumentManager.advanceToTarget(currentArgumentJsonIdx(game));\n  if(game.cred === 0) {\n    game.argumentManager.startSpecialArgument('lose');\n  }\n  if(game.persuasion === 0) {\n    game.argumentManager.startSpecialArgument('win');\n  }\n  game.dialogueWindow.display();\n}\n\nfunction updateCurrentArgument(game) {\n  game.currentArgument += 1;\n\n  for (var i = 0; i < game.opponentDeck.length; i++) {\n    var idx = game.currentArgument + i;\n    if (idx >= game.opponentDeck.length)\n      idx -= game.opponentDeck.length;\n    // if exists\n    if (typeof game.opponentDeck[idx] !== 'undefined' && game.opponentDeck[idx] !== null) {\n      game.currentArgument = idx;\n      return;\n    }\n  }\n  // exiting means we have no more arguments\n}\n","/*\n * Boot state\n * ==========\n *\n * The first state of the game, responsible for setting up some Phaser\n * features. Adjust the game appearance, number of input pointers, screen\n * orientation handling etc. using this game state.\n */\n\n'use strict';\n\nvar assets = require('../assets');\n\nexports.preload = function (game) {\n  // Point the Phaser Asset Loader to where your game assets live.\n  game.load.path = 'assets/';\n\n  // Initialize physics engines here. Remember that Phaser builds including\n  // Arcade Physics have it enabled by default.\n  //game.physics.startSystem(Phaser.Physics.P2);\n\n  // Adjust how many pointers Phaser will check for input events.\n  game.input.maxPointers = 2;\n\n  // Set the alignment of the game canvas within the page.\n  game.scale.pageAlignHorizontally = true;\n\n  // Adjust the scaling mode of the game canvas.\n  // Example: If you're developing a pixel-art game, set it to 'USER_SCALE'.\n  game.scale.scaleMode = Phaser.ScaleManager.NO_SCALE;\n\n  // When using 'USER_SCALE' scaling mode, use this method to adjust the\n  // scaling factor.\n  //game.scale.setUserScale(2);\n\n  // Uncomment the following line to adjust the rendering of the canvas to\n  // crisp graphics. Great for pixel-art!\n  //Phaser.Canvas.setImageRenderingCrisp(game.canvas);\n\n  // Uncomment this line to disable smoothing of textures.\n  //game.stage.smoothed = false;\n\n  // If the game canvas loses focus, keep the game loop running.\n  game.stage.disableVisibilityChange = true;\n\n  // Whether to use frame-based interpolations or not.\n  game.tweens.frameBased = false;\n\n  // Load the graphical assets required to show the splash screen later,\n  // using the asset pack data.\n  game.load.pack('boot', null, assets);\n};\n\nexports.create = function (game) {\n  // After applying the first adjustments and loading the splash screen\n  // assets, move to the next game state.\n  game.state.start('Preloader');\n};\n","/*\n* Credits state\n* =============\n*\n* The player should be able to return to the main menu.\n*\n*/\n\n'use strict';\n\nexports.init = function() {\n  this.description = 'Congratulations! You\\'ve reached the end of our playable demo. \\\n  We hope you enjoyed the first chapter of Quasaria as much as we enjoyed making it!';\n  this.credits = 'Developed by:\\nAlexandros Christodoulou-Rubalcava\\nHana Lee\\nAmber Thomas\\nEdward Wang';\n};\n\nexports.create = function (game) {\n  this.camera.flash('#000000', 2000);\n\n\n  if (typeof game.music !== 'undefined' && game.music !== null)\n    game.music.fadeOut(1000); // fade out previous music\n  game.music = game.sound.play('sunrise-from-orbit');\n  game.music.loopFull(1);\n  \n\n  //might not be in quotes, its an issue below\n  var screen = game.add.sprite(game.world.centerX, game.world.centerY, 'menu_screen');\n  screen.anchor.setTo(0.5, 0.5);\n\n  let screenFont = 'Cinzel Decorative';\n  let fillColor = '#42dff4';\n\n  var descText = game.add.text(game.world.centerX, game.world.centerY - 100, this.description, {\n    font: '16px ' + screenFont,\n    fill: fillColor,\n    align: 'center',\n    wordWrap: true,\n    wordWrapWidth: game.width - 300\n  });\n\n  var creditsText = game.add.text(game.world.centerX, game.world.centerY + 120, this.credits, {\n    font: '16px ' + screenFont,\n    fill: fillColor,\n    align: 'center',\n    wordWrap: true,\n    wordWrapWidth: game.width - 300\n  });\n\n  var mainMenuText = game.add.text(game.world.centerX, game.world.centerY, 'Main Menu', {\n    font: '50px ' + screenFont,\n    fill: fillColor,\n    align: 'center'\n  });\n\n  descText.anchor.setTo(0.5, 0.5);\n  creditsText.anchor.setTo(0.5, 0.5);\n\n  mainMenuText.anchor.setTo(0.5, 0.5);\n  mainMenuText.inputEnabled = true;\n  mainMenuText.events.onInputOver.add(function() {\n    mainMenuText.fill = '#ff00ff';\n  }, this);\n\n  mainMenuText.events.onInputOut.add(function() {\n    mainMenuText.fill = '#42dff4';\n  }, this);\n\n  mainMenuText.events.onInputDown.add(function () {\n    game.state.start('MainMenu');\n  }, this);\n\n};\n","/*\n* Game state\n* ==========\n*\n* A sample Game state, displaying the Phaser logo.\n*/\n\n'use strict';\n\nvar Room = require('../objects/Room');\nvar Player = require('../objects/Player');\nvar DialogueWindow = require('../objects/DialogueWindow');\nvar ConversationManager = require('../objects/ConversationManager');\nvar CustomActions = require('../utils/CustomActions');\nvar MemoryBankWindow = require('../objects/MemoryBankWindow');\nvar AreaTransitionWindow = require('../objects/AreaTransitionWindow');\nvar SaveButton = require('../objects/SaveButton');\n\nexports.preload = function(game) {\n  // preload all UI menu themes.\n  game.slickUI.load('ui/kenney-theme/kenney.json');\n};\n\nexports.init = function(game, resumeGame, fromBattle){\n\n  let playerState = localStorage.getItem('playerState');\n  if (fromBattle) {\n    game.room = new Room(game, 'hangar');  \n  } else if (resumeGame && playerState !== null){\n    Player.unserialize(playerState, game);\n    //current room is actually room.area\n    //need to deep copy, otherwise we will loose the area info\n    var area = JSON.parse(JSON.stringify(game.player.currentRoom));\n    game.room = (new Room(game, area.id));\n    game.room.area = area;\n\n  } else { //check if old model blinks\n    localStorage.clear();\n    game.player = (new Player(game));\n    // game.player.variables['debug'] = 'true';    // comment this out to get rid of DEBUG - SKIP TO END conversation options\n    game.player.convoFile = 'prologue01';\n    game.room = (new Room(game, 'shuttle'));\n\n  }\n\n};\n\nexports.create = function (game) {\n\n  this.camera.flash('#000000', 2000);\n  game.add.existing(game.player);\n\n  game.add.existing(game.room);\n  game.room.addItems();\n\n\n  // we previously had music in the game state, but I move it to the room object\n  // so that we can have different themes for different rooms\n  // need to set the music in the other states like logic battles\n\n  game.add.existing(new SaveButton(game));\n\n  // custom actions for conversations\n  var customActions = new CustomActions(game);\n  // conversation manager\n  var convoManager = new ConversationManager(game, customActions);\n  convoManager.idx = game.player.convoIdx;\n  convoManager.shown = game.player.shownConvo;\n\n  // dialogue window object\n  game.dialogueWindow = new DialogueWindow(game, convoManager);\n  // memory bank window object\n  game.memoryBankWindow = new MemoryBankWindow(game);\n  // area transition window object\n  game.areaTransitionWindow = new AreaTransitionWindow(game);\n\n  game.dialogueWindow.begin(game.player.convoFile);\n\n};\n","/*\n* Game Over state\n* ===============\n*\n* The player should be able to restart a saved game or return to the main menu..\n*\n*/\n\n'use strict';\n\nexports.init = function(game, gameOverText) {\n  this.gameOverText = gameOverText;\n};\n\nexports.create = function (game) {\n  this.camera.flash('#000000', 2000);\n\n  if (typeof game.music !== 'undefined' && game.music !== null)\n    game.music.fadeOut(1000); // fade out previous music\n  game.music = game.sound.play('cold-moon');\n  game.music.loopFull(1);\n  //might not be in quotes, its an issue below\n  var screen = game.add.sprite(game.world.centerX, game.world.centerY, 'menu_screen');\n  screen.anchor.setTo(0.5, 0.5);\n\n  let screenFont = 'Cinzel Decorative';\n  let fillColor = '#42dff4';\n\n  var titleText = game.add.text(game.world.centerX, game.world.centerY- 85, 'Game Over', {\n    font: '75px ' + screenFont,\n    fontWeight: 'bold',\n    fill: fillColor,\n    align: 'center'\n  });\n\n  var descText = game.add.text(game.world.centerX, game.world.centerY - 20, this.gameOverText, {\n    font: '25px ' + screenFont,\n    fill: fillColor,\n    align: 'center'\n  });\n\n  var contText = game.add.text(game.world.centerX, game.world.centerY + 30, 'Reload', {\n    font: '50px ' + screenFont,\n    fill: fillColor,\n    align: 'center'\n  });\n\n  var mainMenuText = game.add.text(game.world.centerX, game.world.centerY + 85, 'Main Menu', {\n    font: '50px ' + screenFont,\n    fill: fillColor,\n    align: 'center'\n  });\n\n  titleText.anchor.setTo(0.5, 0.5);\n\n  descText.anchor.setTo(0.5, 0.5);\n\n  contText.anchor.setTo(0.5, 0.5);\n  contText.inputEnabled = true;\n  contText.events.onInputOver.add(function() {\n    contText.fill = '#ff00ff';\n  }, this);\n\n  contText.events.onInputOut.add(function() {\n    contText.fill = '#42dff4';\n  }, this);\n\n  contText.events.onInputDown.add(function () {\n    let resumeGame = true;\n    game.state.start('Game', true, false, game, resumeGame);\n  }, this);\n\n  mainMenuText.anchor.setTo(0.5, 0.5);\n  mainMenuText.inputEnabled = true;\n  mainMenuText.events.onInputOver.add(function() {\n    mainMenuText.fill = '#ff00ff';\n  }, this);\n\n  mainMenuText.events.onInputOut.add(function() {\n    mainMenuText.fill = '#42dff4';\n  }, this);\n\n  mainMenuText.events.onInputDown.add(function () {\n    game.state.start('MainMenu');\n  }, this);\n\n};\n","/*\n* Main Menu state\n* ===============\n*\n* The player should be able to restart a saved game or start a new game.\n*\n*/\n\n'use strict';\n\nexports.create = function (game) {\n\n  //might not be in quotes, its an issue below\n  if (typeof game.music !== 'undefined' && game.music !== null)\n    game.music.fadeOut(1000); // fade out previous music\n  game.music = game.sound.play('menu-theme-terraform');\n  game.music.loopFull(1);\n\n  var screen = game.add.sprite(game.world.centerX, game.world.centerY, 'menu_screen');\n  screen.anchor.setTo(0.5, 0.5);\n\n  var logo = game.add.sprite(game.world.centerX, game.world.centerY - 30, 'quasaria-logo-MM');\n  logo.anchor.setTo(0.5, 0.5);\n  logo.alpha = .1;\n\n  let screenFont = 'Cinzel Decorative';\n  let fillColor = '#42dff4';\n\n  var titleText = game.add.text(game.world.centerX, game.world.centerY- 75, 'Quasaria', {\n    font: '75px ' + screenFont,\n    fontWeight: 'bold',\n    fill: fillColor,\n    align: 'center'\n  });\n\n  var contText = game.add.text(game.world.centerX, game.world.centerY, 'Continue', {\n    font: '50px ' + screenFont,\n    fill: fillColor,\n    align: 'center'\n  });\n\n  var newGameText = game.add.text(game.world.centerX, game.world.centerY + 55, 'New Game', {\n    font: '50px ' + screenFont,\n    fill: fillColor,\n    align: 'center'\n  });\n\n  titleText.anchor.setTo(0.5, 0.5);\n\n\n  contText.anchor.setTo(0.5, 0.5);\n  contText.inputEnabled = true;\n  contText.events.onInputOver.add(function() {\n    contText.fill = '#ff00ff';\n  }, this);\n\n  contText.events.onInputOut.add(function() {\n    contText.fill = '#42dff4';\n  }, this);\n\n  contText.events.onInputDown.add(function () {\n    let resumeGame = true;\n    game.state.start('Game', true, false, game, resumeGame);\n  }, this);\n\n  newGameText.anchor.setTo(0.5, 0.5);\n  newGameText.inputEnabled = true;\n  newGameText.events.onInputOver.add(function() {\n    newGameText.fill = '#ff00ff';\n  }, this);\n\n  newGameText.events.onInputOut.add(function() {\n    newGameText.fill = '#42dff4';\n  }, this);\n\n  newGameText.events.onInputDown.add(function () {\n    let resumeGame = false;\n    game.state.start('Game', true, false, game, resumeGame);\n  }, this);\n\n};\n","/*\n * Preloader state\n * ===============\n *\n * Takes care of loading the main game assets, including graphics and sound\n * effects, while displaying a busy splash screen.\n */\n\n'use strict';\n\nvar assets = require('../assets');\n\n\nfunction showSplashScreen (game) {\n  game.add.image(0, 0, 'splash-screen');\n  game.load.setPreloadSprite(game.add.image(82, 282, 'progress-bar'));\n}\n\nexports.preload = function (game) {\n  showSplashScreen(game);\n  game.load.pack('game', null, assets);\n  game.load.pack('main_menu', null, assets);\n  game.load.pack('ui', null, assets);\n  game.load.pack('conversations', null, assets);\n  game.load.pack('sounds', null, assets);\n  game.load.pack('logic_battle', null, assets);\n};\n\nexports.create = function (game) {\n  // Here is a good place to initialize plugins dependent of any game asset.\n  // Don't forget to `require` them first. Example:\n  //game.myPlugin = game.plugins.add(MyPlugin/*, ... parameters ... */);\n\n  // Slick UI initialization; added from index.html\n  // NOTE: slick UI loads theme from cache\n  // between preload and create functions FOR EACH STATE\n  game.slickUI = game.plugins.add(Phaser.Plugin.SlickUI);\n\n  game.state.start('MainMenu');\n\n};\n","/*\n * `states` module\n * ===============\n *\n * Declares all present game states.\n * Expose the required game states using this module.\n */\n\n'use strict';\n\nexports.Boot = require('./Boot');\nexports.Preloader = require('./Preloader');\nexports.MainMenu = require('./MainMenu');\nexports.Game = require('./Game');\nexports.Battleground = require('./Battleground');\nexports.GameOver = require('./GameOver');\nexports.Credits = require('./Credits');","/*\n * Custom Actions\n * ===================\n *\n * Stores code for custom actions to be taken during conversations.\n */\n\n'use strict';\n\nmodule.exports = CustomActions;\n\nfunction CustomActions(game/*, ...args*/) {\n  Phaser.Group.call(this, game/*, ...args*/);\n  this._game = game;\n}\n\nCustomActions.prototype = Object.create(Phaser.Group.prototype);\nCustomActions.prototype.constructor = CustomActions;\n\nCustomActions.prototype.customAction = function(action) {\n  if (action.startsWith('fadeInAndOut')) {\n    this.fadeInAndOut(parseInt(action.substring('fadeInAndOut'.length)));\n  } else if (action === 'startConv:prologue02') {\n    this._game.camera.fade('#000000', 2000);\n    this._game.camera.onFadeComplete.addOnce(function() {\n      this._game.camera.flash('#000000', 2000);\n      this.startConversation('prologue02');\n    }, this);\n  } else if (action.startsWith('moveToArea:')) {\n    this.moveToArea(action.substring('moveToArea:'.length));\n  } else if (action === 'startBattle') {\n    this.loadBattle();  \n  } else if (action === 'loadMainGameState') {\n    this._game.state.start('Game', true, false, this._game, false, true);\n  } else if (action.startsWith('gameover')) {\n    this._game.state.start('GameOver', true, false, this._game, action.substring('gameover'.length));\n  } else if (action === 'credits') {\n    this._game.state.start('Credits', true, false, this._game);\n  }\n};\n\n\n\n\nCustomActions.prototype.loadBattle = function() {\n  this._game.dialogueWindow.hide();\n  this._game.state.start('Battleground', true, false);\n};\n\nCustomActions.prototype.startConversation = function(conv) {\n  this._game.dialogueWindow.begin(conv);\n};\n\nCustomActions.prototype.moveToArea = function(area) {\n  this._game.room.loadArea(area);\n};\n\nCustomActions.prototype.fadeInAndOut = function(duration) {\n  this._game.camera.fade('#000000', duration/2);\n  this._game.dialogueWindow.avatar.visible = false;\n  this._game.dialogueWindow.dialogPanel.visible = false;\n  this._game.camera.onFadeComplete.addOnce(function() {\n    this._game.camera.flash('#000000', duration/2);\n    this._game.dialogueWindow.avatar.visible = true;\n    this._game.dialogueWindow.dialogPanel.visible = true;\n  }, this);\n};","module.exports={\n\t\"shuttle\": {\n\t\t\"id\": \"shuttle\",\n\t\t\"name\": \"Shuttle\",\n\t\t\"bg\": \"shuttle\",\n\t\t\"music\": \"puzzle2\",\n\t\t\"items\": [\n\t\t\t{\n\t\t\t\t\"id\": \"listener\",\n\t\t\t\t\"x\": 150,\n\t\t\t\t\"y\": 150,\n\t\t\t\t\"height\": 100,\n\t\t\t\t\"width\": 100\n\t\t\t}, {\n\t\t\t\t\"id\": \"note\",\n\t\t\t\t\"x\": 720,\n\t\t\t\t\"y\": 200,\n\t\t\t\t\"height\": 100,\n\t\t\t\t\"width\": 100\n\t\t\t}\n\t\t],\n\t\t\"placeables\": [],\n\t\t\"npcs\": [],\n\t\t\"navigable\": false,\n\t\t\"areaAccess\": []\n\t},\n\t\"hangar\": {\n\t\t\"id\": \"hangar\",\n\t\t\"name\": \"Hangar Bay\",\n\t\t\"bg\": \"hangar\",\n\t\t\"music\": \"lostjungle\",\n\t\t\"items\": [],\n\t\t\"placeables\": [\n\t\t\t{\n\t\t\t\t\"id\": \"shuttle-placeable\",\n\t\t\t\t\"x\": 475,\n\t\t\t\t\"y\": 300,\n\t\t\t\t\"height\": 300,\n\t\t\t\t\"width\": 401\n\t\t\t}\n\t\t],\n\t\t\"npcs\": [\n\t\t\t{\n\t\t\t\t\"id\": \"Vesper\",\n\t\t\t\t\"x\": 100,\n\t\t\t\t\"y\": 350,\n\t\t\t\t\"height\": 350,\n\t\t\t\t\"width\": 150\n\t\t\t}, {\n\t\t\t\t\"id\": \"Gleaming Shoal\",\n\t\t\t\t\"x\": 400,\n\t\t\t\t\"y\": 300,\n\t\t\t\t\"height\": 400,\n\t\t\t\t\"width\": 400,\n\t\t\t\t\"showif\": {\n\t\t\t\t\t\"xenopsychologist\": \"done\",\n\t\t\t\t\t\"xenobiologist\": \"done\"\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\t\"navigable\": true,\n\t\t\"areaAccess\": [\"medbay\"]\n\t},\n\t\"medbay\": {\n\t\t\"id\": \"medbay\",\n\t\t\"name\": \"Medical Bay\",\n\t\t\"bg\": \"medbay\",\n\t\t\"music\": \"puzzle1\",\n\t\t\"items\": [],\n\t\t\"placeables\": [],\n\t\t\"npcs\": [\n\t\t\t{\n\t\t\t\t\"id\": \"Dr. Talvine Mesmer-Quiverly\",\n\t\t\t\t\"x\": 320,\n\t\t\t\t\"y\": 340,\n\t\t\t\t\"height\": 183,\n\t\t\t\t\"width\": 100\n\t\t\t}, {\n\t\t\t\t\"id\": \"Dr. Valken\",\n\t\t\t\t\"x\": 600,\n\t\t\t\t\"y\": 250,\n\t\t\t\t\"height\": 330,\n\t\t\t\t\"width\": 112.5\n\t\t\t}\n\t\t],\n\t\t\"navigable\": true,\n\t\t\"areaAccess\": [\"hangar\"]\n\t}\n}\n","module.exports={\n\t\"listener\": {\n\t\t\"id\": \"listener\",\n\t\t\"url\": \"listener.png\",\n\t\t\"name\": \"Listener\",\n\t\t\"desc\": \"A small, pocket-sized blue orb that is normally cool to the touch, but warms when your mysterious rescuer uses it to communicate with you. He/she told you to keep this safe, and let no one know of its true purpose.\"\n\t},\n\t\"note\": {\n\t\t\"id\": \"note\",\n\t\t\"url\": \"note.png\",\n\t\t\"name\": \"Indecipherable Note\",\n\t\t\"desc\": \"A note covered in strange alien symbols. Your mysterious rescuer left this for you, saying it would help explain things, but so far you can't understand it.\"\n\t},\n\t\"shuttle-placeable\": {\n\t\t\"id\": \"shuttle-placeable\",\n\t\t\"url\": \"shuttle-placeable.png\",\n\t\t\"name\": \"My Shuttle\",\n\t\t\"message\": \"That's my shuttle, but I can't go in there right now.\"\n\t},\n\t\"biologistApproval\": {\n\t\t\"id\": \"biologistApproval\",\n\t\t\"url\": \"talvine.png\",\n\t\t\"name\": \"Dr. Talvine's Report\",\n\t\t\"desc\": \"A clean bill of health from Dr. Talvine Mesmer-Quiverly, Station Zero's xenobiologist.\"\n\t},\n\t\"psychologistApproval\": {\n\t\t\"id\": \"psychologistApproval\",\n\t\t\"url\": \"valken.png\",\n\t\t\"name\": \"Dr. Valken's Report\",\n\t\t\"desc\": \"A briefing on your psychological state from Dr. Valken, Station Zero's xenopsychologist.\"\n\t},\n\t\"secretaryNote\": {\n\t\t\"id\": \"secretaryNote\",\n\t\t\"url\": \"secretaryNote.png\",\n\t\t\"name\": \"Memo to Garnetta\",\n\t\t\"desc\": \"\\\"Garnetta: keep talking with Clearance staff. You won't be interrupted.\\\"\"\n\t}\n}","module.exports={\n\t\"Mysterious Voice\": {\n\t\t\"id\": \"Mysterious Voice\",\n\t\t\"name\": \"Mysterious Voice\",\n\t\t\"image\": \"mysterious-voice\",\n\t\t\"avatar\": \"mysterious-voice\",\n\t},\n\t\"Gleaming Shoal\": {\n\t\t\"id\": \"Gleaming Shoal\",\n\t\t\"name\": \"Gleaming Shoal\",\n\t\t\"image\": \"gleaming-shoal-npc\",\n\t\t\"avatar\": \"gleaming-shoal\",\n\t\t\"conv\": \"gleaming-shoal01\"\n\t},\n\t\"Unknown Alien\": {\n\t\t\"id\": \"Gleaming Shoal\",\n\t\t\"name\": \"Unknown Alien\",\n\t\t\"image\": \"unknown-alien\",\n\t\t\"avatar\": \"unknown-alien\"\n\t},\n\t\"Kismet\": {\n\t\t\"id\": \"Kismet\",\n\t\t\"name\": \"Kismet\",\n\t\t\"image\": \"kismet\",\n\t\t\"avatar\": \"kismet\"\n\t},\n\t\"Vesper\": {\n\t\t\"id\": \"Vesper\",\n\t\t\"name\": \"Vesper\",\n\t\t\"image\": \"vesper-npc\",\n\t\t\"avatar\": \"vesper\",\n\t\t\"conv\": \"vesper01\"\n\t},\n\t\"Dr. Talvine Mesmer-Quiverly\": {\n\t\t\"id\": \"Dr. Talvine Mesmer-Quiverly\",\n\t\t\"name\": \"Dr. Talvine\",\n\t\t\"image\": \"talvine-npc\",\n\t\t\"avatar\": \"talvine\",\n\t\t\"conv\": \"talvine01\"\n\t},\n\t\"Dr. Valken\": {\n\t\t\"id\": \"Dr. Valken\",\n\t\t\"name\": \"Dr. Valken\",\n\t\t\"image\": \"valken-npc\",\n\t\t\"avatar\": \"valken\",\n\t\t\"conv\": \"valken01\"\n\t}\n}","module.exports={\n\t\"call-bluff\": {\n\t\t\"id\": \"call-bluff\",\n\t\t\"url\": \"call-bluff.png\",\n\t\t\"name\": \"Call Bluff\",\n\t\t\"desc\": \"Your adversary is willing to make some bold claims to win this argument. Call out their unsubstantiated bluffs for what they are.\"\n\t}\n}","module.exports={\n\t\"speaker\": {\n\t\t\"font\": \"20px Goudy Bookletter 1911\", \n\t\t\"fill\": \"#48f2ff\", \n\t\t\"wordWrap\": false, \n\t\t\"align\": \"left\"\n\t},\n\t\"dialogueBody\": {\n\t\t\"font\": \"14px Open Sans\", \n\t\t\"fill\": \"#48f2ff\", \n\t\t\"wordWrap\": true, \n\t\t//\"wordWrapWidth\": \"this._dialogTextWidth\",\n\t\t\"align\": \"left\"\n\t},\n\t\"choiceButton\": {\n\t\t\"font\": \"14px Open Sans\",\n\t\t\"fill\": \"#48f2ff\", \n\t\t\"wordWrap\": true,\n\t\t//\"wordWrapWidth\": this._dialogTextWidth - buttonSidePadding, \n\t\t\"align\": \"left\"\n\t},\n\t\"toast\": {\n\t\t\"font\": \"14px Open Sans\",\n\t\t\"fill\": \"#48f2ff\",\n\t\t\"boundsAlignH\": \"center\"\n\t},\n\t\"credibility\": {\n\t\t\"font\": \"32px Cinzel Decorative\", \n\t\t\"fontWeight\": \"bold\",\n\t\t\"fill\": \"#48f2ff\", \n\t\t\"boundsAlignH\": \"center\", \n\t\t\"boundsAlignV\": \"middle\"\n\t},\n\t\"mainMenuTitle\": {\n\t\t\"font\": \"75px Cinzel Decorative\",\n\t\t\"fontWeight\": \"bold\",\n\t\t\"fill\": \"#42dff4\",\n\t\t\"align\": \"center\"\n\t}, \n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYXBwLmpzIiwic3JjL2Fzc2V0cy5qcyIsInNyYy9vYmplY3RzL0FyZWFUcmFuc2l0aW9uV2luZG93LmpzIiwic3JjL29iamVjdHMvQXJndW1lbnQuanMiLCJzcmMvb2JqZWN0cy9Bcmd1bWVudE1hbmFnZXIuanMiLCJzcmMvb2JqZWN0cy9CYXR0bGVVaS5qcyIsInNyYy9vYmplY3RzL0NhcmQuanMiLCJzcmMvb2JqZWN0cy9DbGlja2FibGUuanMiLCJzcmMvb2JqZWN0cy9Db252ZXJzYXRpb25NYW5hZ2VyLmpzIiwic3JjL29iamVjdHMvRGlhbG9ndWVXaW5kb3cuanMiLCJzcmMvb2JqZWN0cy9IZWFsdGhCYXIuanMiLCJzcmMvb2JqZWN0cy9JY29uLmpzIiwic3JjL29iamVjdHMvTWVtb3J5QmFua1dpbmRvdy5qcyIsInNyYy9vYmplY3RzL05QQy5qcyIsInNyYy9vYmplY3RzL1BsYWNlYWJsZS5qcyIsInNyYy9vYmplY3RzL1BsYXllci5qcyIsInNyYy9vYmplY3RzL1Jvb20uanMiLCJzcmMvb2JqZWN0cy9TYXZlQnV0dG9uLmpzIiwic3JjL29iamVjdHMvU2Nyb2xsYmFyLmpzIiwic3JjL29iamVjdHMvVGFjdGljLmpzIiwic3JjL29iamVjdHMvVG9hc3QuanMiLCJzcmMvc3RhdGVzL0JhdHRsZWdyb3VuZC5qcyIsInNyYy9zdGF0ZXMvQm9vdC5qcyIsInNyYy9zdGF0ZXMvQ3JlZGl0cy5qcyIsInNyYy9zdGF0ZXMvR2FtZS5qcyIsInNyYy9zdGF0ZXMvR2FtZU92ZXIuanMiLCJzcmMvc3RhdGVzL01haW5NZW51LmpzIiwic3JjL3N0YXRlcy9QcmVsb2FkZXIuanMiLCJzcmMvc3RhdGVzL2luZGV4LmpzIiwic3JjL3V0aWxzL0N1c3RvbUFjdGlvbnMuanMiLCJzdGF0aWMvYXNzZXRzL2FyZWFzLmpzb24iLCJzdGF0aWMvYXNzZXRzL2l0ZW1zLmpzb24iLCJzdGF0aWMvYXNzZXRzL25wY3MuanNvbiIsInN0YXRpYy9hc3NldHMvdGFjdGljcy5qc29uIiwic3RhdGljL2Fzc2V0cy90ZXh0c3R5bGVzLmpzb24iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2VEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdmdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKlxuICogYGFwcGAgbW9kdWxlXG4gKiA9PT09PT09PT09PT1cbiAqXG4gKiBQcm92aWRlcyB0aGUgZ2FtZSBpbml0aWFsaXphdGlvbiByb3V0aW5lLlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuLy8gSW1wb3J0IGdhbWUgc3RhdGVzLlxudmFyIHN0YXRlcyA9IHJlcXVpcmUoJy4vc3RhdGVzJyk7XG5cbmV4cG9ydHMuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoODAwLCA2MDAsIFBoYXNlci5BVVRPKTtcblxuICAvLyBEeW5hbWljYWxseSBhZGQgYWxsIHJlcXVpcmVkIGdhbWUgc3RhdGVzLlxuICBPYmplY3RcbiAgICAua2V5cyhzdGF0ZXMpXG4gICAgLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgZ2FtZS5zdGF0ZS5hZGQoa2V5LCBzdGF0ZXNba2V5XSk7XG4gICAgfSk7XG5cbiAgZ2FtZS5zdGF0ZS5zdGFydCgnQm9vdCcpO1xuXG4gIHJldHVybiBnYW1lO1xufTtcbiIsIi8qXG4gKiBgYXNzZXRzYCBtb2R1bGVcbiAqID09PT09PT09PT09PT09PVxuICpcbiAqIERlY2xhcmVzIHN0YXRpYyBhc3NldCBwYWNrcyB0byBiZSBsb2FkZWQgdXNpbmcgdGhlIGBQaGFzZXIuTG9hZGVyI3BhY2tgXG4gKiBtZXRob2QuIFVzZSB0aGlzIG1vZHVsZSB0byBkZWNsYXJlIGdhbWUgYXNzZXRzLlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuLy8gLS0gU3BsYXNoIHNjcmVlbiBhc3NldHMgdXNlZCBieSB0aGUgUHJlbG9hZGVyLlxuZXhwb3J0cy5ib290ID0gW3tcbiAga2V5OiAnc3BsYXNoLXNjcmVlbicsXG4gIHR5cGU6ICdpbWFnZSdcbn0sIHtcbiAga2V5OiAncHJvZ3Jlc3MtYmFyJyxcbiAgdHlwZTogJ2ltYWdlJ1xufV07XG5cbmV4cG9ydHMubWFpbl9tZW51ID0gW3tcbiAga2V5OiAncXVhc2FyaWEtbG9nby1NTScsXG4gIHR5cGU6ICdpbWFnZSdcbn0sIHtcbiAga2V5OiAnY29udGludWVCdXR0b24nLFxuICB0eXBlOiAnaW1hZ2UnXG59LCB7XG4gIGtleTogJ21lbnVfc2NyZWVuJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmFja2dyb3VuZHMvbWVudV9zY3JlZW5fc2NhbGVkLnBuZydcbn1dO1xuXG5cbi8vIC0tIEdlbmVyYWwgYXNzZXRzIHVzZWQgdGhyb3VnaG91dCB0aGUgZ2FtZS5cbmV4cG9ydHMuZ2FtZSA9IFt7XG4gIGtleTogJ3F1YXNhcmlhLWxvZ28nLFxuICB0eXBlOiAnaW1hZ2UnXG59LCB7XG4gIGtleTogJ3NodXR0bGUnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdiYWNrZ3JvdW5kcy9zaHV0dGxlLnBuZydcbn0sIHtcbiAga2V5OiAnaGFuZ2FyJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmFja2dyb3VuZHMvaGFuZ2FyLnBuZydcbn0sIHtcbiAga2V5OiAnbWVkYmF5JyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmFja2dyb3VuZHMvbWVkYmF5LnBuZydcbn0sIHtcbiAga2V5OiAnbGlzdGVuZXInLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdpdGVtcy9saXN0ZW5lci5wbmcnXG59LCB7XG4gIGtleTogJ25vdGUnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdpdGVtcy9ub3RlLnBuZydcbn0sIHtcbiAga2V5OiAnYmlvbG9naXN0QXBwcm92YWwnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdhdmF0YXJzL3RhbHZpbmUucG5nJ1xufSwge1xuICBrZXk6ICdwc3ljaG9sb2dpc3RBcHByb3ZhbCcsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ2F2YXRhcnMvdmFsa2VuLnBuZydcbn0sIHtcbiAga2V5OiAnc2h1dHRsZS1wbGFjZWFibGUnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdpdGVtcy9zaHV0dGxlLXBsYWNlYWJsZS5wbmcnXG59LCB7XG4gIGtleTogJ3Zlc3Blci1ucGMnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICducGNzL3Zlc3Blci5wbmcnXG59LCB7XG4gIGtleTogJ3RhbHZpbmUtbnBjJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnbnBjcy90YWx2aW5lLnBuZydcbn0sIHtcbiAga2V5OiAndmFsa2VuLW5wYycsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ25wY3MvdmFsa2VuLnBuZydcbn0sIHtcbiAga2V5OiAnZ2xlYW1pbmctc2hvYWwtbnBjJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnbnBjcy9nbGVhbWluZy1zaG9hbC5wbmcnXG59XTtcblxuLy8gLS0gVUktc3BlY2lmaWMgYXNzZXRzLlxuZXhwb3J0cy51aSA9IFt7XG4gIGtleTogJ2RpYWxvZ3VlLWNob2ljZS1idXR0b24nLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICd1aS9kaWFsb2d1ZS1jaG9pY2UtYnV0dG9uLnBuZydcbn0sIHtcbiAga2V5OiAnZGlhbG9ndWUtcGFuZWwnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICd1aS9kaWFsb2d1ZS1wYW5lbC5wbmcnXG59LCB7XG4gIGtleTogJ3RvYXN0JyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAndWkvdG9hc3QucG5nJ1xufSwge1xuICBrZXk6ICdtZW1vcnktYmFuay1idXR0b24nLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICd1aS9tZW1vcnktYmFuay1idXR0b24ucG5nJ1xufSwge1xuICBrZXk6ICdtZW1vcnktYmFuay1pY29uJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAndWkvbWVtb3J5LWJhbmstaWNvbi5wbmcnXG59LCB7XG4gIGtleTogJ21lbW9yeS1iYW5rLWljb24tbWFzaycsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ3VpL21lbW9yeS1iYW5rLWljb24tbWFzay5wbmcnXG59LCB7XG4gIGtleTogJ21lbW9yeS1iYW5rLW5leHQnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICd1aS9tZW1vcnktYmFuay1uZXh0LnBuZydcbn0sIHtcbiAga2V5OiAnbWVtb3J5LWJhbmsnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICd1aS9tZW1vcnktYmFuay5wbmcnXG59LCB7XG4gIGtleTogJ3NhdmVCdXR0b24nLFxuICB0eXBlOiAnaW1hZ2UnXG59LCB7XG4gIGtleTogJ2J1dHRvbicsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ3VpL2J1dHRvbi5wbmcnXG59LCB7XG4gIGtleTogJ2JhdHRsZS1iYWNrZ3JvdW5kJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAndWkvYmF0dGxlLWJhY2tncm91bmQucG5nJ1xufSwge1xuICBrZXk6ICdiYXR0bGUtb3ZlcmxheScsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ3VpL2JhdHRsZS1vdmVybGF5LXNjYWxlZC5wbmcnXG59LCB7XG4gIGtleTogJ21lbW9yeS1iYW5rLWljb24tZmlsbCcsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ3VpL21lbW9yeS1iYW5rLWljb24tZmlsbC5wbmcnXG59LCB7XG4gIGtleTogJ2NvbXBhbmlvbi1pY29uJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAndWkvY29tcGFuaW9uLWljb24ucG5nJ1xufSwge1xuICBrZXk6ICdlbmVteS1hcmctaWNvbicsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ3VpL2VuZW15LWFyZy1pY29uLnBuZydcbn1dO1xuXG4vLyAtLSBDb252ZXJzYXRpb24ganNvbnMgYW5kIGF2YXRhcnMuXG5leHBvcnRzLmNvbnZlcnNhdGlvbnMgPSBbe1xuICBrZXk6ICdwcm9sb2d1ZTAxJyxcbiAgdHlwZTogJ2pzb24nLFxuICB1cmw6ICdjb252ZXJzYXRpb25zL3Byb2xvZ3VlMDEuanNvbidcbn0sIHtcbiAga2V5OiAncHJvbG9ndWUwMicsXG4gIHR5cGU6ICdqc29uJyxcbiAgdXJsOiAnY29udmVyc2F0aW9ucy9wcm9sb2d1ZTAyLmpzb24nXG59LCB7XG4gIGtleTogJ3Zlc3BlcjAxJyxcbiAgdHlwZTogJ2pzb24nLFxuICB1cmw6ICdjb252ZXJzYXRpb25zL3Zlc3BlcjAxLmpzb24nXG59LCB7XG4gIGtleTogJ3RhbHZpbmUwMScsXG4gIHR5cGU6ICdqc29uJyxcbiAgdXJsOiAnY29udmVyc2F0aW9ucy90YWx2aW5lMDEuanNvbidcbn0sIHtcbiAga2V5OiAndmFsa2VuMDEnLFxuICB0eXBlOiAnanNvbicsXG4gIHVybDogJ2NvbnZlcnNhdGlvbnMvdmFsa2VuMDEuanNvbidcbn0sIHtcbiAga2V5OiAnZ2xlYW1pbmctc2hvYWwwMScsXG4gIHR5cGU6ICdqc29uJyxcbiAgdXJsOiAnY29udmVyc2F0aW9ucy9nbGVhbWluZy1zaG9hbDAxLmpzb24nXG59LCB7XG4gIGtleTogJ215c3RlcmlvdXMtdm9pY2UnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdhdmF0YXJzL215c3RlcmlvdXMtdm9pY2UucG5nJ1xufSwge1xuICBrZXk6ICdraXNtZXQnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdhdmF0YXJzL2tpc21ldC5wbmcnXG59LCB7XG4gIGtleTogJ2dsZWFtaW5nLXNob2FsJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYXZhdGFycy9nbGVhbWluZy1zaG9hbC5wbmcnXG59LCB7XG4gIGtleTogJ2dsZWFtaW5nLXNob2FsLXBvcnRyYWl0JyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYXZhdGFycy9nbGVhbWluZy1zaG9hbC1wb3J0cmFpdC5wbmcnXG59LCB7XG4gIGtleTogJ3Vua25vd24tYWxpZW4nLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdhdmF0YXJzL2dsZWFtaW5nLXNob2FsLXNpbGhvdWV0dGUucG5nJ1xufSwge1xuICBrZXk6ICd2ZXNwZXInLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdhdmF0YXJzL3Zlc3Blci5wbmcnXG59LCB7XG4gIGtleTogJ3RhbHZpbmUnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdhdmF0YXJzL3RhbHZpbmUucG5nJ1xufSwge1xuICBrZXk6ICd2YWxrZW4nLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdhdmF0YXJzL3ZhbGtlbi5wbmcnXG59LCB7XG4gIGtleTogJ2ludmlzaWJsZScsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ2F2YXRhcnMvaW52aXNpYmxlLnBuZydcbn1dO1xuXG4vLyAtLSBTb3VuZCBlZmZlY3RzIGFuZCBiYWNrZ3JvdW5kIG11c2ljXG5leHBvcnRzLnNvdW5kcyA9IFt7XG4gIGtleTogJ3N1bnJpc2UtZnJvbS1vcmJpdCcsXG4gIHR5cGU6ICdhdWRpbycsXG4gIHVybHM6IFsnbXVzaWMvU3VucmlzZSBGcm9tIE9yYml0IChEZW1vKS5tcDMnXVxufSwge1xuICBrZXk6ICdtZW51LXRoZW1lLXRlcnJhZm9ybScsXG4gIHR5cGU6ICdhdWRpbycsXG4gIHVybHM6IFsnbXVzaWMvVGVycmFmb3JtaW5nLUJlZ2luc19Mb29waW5nLm1wMyddXG59LCB7XG4gIGtleTogJ29mZi1saW1pdHMnLFxuICB0eXBlOiAnYXVkaW8nLFxuICB1cmxzOiBbJ211c2ljL1NlY3Rvci1PZmYtTGltaXRzX0xvb3BpbmcubXAzJ11cbn0sIHtcbiAga2V5OiAncHV6emxlMScsXG4gIHR5cGU6ICdhdWRpbycsXG4gIHVybHM6IFsnbXVzaWMvUHV6emxlLUdhbWVfTG9vcGluZy5tcDMnXVxufSwge1xuICBrZXk6ICdwdXp6bGUyJyxcbiAgdHlwZTogJ2F1ZGlvJyxcbiAgdXJsczogWydtdXNpYy9QdXp6bGUtR2FtZS0yX0xvb3BpbmcubXAzJ11cbn0sIHtcbiAga2V5OiAnbG9zdGp1bmdsZScsXG4gIHR5cGU6ICdhdWRpbycsXG4gIHVybHM6IFsnbXVzaWMvTG9zdC1KdW5nbGVfTG9vcGluZy5tcDMnXVxufSwge1xuICBrZXk6ICdjb2xkLW1vb24nLFxuICB0eXBlOiAnYXVkaW8nLFxuICB1cmxzOiBbJ211c2ljL0NvbGQtTW9vbi5tcDMnXVxufSwge1xuICBrZXk6ICdjb3JyZWN0LWNhcmQnLFxuICB0eXBlOiAnYXVkaW8nLFxuICB1cmxzOiBbJ3NvdW5kZngvcG9zaXRpdmUvZ2xvd19tZWRfTF90b19SXzAwMi53YXYnXVxufSwge1xuICBrZXk6ICd3cm9uZy1jYXJkJyxcbiAgdHlwZTogJ2F1ZGlvJyxcbiAgdXJsczogWydzb3VuZGZ4L25lZ2F0aXZlL1NXMDExX0FsYXJtc19jb25zdHJ1Y3Rpb24ta2l0LWVsZW1lbnRfMDgxLndhdiddXG59LCB7XG4gIGtleTogJ3NhdmUtbm90aWZpY2F0aW9uJyxcbiAgdHlwZTogJ2F1ZGlvJyxcbiAgdXJsczogWydzb3VuZGZ4L1NGWC1BUkNBRElBX05vdGlmaWNhdGlvbjAxLndhdiddXG59LCB7XG4gIGtleTogJ3N3aXNoLWNsb3NlJyxcbiAgdHlwZTogJ2F1ZGlvJyxcbiAgdXJsczogWydzb3VuZGZ4LzEzdGgtd2hvb3NoLXN3aW5nLXNvdW5kLm1wMyddXG59LCB7XG4gIGtleTogJ3N3aXNoLW9wZW4nLFxuICB0eXBlOiAnYXVkaW8nLFxuICB1cmxzOiBbJ3NvdW5kZngvc3dvb3NoLW1ldGFsLXJvZC1zd2luZy1zb3VuZC1tYWRlLXdpdGgtYmFtYm9vLXN0aWNrLm1wMyddXG59LCB7XG4gIGtleTogJ2ludmVudG9yeS1hZGQnLFxuICB0eXBlOiAnYXVkaW8nLFxuICB1cmxzOiBbJ3NvdW5kZngvU0ZYLUFSQ0FESUFfRXJyb3IwMy53YXYnXVxufSwge1xuICBrZXk6ICdtYXJibGUtaW1wYWN0JyxcbiAgdHlwZTogJ2F1ZGlvJyxcbiAgdXJsczogWydzb3VuZGZ4L1J1cHR1cmUgLSBNYXJibGVfSW1wYWN0c18wNi53YXYnXVxufSwge1xuICBrZXk6ICdzdWNjZXNzJyxcbiAgdHlwZTogJ2F1ZGlvJyxcbiAgdXJsczogWydzb3VuZGZ4L3Bvc2l0aXZlL3N1Y2Nlc3MtMS53YXYnXVxufSwge1xuICBrZXk6ICd0YXAnLFxuICB0eXBlOiAnYXVkaW8nLFxuICB1cmxzOiBbJ3NvdW5kZngvZ2xhc3MtdGFwLndhdiddXG59XTtcblxuLy8gLS1sb2dpYyBiYXR0bGUgcGxhY2Vob2xkZXIgaW1hZ2VzXG5cbmV4cG9ydHMubG9naWNfYmF0dGxlID0gW3tcbiAga2V5OiAnYWxpZW4tc3RhcmUnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdiYXR0bGUvYWxpZW4tc3RhcmUucG5nJ1xufSwge1xuICBrZXk6ICdncmVlay1zcGhpbngnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdiYXR0bGUvZ3JlZWstc3BoaW54LnBuZydcbn0sIHtcbiAga2V5OiAnY3lib3JnLWZhY2UnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdiYXR0bGUvY3lib3JnLWZhY2UucG5nJ1xufSwge1xuICBrZXk6ICdjdXJseS1tYXNrJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmF0dGxlL2N1cmx5LW1hc2sucG5nJ1xufSwge1xuICBrZXk6ICdsdW5hci1tb2R1bGUnLFxuICB0eXBlOiAnaW1hZ2UnLFxuICB1cmw6ICdiYXR0bGUvbHVuYXItbW9kdWxlLnBuZydcbn0sIHtcbiAga2V5OiAnZmVuY2VyJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmF0dGxlL2ZlbmNlci5wbmcnXG59LCB7XG4gIGtleTogJ25ldy1ib3JuJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmF0dGxlL25ldy1ib3JuLnBuZydcbn0sIHtcbiAga2V5OiAnc2FpbnQtYmFzaWwtY2F0aGVkcmFsJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmF0dGxlL3NhaW50LWJhc2lsLWNhdGhlZHJhbC5wbmcnXG59LCB7XG4gIGtleTogJ2dvYmxpbi1oZWFkJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmF0dGxlL2dvYmxpbi1oZWFkLnBuZydcbn0sIHtcbiAga2V5OiAneGVub2JpbycsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ2JhdHRsZS94ZW5vYmlvLnBuZydcbn0sIHtcbiAga2V5OiAneGVub3BzeWNoJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmF0dGxlL3hlbm9wc3ljaC5wbmcnXG59LCB7XG4gIGtleTogJ3F1YXNhcmlhLWxvZ28tZmlsbCcsXG4gIHR5cGU6ICdpbWFnZSdcbn0sIHtcbiAga2V5OiAnYmF0dGxlMDEnLFxuICB0eXBlOiAnanNvbicsXG4gIHVybDogJ2JhdHRsZS9iYXR0bGUwMS5qc29uJ1xufSwge1xuICBrZXk6ICdxdWVzdGlvbi1tYXJrJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAndWkvcXVlc3Rpb24tbWFyay1idXR0b24ucG5nJ1xufSwge1xuICBrZXk6ICdzcG9uc29yJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmF0dGxlL3Nwb25zb3IucG5nJ1xufSwge1xuICBrZXk6ICdjdXJyZW5jeScsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ2JhdHRsZS9jdXJyZW5jeS5wbmcnXG59LCB7XG4gIGtleTogJ2VtcCcsXG4gIHR5cGU6ICdpbWFnZScsXG4gIHVybDogJ2JhdHRsZS9lbXAucG5nJ1xufSwge1xuICBrZXk6ICdjYWxsLWJsdWZmJyxcbiAgdHlwZTogJ2ltYWdlJyxcbiAgdXJsOiAnYmF0dGxlL2NhbGwtYmx1ZmYucG5nJ1xufV07XG4iLCIvKlxuICogQXJlYVRyYW5zaXRpb25cbiAqID09PT09PT09PT09PT09PVxuICpcbiAqIFVJIHdpbmRvdyBmb3IgYXJlYSB0cmFuc2l0aW9uXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXJlYXMgPSByZXF1aXJlKCcuLi8uLi9zdGF0aWMvYXNzZXRzL2FyZWFzLmpzb24nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBBcmVhVHJhbnNpdGlvbldpbmRvdztcblxuZnVuY3Rpb24gYXJlYVRyYW5zaXRpb25CdXR0b25Ub2dnbGUoKSB7XG4gIC8vIHVucmVzcG9uc2l2ZSB3aGlsZSBhbmltYXRpbmdcbiAgaWYgKHRoaXMuX2lzVHdlZW5pbmcpXG4gICAgcmV0dXJuO1xuXG4gIHRoaXMuX2lzVHdlZW5pbmcgPSB0cnVlO1xuICB2YXIgdGltZVRvVHdlZW4gPSA1MDA7ICAvLyBtaWxsaXNlY29uZHNcblxuICAvLyBoaWRlIHBhbmVsXG4gIGlmICh0aGlzLnBhbmVsLnZpc2libGUpIHtcbiAgICB0aGlzLl9nYW1lLnNvdW5kLnBsYXkoJ3N3aXNoLWNsb3NlJyk7XG4gICAgdGhpcy5fZ2FtZS5hZGQudHdlZW4odGhpcy5wYW5lbCkudG8oXG4gICAgICAgIHt4OiAwIC0gdGhpcy5wYW5lbFdpZHRoIC0gdGhpcy5fbWVtb3J5UGFkZGluZ30sIHRpbWVUb1R3ZWVuLCBQaGFzZXIuRWFzaW5nLkV4cG9uZW50aWFsLk91dCwgdHJ1ZVxuICAgICAgKS5vbkNvbXBsZXRlLmFkZChcbiAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRoaXMucGFuZWwudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuX2lzVHdlZW5pbmcgPSBmYWxzZTtcbiAgICAgICAgfSwgdGhpc1xuICAgICAgKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBzaG93IHBhbmVsXG5cbiAgLy8gaWYgbWVtb3J5IGJhbmsgd2luZG93IGlzIG9wZW4sIGNsb3NlIGl0XG4gIGlmICh0aGlzLl9nYW1lLm1lbW9yeUJhbmtXaW5kb3cucGFuZWwudmlzaWJsZSkge1xuICAgIHRoaXMuX2dhbWUubWVtb3J5QmFua1dpbmRvdy5wYW5lbC52aXNpYmxlID0gZmFsc2U7XG4gIH1cblxuICB0aGlzLnBhbmVsLnZpc2libGUgPSB0cnVlO1xuICB0aGlzLmRpc3BsYXkoKTtcbiAgLy9lYWNoIHRpbWUgeW91IHByZXNzIHRoZSBidXR0b24gaXQgc2hvdWxkIHJlZnJlc2ggdGhlIGFyZWFzIHRoYXQgaXQgZGlzcGxheXNcblxuICB0aGlzLnBhbmVsLnggPSAwIC0gdGhpcy5wYW5lbFdpZHRoIC0gdGhpcy5fbWVtb3J5UGFkZGluZztcbiAgdGhpcy5fZ2FtZS5zb3VuZC5wbGF5KCdzd2lzaC1vcGVuJyk7XG4gIHRoaXMuX2dhbWUuYWRkLnR3ZWVuKHRoaXMucGFuZWwpLnRvKFxuICAgICAge3g6IHRoaXMuX2Jhc2VYfSwgdGltZVRvVHdlZW4sIFBoYXNlci5FYXNpbmcuRXhwb25lbnRpYWwuT3V0LCB0cnVlXG4gICAgKS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7IHRoaXMuX2lzVHdlZW5pbmcgPSBmYWxzZTsgfSwgdGhpcyk7XG59XG5cbmZ1bmN0aW9uIEFyZWFUcmFuc2l0aW9uV2luZG93KGdhbWUvKiwgLi4uYXJncyovKSB7XG4gIFBoYXNlci5Hcm91cC5jYWxsKHRoaXMsIGdhbWUvKiwgLi4uYXJncyovKTtcblxuICB0aGlzLl9nYW1lID0gZ2FtZTtcblxuICAvLyBwcml2YXRlIG1lbWJlcnMgc3BlY2lmeWluZyBtYXJnaW4gYW5kIHBhZGRpbmdcbiAgdGhpcy5fbWVtb3J5VGV4dE9yaWdpblggPSAxMDA7XG4gIHRoaXMuX21lbW9yeVRleHRPcmlnaW5ZID0gMTU1O1xuICB0aGlzLl9tZW1vcnlQYWRkaW5nID0gMzI7XG4gIHRoaXMuX2l0ZW1PcmlnaW5YID0gODA7XG4gIHRoaXMuX2l0ZW1PcmlnaW5ZID0gMjU7XG4gIHRoaXMuX2Jhc2VYID0gdGhpcy5fbWVtb3J5UGFkZGluZyAvIDI7XG4gIHRoaXMuX2Jhc2VZID0gdGhpcy5fbWVtb3J5UGFkZGluZyAqIDI7XG5cbiAgLy8gbWVtb3J5IGJhbmsgd2luZG93IGRpbWVuc2lvbnNcbiAgdGhpcy5wYW5lbEhlaWdodCA9IGdhbWUuaGVpZ2h0ICogMS8yIC0gdGhpcy5fbWVtb3J5UGFkZGluZyAvIDI7XG4gIHRoaXMucGFuZWxXaWR0aCA9IGdhbWUud2lkdGggLSB0aGlzLl9tZW1vcnlQYWRkaW5nO1xuICB0aGlzLl9yb3dDYXBhY2l0eSA9IDU7ICAvLyBpdGVtcyBwZXIgcm93XG4gIHRoaXMuX2l0ZW1TdGFydCA9IDA7ICAvLyBkZXRlcm1pbmVzIHdoaWNoIHJvdyB0byBzaG93XG5cbiAgLy8gd2luZG93LWRlcGVuZGVudCBwcml2YXRlIG1lbWJlciBkaW1lbnNpb25zXG4gIHRoaXMuX21lbW9yeVRleHRXaWR0aCA9IHRoaXMucGFuZWxXaWR0aCAtIDE4NTtcbiAgdGhpcy5faXRlbVBhZGRpbmcgPSB0aGlzLnBhbmVsV2lkdGggLyA1MDtcbiAgdGhpcy5fbmV4dE9yaWdpblggPSB0aGlzLnBhbmVsV2lkdGggLSA1NTtcbiAgdGhpcy5fbmV4dE9yaWdpblkgPSAwO1xuICB0aGlzLl9wcmV2T3JpZ2luWCA9IC0xODtcbiAgdGhpcy5fcHJldk9yaWdpblkgPSAwO1xuXG4gIC8qKlxuICAgKiBQYW5lbFxuICAgKi9cblxuICBnYW1lLnNsaWNrVUkuYWRkKFxuICAgIHRoaXMucGFuZWwgPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoXG4gICAgICB0aGlzLl9iYXNlWCwgdGhpcy5fYmFzZVksIGdhbWUubWFrZS5zcHJpdGUoMCwwLCAnbWVtb3J5LWJhbmsnKSxcbiAgICAgIHRoaXMucGFuZWxXaWR0aCwgdGhpcy5wYW5lbEhlaWdodCkpO1xuICB0aGlzLnBhbmVsLmRpc3BsYXlPYmplY3Qud2lkdGggPSB0aGlzLnBhbmVsV2lkdGg7XG4gIHRoaXMucGFuZWwuZGlzcGxheU9iamVjdC5oZWlnaHQgPSB0aGlzLnBhbmVsSGVpZ2h0O1xuXG4gIC8vIGJ5IGRlZmF1bHQsIG5vdCBkaXNwbGF5ZWRcbiAgdGhpcy5wYW5lbC52aXNpYmxlID0gZmFsc2U7XG4gIHRoaXMucGFuZWwuYWxwaGEgPSAwLjg7XG5cbiAgLyoqXG4gICAqIFRvZ2dsZSBidXR0b25cbiAgICovXG4gIC8vIHVudGlsIHlvdSBjbGljayBvbiB0aGUgdG9nZ2xlIGJ1dHRvblxuICBnYW1lLnNsaWNrVUkuYWRkKFxuICAgIHRoaXMudG9nZ2xlQnV0dG9uID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KFxuICAgICAgdGhpcy5fbWVtb3J5UGFkZGluZyx0aGlzLl9tZW1vcnlQYWRkaW5nLCBnYW1lLm1ha2UuYnV0dG9uKDAsMCwgJ2J1dHRvbicpKSk7XG4gIC8vIHNldCBzY2FsZSBzdWNoIHRoYXQgd2lkdGggPSAxLzggcGFuZWwgd2lkdGhcbiAgdGhpcy50b2dnbGVCdXR0b24uZGlzcGxheU9iamVjdC5zY2FsZS5zZXRUbyhcbiAgICAodGhpcy5wYW5lbFdpZHRoIC8gOCkgLyB0aGlzLnRvZ2dsZUJ1dHRvbi5kaXNwbGF5T2JqZWN0LndpZHRoKTtcbiAgLy90aGlzLnRvZ2dsZUJ1dHRvbi54ID0gZ2FtZS53aWR0aCAtIHRoaXMuX21lbW9yeVBhZGRpbmcgLSB0aGlzLnRvZ2dsZUJ1dHRvbi5kaXNwbGF5T2JqZWN0LndpZHRoO1xuICAvLyBzaG93IHBhbmVsIGNhbGxiYWNrXG4gIHRoaXMudG9nZ2xlQnV0dG9uLmV2ZW50cy5vbklucHV0RG93bi5hZGQoYXJlYVRyYW5zaXRpb25CdXR0b25Ub2dnbGUsIHRoaXMpO1xuICB0aGlzLnRvZ2dsZUJ1dHRvbi5hbHBoYSA9IDAuOTtcblxuICB2YXIgdG9nZ2xlU3R5bGUgPSB7IGZvbnQ6ICcxNHB4IEdvdWR5IEJvb2tsZXR0ZXIgMTkxMScsIGZpbGw6ICcjNDhmMmZmJywgYm91bmRzQWxpZ25IOiAnY2VudGVyJywgYm91bmRzQWxpZ25WOiAnbWlkZGxlJ307XG4gIHRoaXMudG9nZ2xlQnV0dG9uLmFkZChcbiAgICB0aGlzLnRvZ2dsZVRleHQgPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoMCwgMCwgZ2FtZS5tYWtlLnRleHQoMCwgMCwgJ0FSRUFTJywgdG9nZ2xlU3R5bGUpKSk7XG4gIHRoaXMudG9nZ2xlVGV4dC5kaXNwbGF5T2JqZWN0LnNldFRleHRCb3VuZHMoMCwgdGhpcy50b2FzdFRleHRZLCB0aGlzLnRvZ2dsZUJ1dHRvbi5kaXNwbGF5T2JqZWN0LndpZHRoLCB0aGlzLnRvZ2dsZUJ1dHRvbi5kaXNwbGF5T2JqZWN0LmhlaWdodCk7XG5cbiAgLyoqXG4gICAqIFRleHQgLSBuYW1lIGFuZCBkZXNjcmlwdGlvblxuICAgKi9cbiAgdmFyIG5hbWVUZXh0U3R5bGUgPSB7IGZvbnQ6ICcxNHB4IEdvdWR5IEJvb2tsZXR0ZXIgMTkxMScsIGZpbGw6ICcjNDhmMmZmJywgd29yZFdyYXA6IHRydWUsIHdvcmRXcmFwV2lkdGg6IHRoaXMuX21lbW9yeVRleHRXaWR0aCwgZm9udFdlaWdodDogJ2JvbGQnLCBib3VuZHNBbGlnbkg6ICdjZW50ZXInIH07XG4gIHRoaXMucGFuZWwuYWRkKFxuICAgIHRoaXMubmFtZVRleHQgPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoXG4gICAgICB0aGlzLl9tZW1vcnlUZXh0T3JpZ2luWCxcbiAgICAgIHRoaXMuX21lbW9yeVRleHRPcmlnaW5ZLFxuICAgICAgZ2FtZS5tYWtlLnRleHQoMCwwLCAnJywgbmFtZVRleHRTdHlsZSksIHRoaXMuX21lbW9yeVRleHRXaWR0aCkpO1xuICAvLyBmb3IgYWxpZ25tZW50IHB1cnBvc2VzXG4gIHZhciBuYW1lVGV4dEhlaWdodCA9IHRoaXMubmFtZVRleHQuZGlzcGxheU9iamVjdC5nZXRCb3VuZHMoKS5oZWlnaHQ7XG4gIHRoaXMubmFtZVRleHQuZGlzcGxheU9iamVjdC5zZXRUZXh0Qm91bmRzKDAsMCwgdGhpcy5fbWVtb3J5VGV4dFdpZHRoLCBuYW1lVGV4dEhlaWdodCk7XG5cbiAgdmFyIGRlc2NUZXh0U3R5bGUgPSB7IGZvbnQ6ICcxNHB4IE9wZW4gU2FucycsIGZpbGw6ICcjNDhmMmZmJywgd29yZFdyYXA6IHRydWUsIHdvcmRXcmFwV2lkdGg6IHRoaXMuX21lbW9yeVRleHRXaWR0aCwgYWxpZ246ICdsZWZ0JyB9O1xuICB0aGlzLnBhbmVsLmFkZChcbiAgICB0aGlzLmRlc2NUZXh0ID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KFxuICAgICAgdGhpcy5fbWVtb3J5VGV4dE9yaWdpblgsXG4gICAgICB0aGlzLl9tZW1vcnlUZXh0T3JpZ2luWSArIG5hbWVUZXh0SGVpZ2h0LFxuICAgICAgZ2FtZS5tYWtlLnRleHQoMCwwLCAnJywgZGVzY1RleHRTdHlsZSksIHRoaXMuX21lbW9yeVRleHRXaWR0aCkpO1xuXG4gIC8qKlxuICAgKiBCb29ra2VlcGluZ1xuICAgKi9cbiAgLy8gYXJlIHdlIGN1cnJlbnRseSBhbmltYXRpbmc/XG4gIHRoaXMuX2lzVHdlZW5pbmcgPSBmYWxzZTtcbiAgdGhpcy5faXRlbURpc3BsYXlPYmplY3RzID0gW107IC8vIGZvciBkZWxldGlvbiBwdXJwb3Nlc1xuICB0aGlzLl9uYXZCdXR0b25zID0gW107XG4gIHRoaXMuYXJlYXNUb1Nob3cgPSBPYmplY3Qua2V5cyhhcmVhcykuZmlsdGVyKGZ1bmN0aW9uKGFyZWEpIHtcbiAgICByZXR1cm4gYXJlYXNbYXJlYV1bJ25hdmlnYWJsZSddID09IHRydWU7XG4gIH0pO1xufVxuXG5BcmVhVHJhbnNpdGlvbldpbmRvdy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5Hcm91cC5wcm90b3R5cGUpO1xuQXJlYVRyYW5zaXRpb25XaW5kb3cucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQXJlYVRyYW5zaXRpb25XaW5kb3c7XG5cbi8vIFV0aWxpdHkgZnVuY3Rpb25zOiBpbnN0YW50bHkgaGlkZSBvciBzaG93IHBhbmVsL1VJXG5BcmVhVHJhbnNpdGlvbldpbmRvdy5wcm90b3R5cGUuaGlkZVBhbmVsID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnBhbmVsLnZpc2libGUgPSBmYWxzZTtcbiAgdGhpcy5wYW5lbC54ID0gMCAtIHRoaXMucGFuZWxXaWR0aCAtIHRoaXMuX21lbW9yeVBhZGRpbmc7XG59O1xuXG5BcmVhVHJhbnNpdGlvbldpbmRvdy5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5oaWRlUGFuZWwoKTtcbiAgdGhpcy50b2dnbGVCdXR0b24udmlzaWJsZSA9IGZhbHNlO1xuICB0aGlzLnRvZ2dsZUJ1dHRvbi5pbnB1dEVuYWJsZWQgPSBmYWxzZTtcbn07XG5cbkFyZWFUcmFuc2l0aW9uV2luZG93LnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuaGlkZVBhbmVsKCk7XG4gIHRoaXMudG9nZ2xlQnV0dG9uLnZpc2libGUgPSB0cnVlO1xuICB0aGlzLnRvZ2dsZUJ1dHRvbi5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAvL25vdCBzdXJlIHRoYXQgdGhpcyB3aWxsIHJlLWFkZCBsaXN0ZW5lcnNcbn07XG5cbkFyZWFUcmFuc2l0aW9uV2luZG93LnByb3RvdHlwZS5kaXNwbGF5ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmNsZWFuV2luZG93KCk7XG4gIHRoaXMuZGlzcGxheUFyZWFzKCk7XG4gIHRoaXMuc2hvd05hdkJ1dHRvbnMoKTtcbn07XG5cbkFyZWFUcmFuc2l0aW9uV2luZG93LnByb3RvdHlwZS5jbGVhbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9pdGVtRGlzcGxheU9iamVjdHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgaXRlbSA9IHRoaXMuX2l0ZW1EaXNwbGF5T2JqZWN0c1tpXTtcbiAgICBpdGVtLmNvbnRhaW5lci5kaXNwbGF5R3JvdXAucmVtb3ZlQWxsKHRydWUpO1xuICAgIGl0ZW0uY29udGFpbmVyLmRpc3BsYXlHcm91cC5kZXN0cm95KCk7XG4gIH1cbiAgZm9yIChpID0gMDsgaSA8IHRoaXMuX25hdkJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbmF2QnV0dG9uID0gdGhpcy5fbmF2QnV0dG9uc1tpXTtcbiAgICBuYXZCdXR0b24uY29udGFpbmVyLmRpc3BsYXlHcm91cC5yZW1vdmVBbGwodHJ1ZSk7XG4gICAgbmF2QnV0dG9uLmNvbnRhaW5lci5kaXNwbGF5R3JvdXAuZGVzdHJveSgpO1xuICB9XG4gIHRoaXMuX2l0ZW1EaXNwbGF5T2JqZWN0cyA9IFtdO1xuICB0aGlzLl9uYXZCdXR0b25zID0gW107XG59O1xuXG5BcmVhVHJhbnNpdGlvbldpbmRvdy5wcm90b3R5cGUuZGlzcGxheUFyZWFzID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmFyZWFzVG9TaG93ID0gT2JqZWN0LmtleXMoYXJlYXMpLmZpbHRlcihmdW5jdGlvbihhcmVhKSB7XG4gICAgbGV0IHNlZW4gPSB0aGlzLl9nYW1lLnBsYXllci5zZWVuQXJlYXMuaW5jbHVkZXMoYXJlYSk7XG4gICAgLy90aGlzIGZpbHRlciB3aWxsIGFkZCByb29tcyBzZWVuIGluIHRoZSBwYXN0IHRoYXQgc2hvdWxkIGJlIGF2YWxpYWJsZSBpbiB0aGUgd2luZG93XG4gICAgcmV0dXJuIGFyZWFzW2FyZWFdWyduYXZpZ2FibGUnXSA9PSB0cnVlICYmIHRoaXMuX2dhbWUucm9vbS5uYW1lICE9IGFyZWEgJiYgc2VlbjtcbiAgfSwgdGhpcyk7XG4gIC8vdGhpcyBpcyBnb2luZyB0byBsZWF2ZSB0aGluZ3Mgb3V0LCBvciBoYXZlIGN5Y2xlc1xuICAvLyB3ZSB3aWxsIGhhdmUgdG8gdGhpbmsgY2FyZWZ1bGx5IHdoZW4gYWRkaW5nIHRoaXMgaW5mb3JtYXRpb24gdG8gdGhlIGpzb25cbiAgLy8gZG8gd2Ugd2FudCBhIGdpdmVuIHJvb20gdG8gb25seSBhcHBlYXIgaWYgc2VlbiBvciBkbyB3ZSB3YW50IHRvIGhhdmUgYSBncm91cCBvZlxuICAvLyByb29tcyBhbGwgbmF2aWdhYmxlIGZyb20gb25lIGFub3RoZXI/XG4gIC8vIGllIGhhbmdlciBtdXN0IGJlIHJlYWNoZWQgZmlyc3QsIGJ1dCBvbmNlIHRoZXJlIHlvdSBoYXZlIGltbWVkaWF0ZSBhY2Nlc3MgdG8gdGFsdmluZVxuICBmb3IgKGxldCBhcmVhIG9mIHRoaXMuX2dhbWUucm9vbS5hcmVhLmFyZWFBY2Nlc3Mpe1xuICAgIGlmICghdGhpcy5hcmVhc1RvU2hvdy5pbmNsdWRlcyhhcmVhKSl7XG4gICAgICB0aGlzLmFyZWFzVG9TaG93LnB1c2goYXJlYSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGl0ZW1FbmQgPSB0aGlzLl9pdGVtU3RhcnQgKyB0aGlzLl9yb3dDYXBhY2l0eSA8IHRoaXMuYXJlYXNUb1Nob3cubGVuZ3RoXG4gICAgPyB0aGlzLl9pdGVtU3RhcnQgKyB0aGlzLl9yb3dDYXBhY2l0eVxuICAgIDogdGhpcy5hcmVhc1RvU2hvdy5sZW5ndGg7XG5cbiAgZm9yICh2YXIgaSA9IHRoaXMuX2l0ZW1TdGFydDsgaSA8IGl0ZW1FbmQ7IGkrKykge1xuICAgIHZhciBpdGVtSWQgPSB0aGlzLmFyZWFzVG9TaG93W2ldO1xuXG4gICAgLy8gc2NhbGVkIHdpZHRoID0gMS83IHBhbmVsIHdpZHRoO1xuICAgIHZhciBkZXNpcmVkV2lkdGggPSAodGhpcy5wYW5lbFdpZHRoIC8gNyk7XG4gICAgdmFyIGFzc2V0U3ByaXRlID0gdGhpcy5fZ2FtZS5tYWtlLnNwcml0ZSgwLDAsIGl0ZW1JZCk7XG4gICAgYXNzZXRTcHJpdGUuc2NhbGUuc2V0VG8oZGVzaXJlZFdpZHRoIC8gYXNzZXRTcHJpdGUud2lkdGgpO1xuXG4gICAgdmFyIG1hc2tTcHJpdGUgPSB0aGlzLl9nYW1lLm1ha2Uuc3ByaXRlKDAsMCwgJ21lbW9yeS1iYW5rLWljb24tbWFzaycpO1xuICAgIG1hc2tTcHJpdGUuc2NhbGUuc2V0VG8oZGVzaXJlZFdpZHRoIC8gbWFza1Nwcml0ZS53aWR0aCk7XG5cbiAgICB2YXIgbWFza2VkQm1kID0gdGhpcy5fZ2FtZS5tYWtlLmJpdG1hcERhdGEobWFza1Nwcml0ZS53aWR0aCwgbWFza1Nwcml0ZS5oZWlnaHQpO1xuICAgIG1hc2tlZEJtZC5hbHBoYU1hc2soYXNzZXRTcHJpdGUsIG1hc2tTcHJpdGUpO1xuXG4gICAgdmFyIGl0ZW1TcHJpdGUgPSB0aGlzLl9nYW1lLm1ha2Uuc3ByaXRlKDAsMCwgbWFza2VkQm1kKTtcbiAgICB2YXIgc2xpY2tJdGVtO1xuICAgIHRoaXMucGFuZWwuYWRkKHNsaWNrSXRlbSA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICAgIHRoaXMuX2l0ZW1PcmlnaW5YICsgKGkgLSB0aGlzLl9pdGVtU3RhcnQpKih0aGlzLl9pdGVtUGFkZGluZyArIGl0ZW1TcHJpdGUud2lkdGgpLCB0aGlzLl9pdGVtT3JpZ2luWSxcbiAgICAgIGl0ZW1TcHJpdGUpKTtcblxuICAgIHZhciBib3JkZXJTcHJpdGUgPSB0aGlzLl9nYW1lLm1ha2Uuc3ByaXRlKDAsMCwgJ21lbW9yeS1iYW5rLWljb24nKTtcbiAgICBib3JkZXJTcHJpdGUuc2NhbGUuc2V0VG8oZGVzaXJlZFdpZHRoIC8gYm9yZGVyU3ByaXRlLndpZHRoKTtcbiAgICB2YXIgc2xpY2tCb3JkZXI7XG4gICAgdGhpcy5wYW5lbC5hZGQoc2xpY2tCb3JkZXIgPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoXG4gICAgICB0aGlzLl9pdGVtT3JpZ2luWCArIChpIC0gdGhpcy5faXRlbVN0YXJ0KSoodGhpcy5faXRlbVBhZGRpbmcgKyBpdGVtU3ByaXRlLndpZHRoKSwgdGhpcy5faXRlbU9yaWdpblksXG4gICAgICBib3JkZXJTcHJpdGUpKTtcblxuICAgIGl0ZW1TcHJpdGUuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICBpdGVtU3ByaXRlLmlucHV0LnVzZUhhbmRDdXJzb3IgPSB0cnVlO1xuICAgIGl0ZW1TcHJpdGUuZXZlbnRzLm9uSW5wdXRPdmVyLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm5hbWVUZXh0LmRpc3BsYXlPYmplY3QudGV4dCA9IGFyZWFzW3RoaXMuaXRlbUlkXVsnbmFtZSddLnRvVXBwZXJDYXNlKCk7XG4gICAgfSwge25hbWVUZXh0OiB0aGlzLm5hbWVUZXh0LCBpdGVtSWQ6IGl0ZW1JZH0pO1xuICAgIGl0ZW1TcHJpdGUuZXZlbnRzLm9uSW5wdXRVcC5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmdhbWUucm9vbS5sb2FkQXJlYSh0aGlzLml0ZW1JZCk7XG4gICAgfSwge2dhbWU6IHRoaXMuX2dhbWUsIGl0ZW1JZDogaXRlbUlkfSk7XG4gICAgaXRlbVNwcml0ZS5ldmVudHMub25JbnB1dFVwLmFkZChhcmVhVHJhbnNpdGlvbkJ1dHRvblRvZ2dsZSwgdGhpcyk7XG5cbiAgICB0aGlzLl9pdGVtRGlzcGxheU9iamVjdHMucHVzaChzbGlja0l0ZW0pO1xuICAgIHRoaXMuX2l0ZW1EaXNwbGF5T2JqZWN0cy5wdXNoKHNsaWNrQm9yZGVyKTtcbiAgfVxufTtcblxuQXJlYVRyYW5zaXRpb25XaW5kb3cucHJvdG90eXBlLnNob3dOYXZCdXR0b25zID0gZnVuY3Rpb24gKCkge1xuXG4gIC8vIG5leHQgYnV0dG9uc1xuICBpZiAodGhpcy5faXRlbVN0YXJ0ICsgdGhpcy5fcm93Q2FwYWNpdHkgPCB0aGlzLmFyZWFzVG9TaG93Lmxlbmd0aCkge1xuICAgIHZhciBuZXh0QnV0dG9uID0gdGhpcy5fZ2FtZS5tYWtlLmJ1dHRvbigwLDAsJ21lbW9yeS1iYW5rLW5leHQnKTtcbiAgICB2YXIgc2xpY2tOZXh0O1xuICAgIHRoaXMucGFuZWwuYWRkKHNsaWNrTmV4dCA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICAgIHRoaXMuX25leHRPcmlnaW5YLCB0aGlzLl9uZXh0T3JpZ2luWSwgbmV4dEJ1dHRvbikpO1xuICAgIC8vIHNjYWxlZCBieSBoZWlnaHQsIGVxdWFsIHRvIHBhbmVsIGhlaWdodFxuICAgIG5leHRCdXR0b24uc2NhbGUuc2V0VG8odGhpcy5wYW5lbEhlaWdodCAvIG5leHRCdXR0b24uaGVpZ2h0KTtcbiAgICB0aGlzLl9uYXZCdXR0b25zLnB1c2goc2xpY2tOZXh0KTtcblxuICAgIG5leHRCdXR0b24uZXZlbnRzLm9uSW5wdXRVcC5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5zd2l0Y2hSb3codHJ1ZSk7XG4gICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICB9LCB0aGlzKTtcblxuICB9XG5cbiAgLy8gcHJldiBidXR0b25zXG4gIGlmICh0aGlzLl9pdGVtU3RhcnQgPiAwKSB7XG4gICAgdmFyIHByZXZCdXR0b24gPSB0aGlzLl9nYW1lLm1ha2UuYnV0dG9uKDAsMCwnbWVtb3J5LWJhbmstbmV4dCcpO1xuICAgIC8vIHJvdGF0ZSBzcHJpdGVcbiAgICBwcmV2QnV0dG9uLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG4gICAgcHJldkJ1dHRvbi5zY2FsZS55ICo9IC0xO1xuICAgIHByZXZCdXR0b24uYW5jaG9yLnNldFRvKDEsMSk7XG5cbiAgICB2YXIgc2xpY2tQcmV2O1xuICAgIHRoaXMucGFuZWwuYWRkKHNsaWNrUHJldiA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICAgIHRoaXMuX3ByZXZPcmlnaW5YLCB0aGlzLl9wcmV2T3JpZ2luWSxcbiAgICAgIHByZXZCdXR0b24pKTtcbiAgICB0aGlzLl9uYXZCdXR0b25zLnB1c2goc2xpY2tQcmV2KTtcblxuICAgIHByZXZCdXR0b24uc2NhbGUuc2V0VG8odGhpcy5wYW5lbEhlaWdodCAvIHByZXZCdXR0b24uaGVpZ2h0KTtcblxuICAgIHByZXZCdXR0b24uZXZlbnRzLm9uSW5wdXRVcC5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5zd2l0Y2hSb3coZmFsc2UpO1xuICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgfSwgdGhpcyk7XG5cbiAgfVxufTtcblxuQXJlYVRyYW5zaXRpb25XaW5kb3cucHJvdG90eXBlLnN3aXRjaFJvdyA9IGZ1bmN0aW9uICh3YW50c05leHRSb3cpIHtcbiAgaWYgKHdhbnRzTmV4dFJvdyAmJiB0aGlzLl9pdGVtU3RhcnQgKyB0aGlzLl9yb3dDYXBhY2l0eSA8IHRoaXMuYXJlYXNUb1Nob3cubGVuZ3RoKSB7XG4gICAgdGhpcy5faXRlbVN0YXJ0ICs9IHRoaXMuX3Jvd0NhcGFjaXR5O1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoIXdhbnRzTmV4dFJvdyAmJiB0aGlzLl9pdGVtU3RhcnQgLSB0aGlzLl9yb3dDYXBhY2l0eSA+PSAwKSB7XG4gICAgdGhpcy5faXRlbVN0YXJ0IC09IHRoaXMuX3Jvd0NhcGFjaXR5O1xuICAgIHJldHVybjtcbiAgfVxufTtcblxuQXJlYVRyYW5zaXRpb25XaW5kb3cucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gVE9ETzogU3R1Yi5cbn07XG4iLCIndXNlIHN0cmljdCc7XG5cblxuZnVuY3Rpb24gQXJndW1lbnQoZ2FtZSwgeCwgeSwgYXNzZXROYW1lLCBtYXRjaCwganNvbklkeCkge1xuICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgYXNzZXROYW1lKTtcbiAgdGhpcy5hc3NldE5hbWUgPSBhc3NldE5hbWU7XG4gIHRoaXMuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgdGhpcy5pbnB1dC51c2VIYW5kQ3Vyc29yID0gdHJ1ZTtcbiAgdGhpcy5rZXkgPSBtYXRjaDtcbiAgdGhpcy5qc29uSWR4ID0ganNvbklkeDtcbiAgdGhpcy5zaG93biA9IGZhbHNlO1xufVxuXG5Bcmd1bWVudC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcbm1vZHVsZS5leHBvcnRzID0gQXJndW1lbnQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQXJndW1lbnQ7XG4iLCIvKlxuICogQXJndW1lbnRNYW5hZ2VyXG4gKiA9PT09PT09PT09PT09PT1cbiAqXG4gKiBFeHRlbnNpb24gb2YgQ29udmVyc2F0aW9uTWFuYWdlciBmb3IgTG9naWMgQmF0dGxlc1xuICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIENvbnZlcnNhdGlvbk1hbmFnZXIgPSByZXF1aXJlKCcuL0NvbnZlcnNhdGlvbk1hbmFnZXInKTtcblxubW9kdWxlLmV4cG9ydHMgPSBBcmd1bWVudE1hbmFnZXI7XG5cbmZ1bmN0aW9uIEFyZ3VtZW50TWFuYWdlcihnYW1lLCBjdXN0b21BY3Rpb25zLyosIC4uLmFyZ3MqLykge1xuICAvLyBUT0RPOlxuICAvLyAgIDEuIEVkaXQgY29uc3RydWN0b3IgcGFyYW1ldGVycyBhY2NvcmRpbmdseS5cbiAgLy8gICAyLiBBZGp1c3Qgb2JqZWN0IHByb3BlcnRpZXMuXG5cbiAgQ29udmVyc2F0aW9uTWFuYWdlci5jYWxsKHRoaXMsIGdhbWUsIGN1c3RvbUFjdGlvbnMpO1xuICB0aGlzLm5lc3RlZElkeCA9IDA7XG4gIHRoaXMuY3VycmVudFBhcmFtcyA9IFtdO1xuXG4gIC8qIFNpZ25hbHMgKi9cbiAgdGhpcy5zcGVjaWFsQ29tcGxldGVTaWduYWwgPSBuZXcgUGhhc2VyLlNpZ25hbCgpO1xuICB0aGlzLmludGVybHVkZUNvbXBsZXRlU2lnbmFsID0gbmV3IFBoYXNlci5TaWduYWwoKTtcblxuICAvKiBQUklWQVRFICovXG4gIC8vIFRPRE86IHJlbW92ZSBjb21wYW5pb25zIGZyb20gaGVyZSFcbiAgdGhpcy5zcGVjaWFsQXJndW1lbnRUeXBlcyA9IFsnYWJpbGl0eScsICdpbnRybycsICdjdXN0b20nLCBcbiAgICAnbG9zZScsICd3aW4nLCAnZ2FtZW92ZXInLCAnY3JlZGl0cyddO1xuXG59XG5Bcmd1bWVudE1hbmFnZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShDb252ZXJzYXRpb25NYW5hZ2VyLnByb3RvdHlwZSk7XG5Bcmd1bWVudE1hbmFnZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQXJndW1lbnRNYW5hZ2VyO1xuXG5Bcmd1bWVudE1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gVE9ETzogU3R1Yi5cbn07XG5cbi8qKiBCRUdJTiBPVkVSUklERSBGVU5DVElPTlMgKi9cbkFyZ3VtZW50TWFuYWdlci5wcm90b3R5cGUuZ2V0UmVzcG9uc2VzID0gZnVuY3Rpb24gKCkge1xuICBpZiAodGhpcy5jdXJyZW50UGFyYW1zLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gW3sgJ3RhcmdldCc6IHRoaXMubmVzdGVkSWR4KzEsICd0ZXh0JzogJ1tOZXh0XScsICdwYXJhbXMnOiB0aGlzLmN1cnJlbnRQYXJhbXMgfV07XG4gIH1cblxuICByZXR1cm4gW107XG59O1xuXG5Bcmd1bWVudE1hbmFnZXIucHJvdG90eXBlLmFkdmFuY2VUb1RhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZHgsIHBhcmFtcyA9IFtdKSB7XG4gIC8vIHBhc3MgYWxvbmcgY3VycmVudCBwYXJhbWV0ZXJzXG4gIHRoaXMuY3VycmVudFBhcmFtcyA9IHBhcmFtcztcbiAgaWYgKHBhcmFtcy5sZW5ndGggPiAwKSB7XG4gICAgaWYgKHRoaXMuc3BlY2lhbEFyZ3VtZW50VHlwZXMuaW5jbHVkZXMocGFyYW1zWzBdKSkge1xuICAgICAgdmFyIGN1c3RvbVR5cGUgPSBwYXJhbXNbMF07XG4gICAgICB2YXIgY3VzdG9tID0gdGhpcy5jb252ZXJzYXRpb25bY3VzdG9tVHlwZV07XG5cbiAgICAgIGlmIChwYXJhbXMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgLy8gVHJhdmVyc2UgdGhyb3VnaCBwYXJhbWV0ZXJzXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKHBhcmFtc1tpXSBpbiBjdXN0b20pXG4gICAgICAgICAgICBjdXN0b20gPSBjdXN0b21bcGFyYW1zW2ldXTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAodGFyZ2V0SWR4IGluIGN1c3RvbSkge1xuICAgICAgICB0aGlzLm5lc3RlZElkeCA9IHRhcmdldElkeDtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIC8vIGVuZCBvZiB0aGlzIGNvbnZlcnNhdGlvbiwgZ28gYmFjayB0byB3aGF0ZXZlciB3ZSB3ZXJlIGRvaW5nXG4gICAgICB0aGlzLmN1cnJlbnRQYXJhbXMgPSBbXTtcbiAgICAgIHRoaXMuc3BlY2lhbENvbXBsZXRlU2lnbmFsLmRpc3BhdGNoKCk7XG4gICAgICByZXR1cm4gZmFsc2U7IC8vIGRvIE5PVCByZWZyZXNoIGRpc3BsYXkgb24gZW5kIG9mIHNwZWNpYWwgYXJndW1lbnQ7IERpYWxvZ3VlV2luZG93IHdhaXRzIGZvciBhIGRpc3BsYXkgY2FsbFxuXG4gICAgfSBlbHNlIGlmIChwYXJhbXMubGVuZ3RoID49IDIgJiYgcGFyYW1zWzBdID09PSAnaW50ZXJsdWRlJykge1xuICAgICAgdmFyIGludGVybHVkZVR5cGUgPSBwYXJhbXNbMV07XG4gICAgICB2YXIgYXJndW1lbnQgPSB0aGlzLmNvbnZlcnNhdGlvblt0aGlzLmlkeF07XG5cbiAgICAgIGlmIChpbnRlcmx1ZGVUeXBlIGluIGFyZ3VtZW50ICYmIHRhcmdldElkeCBpbiBhcmd1bWVudFtpbnRlcmx1ZGVUeXBlXSkge1xuICAgICAgICB0aGlzLm5lc3RlZElkeCA9IHRhcmdldElkeDtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZW5kQXJnSW50ZXJsdWRlKCk7XG4gICAgICByZXR1cm4gZmFsc2U7IC8vIGRvIE5PVCByZWZyZXNoIGRpc3BsYXkgb24gZW5kIG9mIGFyZ3VtZW50IGludGVybHVkZVxuICAgIH1cbiAgfVxuXG4gIHRoaXMuaWR4ID0gdGFyZ2V0SWR4O1xuICByZXR1cm4gdHJ1ZTtcbn07XG5cbkFyZ3VtZW50TWFuYWdlci5wcm90b3R5cGUuZW5kQ29udmVyc2F0aW9uID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuY3VzdG9tQWN0aW9ucy5jdXN0b21BY3Rpb24odGhpcy5jb252ZXJzYXRpb25bJ29uRW5kJ10pOyAgXG59O1xuXG5Bcmd1bWVudE1hbmFnZXIucHJvdG90eXBlLmdldEF2YXRhciA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuICdpbnZpc2libGUnO1xufTtcblxuQXJndW1lbnRNYW5hZ2VyLnByb3RvdHlwZS5nZXRDdXJyZW50VGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuY29udmVyc2F0aW9uID09PSBudWxsKVxuICAgIHJldHVybiAnJztcblxuICB2YXIgYXJnID0gdGhpcy5nZXRBcmd1bWVudCgpO1xuICBpZiAoYXJnID09PSBudWxsKVxuICAgIHJldHVybiAnJztcblxuICByZXR1cm4gYXJnWyd0ZXh0J107XG59O1xuXG5Bcmd1bWVudE1hbmFnZXIucHJvdG90eXBlLmdldFNwZWFrZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0aGlzLmNvbnZlcnNhdGlvbiA9PT0gbnVsbCkge1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIHZhciBhcmcgPSB0aGlzLmdldEFyZ3VtZW50KCk7XG4gIGlmIChhcmcgPT09IG51bGwpXG4gICAgcmV0dXJuICcnO1xuXG4gIHJldHVybiBhcmdbJ3NwZWFrZXInXTsgXG59O1xuLyoqIEVORCBPVkVSUklERSBGVU5DVElPTlMgKi9cblxuQXJndW1lbnRNYW5hZ2VyLnByb3RvdHlwZS5nZXRBcmd1bWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuY3VycmVudFBhcmFtcy5sZW5ndGggPiAwKSB7XG4gICAgdmFyIHBhcmFtcyA9IHRoaXMuY3VycmVudFBhcmFtcztcbiAgICBpZiAodGhpcy5zcGVjaWFsQXJndW1lbnRUeXBlcy5pbmNsdWRlcyhwYXJhbXNbMF0pKSB7XG4gICAgICAvLyBzcGVjaWFsIGFyZ3VtZW50XG4gICAgICAvLyBzdXBwb3J0IGZvciBtdWx0aXBsZSBwYXJhbXNcbiAgICAgIHZhciBjdXN0b21UeXBlID0gcGFyYW1zWzBdO1xuICAgICAgdmFyIGN1c3RvbSA9IHRoaXMuY29udmVyc2F0aW9uW2N1c3RvbVR5cGVdO1xuXG4gICAgICBpZiAocGFyYW1zLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgIC8vIFRyYXZlcnNlIHRocm91Z2ggcGFyYW1ldGVyc1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBhcmFtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBwYXJhbSA9IHBhcmFtc1tpXTtcbiAgICAgICAgICBpZiAocGFyYW0gaW4gY3VzdG9tKSB7XG4gICAgICAgICAgICBjdXN0b20gPSBjdXN0b21bcGFyYW1dO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gY3VzdG9tW3RoaXMubmVzdGVkSWR4XTtcblxuICAgIH0gZWxzZSBpZiAocGFyYW1zLmxlbmd0aCA+PSAyICYmIHBhcmFtc1swXSA9PT0gJ2ludGVybHVkZScpIHtcbiAgICAgIC8vIGludGVybHVkZVxuICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uW3RoaXMuaWR4XVtwYXJhbXNbMV1dW3RoaXMubmVzdGVkSWR4XTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25bdGhpcy5pZHhdO1xufTtcblxuQXJndW1lbnRNYW5hZ2VyLnByb3RvdHlwZS5zdGFydEludGVybHVkZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gIHRoaXMubmVzdGVkSWR4ID0gMDtcbiAgdGhpcy5jdXJyZW50UGFyYW1zID0gWydpbnRlcmx1ZGUnLCB0eXBlXTtcbn07XG5cbkFyZ3VtZW50TWFuYWdlci5wcm90b3R5cGUuZW5kQXJnSW50ZXJsdWRlID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLm5lc3RlZElkeCA9IDA7XG4gIHRoaXMuY3VycmVudFBhcmFtcyA9IFtdO1xuICB0aGlzLmludGVybHVkZUNvbXBsZXRlU2lnbmFsLmRpc3BhdGNoKCk7XG59O1xuXG5Bcmd1bWVudE1hbmFnZXIucHJvdG90eXBlLnN0YXJ0U3BlY2lhbEFyZ3VtZW50ID0gZnVuY3Rpb24gKC8qLi4uIGFyZ3VtZW50cyovKSB7XG4gIHRoaXMubmVzdGVkSWR4ID0gMDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXG4gICAgdGhpcy5jdXJyZW50UGFyYW1zLnB1c2goYXJndW1lbnRzW2ldKTtcbn07XG5cbkFyZ3VtZW50TWFuYWdlci5wcm90b3R5cGUuZ2V0Q3VycmVudENvdW50ZXJzID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25bdGhpcy5pZHhdWydjb3VudGVycyddO1xufTtcblxuQXJndW1lbnRNYW5hZ2VyLnByb3RvdHlwZS5pc051bWJlclByb3BlcnR5ID0gZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gIHZhciBuID0gTWF0aC5mbG9vcihOdW1iZXIocHJvcGVydHkpKTtcbiAgcmV0dXJuIFN0cmluZyhuKSA9PSBwcm9wZXJ0eTtcbn07XG5cbkFyZ3VtZW50TWFuYWdlci5wcm90b3R5cGUuZ2V0QWxsQXJndW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAvLyByZXR1cm5zIGFzIGFuIGFycmF5XG4gIHZhciBhcmdzID0gW107XG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXModGhpcy5jb252ZXJzYXRpb24pO1xuICB2YXIgcHJvcDtcbiAgZm9yIChwcm9wIGluIGtleXMpIHtcbiAgICBpZiAodGhpcy5pc051bWJlclByb3BlcnR5KHByb3ApICYmIHByb3AgaW4gdGhpcy5jb252ZXJzYXRpb24pIHtcbiAgICAgIGFyZ3MucHVzaCh0aGlzLmNvbnZlcnNhdGlvbltwcm9wXSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBhcmdzO1xufTtcblxuQXJndW1lbnRNYW5hZ2VyLnByb3RvdHlwZS5nZXRBbGxBYmlsaXRpZXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBhYmlsaXRpZXMgPSBbXTtcbiAgaWYgKCdhYmlsaXRpZXMnIGluIHRoaXMuY29udmVyc2F0aW9uKSB7XG4gICAgdmFyIGk7XG4gICAgZm9yIChpIGluIHRoaXMuY29udmVyc2F0aW9uWydhYmlsaXRpZXMnXSkge1xuICAgICAgYWJpbGl0aWVzLnB1c2godGhpcy5jb252ZXJzYXRpb25bJ2FiaWxpdGllcyddW2ldKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGFiaWxpdGllcztcbn07XG5cbkFyZ3VtZW50TWFuYWdlci5wcm90b3R5cGUuc2V0QXJndW1lbnRCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jb252ZXJzYXRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAodGhpcy5jb252ZXJzYXRpb25baV1bJ2lkJ10gPT09IGlkKSB7XG4gICAgICB0aGlzLmlkeCA9IGk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG59O1xuXG5Bcmd1bWVudE1hbmFnZXIucHJvdG90eXBlLnRha2VBY3Rpb25zID0gZnVuY3Rpb24oKSB7XG4gIHZhciBhcmd1bWVudCA9IHRoaXMuZ2V0QXJndW1lbnQoKTtcbiAgaWYgKGFyZ3VtZW50ID09PSBudWxsKVxuICAgIHJldHVybiAnJztcblxuICBpZiAoJ2FjdGlvbnMnIGluIGFyZ3VtZW50KSB7XG4gICAgZm9yICh2YXIgYWN0aW9uIGluIGFyZ3VtZW50WydhY3Rpb25zJ10pIHtcbiAgICAgIENvbnZlcnNhdGlvbk1hbmFnZXIucHJvdG90eXBlLnRha2VBY3Rpb24uY2FsbCh0aGlzLCB0aGlzLl9nYW1lLCBhY3Rpb24sIGFyZ3VtZW50WydhY3Rpb25zJ11bYWN0aW9uXSk7XG4gICAgfVxuICB9XG59OyIsIi8qXG4gKiBCYXR0bGVVaVxuICogPT09PT09PT1cbiAqXG4gKiBVc2VyIGludGVyZmFjZSBmb3IgTG9naWMgQmF0dGxlIG1lY2hhbmljXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJhdHRsZVVpO1xuXG52YXIgSGVhbHRoQmFyID0gcmVxdWlyZSgnLi9IZWFsdGhCYXIuanMnKTtcbnZhciBJY29uID0gcmVxdWlyZSgnLi9JY29uJyk7XG52YXIgdGV4dHN0eWxlcyA9IHJlcXVpcmUoJy4uLy4uL3N0YXRpYy9hc3NldHMvdGV4dHN0eWxlcy5qc29uJyk7XG52YXIgbnBjcyA9IHJlcXVpcmUoJy4uLy4uL3N0YXRpYy9hc3NldHMvbnBjcy5qc29uJyk7XG5cbmZ1bmN0aW9uIEJhdHRsZVVpKGdhbWUsIHBsYXllckRlY2ssIGVuZW15RGVjay8qLCAuLi5hcmdzKi8pIHtcbiAgUGhhc2VyLkdyb3VwLmNhbGwodGhpcywgZ2FtZS8qLCAuLi5hcmdzKi8pO1xuXG4gIC8vIC0gdGhpcy5jYXJkU2lnbmFsXG4gIC8vIC0gdGhpcy5jYXJkQW5pbUNvbXBsZXRlU2lnbmFsXG4gIC8vIC0gdGhpcy5hcmdBbmltQ29tcGxldGVTaWduYWxcbiAgLy8gLSB0aGlzLnBsYXllckRlY2tJY29uc1xuICAvLyAtIHRoaXMuZW5lbXlEZWNrSWNvbnNcbiAgLy8gLSB0aGlzLmNyZWRCYXJcblxuICAvKiogU2lnbmFscyAqL1xuICB0aGlzLmNhcmRTaWduYWwgPSBuZXcgUGhhc2VyLlNpZ25hbCgpO1xuICB0aGlzLmNvbXBhbmlvblNpZ25hbCA9IG5ldyBQaGFzZXIuU2lnbmFsKCk7XG4gIHRoaXMuY2FyZEFuaW1Db21wbGV0ZVNpZ25hbCA9IG5ldyBQaGFzZXIuU2lnbmFsKCk7XG4gIHRoaXMuYXJnQW5pbUNvbXBsZXRlU2lnbmFsID0gbmV3IFBoYXNlci5TaWduYWwoKTtcblxuICB0aGlzLnBsYXllckRlY2tJY29ucyA9IFtdO1xuICB0aGlzLmVuZW15RGVja0ljb25zID0gW107XG4gIHRoaXMuY29tcGFuaW9uSWNvbnMgPSBbXTtcblxuICAvKiogUHJpdmF0ZSBwcm9wZXJ0aWVzICovXG4gIHRoaXMuX2dhbWUgPSBnYW1lO1xuICB0aGlzLl9wb3J0cmFpdFNpemUgPSAxMDA7XG4gIHRoaXMuX2NhcmRXaWR0aCA9IDcwO1xuICB0aGlzLl9jYXJkSGVpZ2h0OyAvLyB1bnNwZWNpZmllZFxuICB0aGlzLl9jcmVkU2l6ZSA9IDg1O1xuICB0aGlzLl9lbmVteU9yaWdpblkgPSBnYW1lLmhlaWdodCAqIDAuMztcbiAgdGhpcy5fY2VudGVyWCA9IGdhbWUud2lkdGggLyAyO1xuICB0aGlzLl9hcmd1bWVudFJhZGl1cyA9IHRoaXMuX3BvcnRyYWl0U2l6ZTtcbiAgdGhpcy5fcGxheWVySWNvbnNQZXJSb3cgPSA0O1xuXG4gIC8qKiBCYWNrZ3JvdW5kICsgb3ZlcmxheSAodGhpcy5fYmFja2dyb3VuZCwgdGhpcy5fb3ZlcmxheSkgKi9cbiAgdmFyIHJvb21CZyA9IGdhbWUubWFrZS5zcHJpdGUoMCwwLCBnYW1lLnJvb20uYXJlYS5pZCk7XG4gIGdhbWUuYWRkLmV4aXN0aW5nKHJvb21CZyk7XG5cbiAgdGhpcy5fYmFja2dyb3VuZCA9IGdhbWUuYWRkLnNwcml0ZSgwLDAsJ2JhdHRsZS1iYWNrZ3JvdW5kJyk7XG4gIHRoaXMuX2JhY2tncm91bmQud2lkdGggPSBnYW1lLndpZHRoO1xuICB0aGlzLl9iYWNrZ3JvdW5kLmhlaWdodCA9IGdhbWUuaGVpZ2h0O1xuICB0aGlzLl9iYWNrZ3JvdW5kLmFscGhhID0gMC44NTtcblxuICB0aGlzLl9vdmVybGF5ID0gZ2FtZS5hZGQuc3ByaXRlKDAsMCwnYmF0dGxlLW92ZXJsYXknKTtcbiAgdGhpcy5fb3ZlcmxheS53aWR0aCA9IGdhbWUud2lkdGg7XG4gIHRoaXMuX292ZXJsYXkuaGVpZ2h0ID0gZ2FtZS5oZWlnaHQ7XG4gIC8vIGhpZGUgb3ZlcmxheSBpbml0aWFsbHlcbiAgdGhpcy5fb3ZlcmxheS5hbHBoYSA9IDA7XG5cbiAgLyoqIEVuZW15IGRpc3BsYXkgKi9cbiAgdmFyIGVuZW15QmFyQ29uZmlnID0ge3g6IHRoaXMuX2NlbnRlclgsIHk6IDUwLCBoZWlnaHQ6MjAsIHdpZHRoOjE1MCwgZmxpcHBlZDp0cnVlfTtcbiAgdGhpcy5wZXJzdWFkZUJhciA9IG5ldyBIZWFsdGhCYXIoZ2FtZSwgZW5lbXlCYXJDb25maWcpO1xuICB2YXIgZW5lbXlJY29uID0gZ2FtZS5hZGQuZXhpc3RpbmcobmV3IEljb24oZ2FtZSxcbiAgICB0aGlzLl9jZW50ZXJYIC0gdGhpcy5fcG9ydHJhaXRTaXplLzIsIHRoaXMuX2VuZW15T3JpZ2luWSAtIHRoaXMuX3BvcnRyYWl0U2l6ZS8yLFxuICAgICdnbGVhbWluZy1zaG9hbC1wb3J0cmFpdCcsIG51bGwsIG51bGwsIHRoaXMuX3BvcnRyYWl0U2l6ZSkpO1xuICBlbmVteUljb24uYWxwaGEgPSAxO1xuXG4gIC8qKiBFbmVteSBkZWNrIGRpc3BsYXkgKi9cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbmVteURlY2subGVuZ3RoOyBpKyspIHtcblxuICAgIHZhciBhcmdJY29uID0gZ2FtZS5hZGQuZXhpc3RpbmcobmV3IEljb24oZ2FtZSwgMCwwLFxuICAgICAgJ3F1ZXN0aW9uLW1hcmsnLCAnbWVtb3J5LWJhbmstaWNvbi1tYXNrJywgJ2VuZW15LWFyZy1pY29uJywgdGhpcy5fY2FyZFdpZHRoKSk7XG5cbiAgICB0aGlzLmVuZW15RGVja0ljb25zLnB1c2goeydpZCc6IGVuZW15RGVja1tpXS5hc3NldE5hbWUsICdpY29uJzogYXJnSWNvbn0pO1xuXG4gIH1cbiAgdGhpcy5wb3NpdGlvbkFyZ3VtZW50cyhnYW1lLCBmYWxzZSk7XG5cbiAgLyogQ3VycmVudCBhcmd1bWVudCBwb3NpdGlvbiBtYXJrZXIgKi9cbiAgdmFyIGN1cnJlbnRBcmdNYXJrZXIgPSBnYW1lLmFkZC5zcHJpdGUoMCwgMCwgJ2VuZW15LWFyZy1pY29uJyk7XG4gIGN1cnJlbnRBcmdNYXJrZXIuc2NhbGUuc2V0VG8odGhpcy5fY2FyZFdpZHRoICogMS4yIC8gY3VycmVudEFyZ01hcmtlci53aWR0aCk7XG4gIGN1cnJlbnRBcmdNYXJrZXIuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuICBjdXJyZW50QXJnTWFya2VyLnggPSB0aGlzLl9jZW50ZXJYO1xuICBjdXJyZW50QXJnTWFya2VyLnkgPSB0aGlzLl9lbmVteU9yaWdpblkgKyB0aGlzLl9hcmd1bWVudFJhZGl1cztcblxuICAvKiogUGxheWVyIGRpc3BsYXkgKi9cbiAgdGhpcy5jcmVkSWNvbiA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICB0aGlzLl9jZW50ZXJYIC0gdGhpcy5fY3JlZFNpemUvMiwgZ2FtZS5oZWlnaHQgKiA1IC8gOCAtIHRoaXMuX2NyZWRTaXplIC8gMixcbiAgICBuZXcgSWNvbihnYW1lLCAwLDAsXG4gICAgJ21lbW9yeS1iYW5rLWljb24tbWFzaycsIG51bGwsICdtZW1vcnktYmFuay1pY29uJywgdGhpcy5fY3JlZFNpemUpKTtcbiAgZ2FtZS5zbGlja1VJLmFkZCh0aGlzLmNyZWRJY29uKTtcbiAgdGhpcy5fY2FyZEhlaWdodCA9IHRoaXMuY3JlZEljb24uZGlzcGxheU9iamVjdC5oZWlnaHQ7XG5cbiAgdGhpcy5jcmVkSWNvbi5hZGQoXG4gICAgdGhpcy5jcmVkVGV4dCA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdCgwLCAwLFxuICAgICAgZ2FtZS5tYWtlLnRleHQoMCwgMCwgJycrdGhpcy5fZ2FtZS5jcmVkLCB0ZXh0c3R5bGVzWydjcmVkaWJpbGl0eSddKSlcbiAgKTtcbiAgdGhpcy5jcmVkVGV4dC5kaXNwbGF5T2JqZWN0LnNldFRleHRCb3VuZHMoMCwgMCwgdGhpcy5fY3JlZFNpemUsIHRoaXMuY3JlZEljb24uZGlzcGxheU9iamVjdC5oZWlnaHQpO1xuXG4gIC8qKiBQbGF5ZXIgZGVjayBkaXNwbGF5ICovXG4gIGZvciAoaSA9IDA7IGkgPCBwbGF5ZXJEZWNrLmxlbmd0aDsgaSsrKSB7XG4gICAgdGhpcy5tYWtlQ2FyZEljb24ocGxheWVyRGVja1tpXSk7XG4gIH1cblxuICAvKiogQ29tcGFuaW9uIGRpc3BsYXkgKi9cbiAgZm9yIChpID0gMDsgaSA8IGdhbWUuY29tcGFuaW9ucy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBjb21wYW5pb25OYW1lID0gbnBjc1tnYW1lLmNvbXBhbmlvbnNbaV1dWyduYW1lJ107XG4gICAgdmFyIGNvbXBhbmlvbkF2YXRhciA9IG5wY3NbZ2FtZS5jb21wYW5pb25zW2ldXVsnYXZhdGFyJ107XG4gICAgdmFyIGNvbXBhbmlvbkljb24gPSBnYW1lLmFkZC5leGlzdGluZyhuZXcgSWNvbihnYW1lLCAwLDAsXG4gICAgICBjb21wYW5pb25BdmF0YXIsICdtZW1vcnktYmFuay1pY29uLW1hc2snLCAnY29tcGFuaW9uLWljb24nLCB0aGlzLl9jYXJkV2lkdGgpKTtcbiAgICBjb21wYW5pb25JY29uLmJvcmRlclNwcml0ZS50aW50ID0gMHgwMGZmZmY7XG4gICAgY29tcGFuaW9uSWNvbi54ID0gZ2FtZS53aWR0aCAqIDEvNSArIGkqKHRoaXMuX2NhcmRXaWR0aCk7XG4gICAgY29tcGFuaW9uSWNvbi55ID0gdGhpcy5jcmVkSWNvbi55IC0gdGhpcy5fY2FyZFdpZHRoIC8gMjtcblxuICAgIHZhciBjb21wYW5pb25TaWduYWwgPSB0aGlzLmNvbXBhbmlvblNpZ25hbDtcbiAgICBjb21wYW5pb25JY29uLmV2ZW50cy5vbklucHV0RG93bi5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgY29tcGFuaW9uU2lnbmFsLmRpc3BhdGNoKHRoaXMuZ2FtZSwgdGhpcy5jb21wYW5pb25OYW1lKTtcbiAgICB9LCB7Z2FtZTogZ2FtZSwgY29tcGFuaW9uTmFtZTogY29tcGFuaW9uTmFtZX0pO1xuXG4gICAgY29tcGFuaW9uSWNvbi5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgIGNvbXBhbmlvbkljb24uaW5wdXQudXNlSGFuZEN1cnNvciA9IHRydWU7XG5cbiAgICB0aGlzLmNvbXBhbmlvbkljb25zLnB1c2goY29tcGFuaW9uSWNvbik7XG4gIH1cblxufVxuXG5CYXR0bGVVaS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5Hcm91cC5wcm90b3R5cGUpO1xuQmF0dGxlVWkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQmF0dGxlVWk7XG5cbkJhdHRsZVVpLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIFRPRE86IFN0dWIuXG59O1xuXG5CYXR0bGVVaS5wcm90b3R5cGUubWFrZUNhcmRJY29uID0gZnVuY3Rpb24gKGNhcmQpIHtcbiAgdmFyIGRlY2tPcmlnaW5YID0gdGhpcy5fZ2FtZS53aWR0aCAqIDMgLyA1O1xuICB2YXIgZGVja09yaWdpblkgPSB0aGlzLmNyZWRJY29uLnkgKyAodGhpcy5fY3JlZFNpemUgLSB0aGlzLl9jYXJkV2lkdGgpIC8gMjtcblxuICB2YXIgaWNvbklkeCA9IHRoaXMucGxheWVyRGVja0ljb25zLmxlbmd0aDtcblxuICAvLyBvdGhlcndpc2UsIG1ha2UgYSBuZXcgY2FyZCBpY29uXG4gIHZhciBwbGF5ZXJDYXJkSWNvbiA9IHRoaXMuX2dhbWUuYWRkLmV4aXN0aW5nKG5ldyBJY29uKHRoaXMuX2dhbWUsIDAsMCxcbiAgICBjYXJkLmFzc2V0TmFtZSwgJ21lbW9yeS1iYW5rLWljb24tbWFzaycsICdtZW1vcnktYmFuay1pY29uJywgdGhpcy5fY2FyZFdpZHRoKSk7XG4gIHBsYXllckNhcmRJY29uLnggPSBkZWNrT3JpZ2luWCArIGljb25JZHgldGhpcy5fcGxheWVySWNvbnNQZXJSb3cgKiB0aGlzLl9jYXJkV2lkdGg7XG4gIHBsYXllckNhcmRJY29uLnkgPSBkZWNrT3JpZ2luWSAtIE1hdGguZmxvb3IoaWNvbklkeC90aGlzLl9wbGF5ZXJJY29uc1BlclJvdykgKiB0aGlzLl9jYXJkSGVpZ2h0O1xuXG4gIHZhciBjYXJkU2lnbmFsID0gdGhpcy5jYXJkU2lnbmFsO1xuICAvLyBzZW5kIHNpZ25hbCB1cG9uIGNsaWNrIGFuZCBkZWxldGUgdG9vbHRpcFxuICBwbGF5ZXJDYXJkSWNvbi5ldmVudHMub25JbnB1dERvd24uYWRkKGZ1bmN0aW9uICgpIHtcbiAgICBjYXJkU2lnbmFsLmRpc3BhdGNoKHRoaXMuZ2FtZSwgdGhpcy5jdXJyZW50Q2FyZCk7XG4gIH0sIHtnYW1lOiB0aGlzLl9nYW1lLCBjdXJyZW50Q2FyZDogY2FyZH0pO1xuXG4gIHBsYXllckNhcmRJY29uLmlucHV0RW5hYmxlZCA9IHRydWU7XG4gIHBsYXllckNhcmRJY29uLmlucHV0LnVzZUhhbmRDdXJzb3IgPSB0cnVlO1xuXG4gIHRoaXMucGxheWVyRGVja0ljb25zLnB1c2gocGxheWVyQ2FyZEljb24pO1xuICB0aGlzLmFkZFRvb2x0aXAoY2FyZCwgaWNvbklkeCxcbiAgICB0aGlzLl9jZW50ZXJYICsgdGhpcy5fYXJndW1lbnRSYWRpdXMsIHRoaXMuX2VuZW15T3JpZ2luWSAtIHRoaXMuX2FyZ3VtZW50UmFkaXVzKTtcbiAgcmV0dXJuIHBsYXllckNhcmRJY29uO1xufTtcblxuQmF0dGxlVWkucHJvdG90eXBlLmdldEFyZ0ljb24gPSBmdW5jdGlvbiAoYXJndW1lbnQpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmVuZW15RGVja0ljb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGFyZ0ljb25XaXRoSWR4ID0gdGhpcy5lbmVteURlY2tJY29uc1tpXTtcbiAgICBpZiAoYXJndW1lbnQuYXNzZXROYW1lID09PSBhcmdJY29uV2l0aElkeFsnaWQnXSkge1xuICAgICAgcmV0dXJuIHsnaW5kZXgnOiBpLCAnaWQnOiBhcmdJY29uV2l0aElkeFsnaWQnXSwgJ2ljb24nOiBhcmdJY29uV2l0aElkeFsnaWNvbiddfTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsnaW5kZXgnOiAtMSwgJ2ljb24nOiBudWxsfTtcbn07XG5cbkJhdHRsZVVpLnByb3RvdHlwZS5yZXZlYWxDdXJyZW50ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgY3VycmVudEljb25XaXRoSWQgPSB0aGlzLmVuZW15RGVja0ljb25zWzBdO1xuICBjdXJyZW50SWNvbldpdGhJZFsnaWNvbiddID0gdGhpcy5yZXZlYWxBcmdJY29uKFxuICAgIGN1cnJlbnRJY29uV2l0aElkWydpZCddLCBjdXJyZW50SWNvbldpdGhJZFsnaWNvbiddKTtcbn07XG5cbkJhdHRsZVVpLnByb3RvdHlwZS5yZXZlYWxBcmdJY29uID0gZnVuY3Rpb24gKGlkLCBhcmdJY29uKSB7XG4gIHZhciB0cmFzaCA9IGFyZ0ljb247XG4gIHZhciBuZXdJY29uID0gdGhpcy5fZ2FtZS5hZGQuZXhpc3RpbmcobmV3IEljb24odGhpcy5fZ2FtZSwgMCwwLFxuICAgIGlkLCAnbWVtb3J5LWJhbmstaWNvbi1tYXNrJywgJ2VuZW15LWFyZy1pY29uJywgdGhpcy5fY2FyZFdpZHRoKSk7XG4gIG5ld0ljb24ueCA9IGFyZ0ljb24ueDtcbiAgbmV3SWNvbi55ID0gYXJnSWNvbi55O1xuICB0aGlzLl9nYW1lLndvcmxkLnN3YXAoYXJnSWNvbiwgbmV3SWNvbik7ICAvLyBzd2FwIGRpc3BsYXkgb3JkZXJpbmdcbiAgdHJhc2guZGVzdHJveSgpO1xuICByZXR1cm4gbmV3SWNvbjtcbn07XG5cbkJhdHRsZVVpLnByb3RvdHlwZS5nZXRDYXJkSWNvbiA9IGZ1bmN0aW9uIChjYXJkKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wbGF5ZXJEZWNrSWNvbnMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgY2FyZEljb24gPSB0aGlzLnBsYXllckRlY2tJY29uc1tpXTtcbiAgICBpZiAoY2FyZC5rZXkgPT09IGNhcmRJY29uLmlkKSB7XG4gICAgICByZXR1cm4geydpbmRleCc6IGksICdpY29uJzogY2FyZEljb259O1xuICAgIH1cbiAgfVxuICByZXR1cm4geydpbmRleCc6IC0xLCAnaWNvbic6IG51bGx9O1xufTtcblxuQmF0dGxlVWkucHJvdG90eXBlLnN0YXJ0Q29ycmVjdENhcmRUd2VlbiA9IGZ1bmN0aW9uIChjYXJkSWNvbiwgY2FyZElkeCwgdGFyZ2V0ZWRBcmcpIHtcbiAgLy90aGlzIHNvdW5kcyBiZXN0IHdoZW4gaXQgc3RhcnRzIGF0IGNsaWNrXG4gIHRoaXMuX2dhbWUuc291bmQucGxheSgnY29ycmVjdC1jYXJkJyk7XG4gIHZhciB0d2VlbiA9IHRoaXMuX2dhbWUuYWRkLnR3ZWVuKGNhcmRJY29uKTtcbiAgdHdlZW4udG8oXG4gICAgeyB4OiB0YXJnZXRlZEFyZy54LCB5OiB0YXJnZXRlZEFyZy55IH0sIDEwMDAsXG4gICAgUGhhc2VyLkVhc2luZy5FeHBvbmVudGlhbC5JbiwgdHJ1ZSwgMCk7XG5cbiAgLy8gY3JlYXRlIGZpbGwgc3ByaXRlXG5cbiAgdmFyIHNoYXR0ZXJTcHJpdGUgPSB0aGlzLl9nYW1lLm1ha2Uuc3ByaXRlKFxuICAgIHRhcmdldGVkQXJnLnggKyB0YXJnZXRlZEFyZy53aWR0aC8yLFxuICAgIHRhcmdldGVkQXJnLnkgKyB0YXJnZXRlZEFyZy5oZWlnaHQvMiwgJ21lbW9yeS1iYW5rLWljb24tZmlsbCcpO1xuICBzaGF0dGVyU3ByaXRlLmFscGhhID0gMDtcbiAgLy8gYWRkIHNsaWdodCBmdWRnZSBmYWN0b3JcbiAgc2hhdHRlclNwcml0ZS5zY2FsZS5zZXRUbyh0aGlzLl9jYXJkV2lkdGgqMS4wNSAvIHNoYXR0ZXJTcHJpdGUud2lkdGgpO1xuICBzaGF0dGVyU3ByaXRlLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG4gIHRoaXMuX2dhbWUuYWRkLmV4aXN0aW5nKHNoYXR0ZXJTcHJpdGUpO1xuICB2YXIgYWxwaGFUd2VlbiA9IHRoaXMuX2dhbWUuYWRkLnR3ZWVuKHNoYXR0ZXJTcHJpdGUpO1xuXG4gIC8vIHN0YXJ0IGFscGhhIHR3ZWVuIGFmdGVyXG4gIHR3ZWVuLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICBhbHBoYVR3ZWVuLnRvKHsgYWxwaGE6IDEgfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5FeHBvbmVudGlhbC5JbiwgdHJ1ZSwgMCk7XG4gICAgYWxwaGFUd2Vlbi5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICBjYXJkSWNvbi5kZXN0cm95KCk7XG4gICAgICB0YXJnZXRlZEFyZy5kZXN0cm95KCk7XG4gICAgICBzaGF0dGVyU3ByaXRlLmRlc3Ryb3koKTtcbiAgICAgIC8vIGFyZ3VtZW50cyB1cGRhdGUgYnkgdGhlbXNlbHZlcywgcGxheWVyIGNhcmRzIGRvIG5vdFxuICAgICAgdGhpcy5wbGF5ZXJEZWNrSWNvbnMuc3BsaWNlKGNhcmRJZHgsIDEpO1xuICAgIH0sIHRoaXMpO1xuICB9LCB0aGlzKTtcblxuICAvLyByZXR1cm4gdGhlIGxhc3QgdHdlZW4gaW4gdGhlIGNoYWluXG4gIHJldHVybiBhbHBoYVR3ZWVuO1xufTtcblxuQmF0dGxlVWkucHJvdG90eXBlLnN0YXJ0SW5jb3JyZWN0Q2FyZFR3ZWVuID0gZnVuY3Rpb24gKGNhcmRJY29uLCB0YXJnZXRlZEFyZykge1xuICB2YXIgdHdlZW4gPSB0aGlzLl9nYW1lLmFkZC50d2VlbihjYXJkSWNvbik7XG4gIHZhciBvcmlnaW5YID0gY2FyZEljb24ueDtcbiAgdmFyIG9yaWdpblkgPSBjYXJkSWNvbi55O1xuXG4gIHR3ZWVuLnRvKHsgeDogdGFyZ2V0ZWRBcmcueCwgeTogdGFyZ2V0ZWRBcmcueSB9LCAxMDAwLFxuICAgIFBoYXNlci5FYXNpbmcuRXhwb25lbnRpYWwuSW5PdXQsIGZhbHNlLCAwKTtcbiAgLy8gYWRkIGFuIGFkZGl0aW9uYWwgdHdlZW4gdG8gcmV0dXJuIHRvIG9yaWdpbmFsIHBvc2l0aW9uXG4gIHR3ZWVuLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLl9nYW1lLnNvdW5kLnBsYXkoJ3dyb25nLWNhcmQnKTtcblxuICB9LCB0aGlzKTtcblxuICB2YXIgbGFzdFR3ZWVuID0gdGhpcy5fZ2FtZS5hZGQudHdlZW4oY2FyZEljb24pO1xuICBsYXN0VHdlZW4udG8oeyB4OiBvcmlnaW5YLCB5OiBvcmlnaW5ZIH0sIDEwMDAsXG4gICAgUGhhc2VyLkVhc2luZy5FeHBvbmVudGlhbC5JbiwgZmFsc2UsIDApO1xuXG4gIHR3ZWVuLmNoYWluKGxhc3RUd2Vlbikuc3RhcnQoKTtcblxuICAvLyByZXR1cm4gbGFzdCB0d2VlbiBpbiB0aGUgY2hhaW5cbiAgcmV0dXJuIGxhc3RUd2Vlbjtcbn07XG5cbkJhdHRsZVVpLnByb3RvdHlwZS5wbGF5Q2FyZEFuaW1hdGlvbiA9IGZ1bmN0aW9uIChjYXJkLCBhcmd1bWVudCwgaXNDb3JyZWN0KSB7XG4gIC8vIGZpbmQgbWF0Y2hpbmcgYXJndW1lbnQgaWNvblxuICB2YXIgdGFyZ2V0ZWRBcmcgPSB1bmRlZmluZWQ7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5lbmVteURlY2tJY29ucy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBhcmdJY29uSWQgPSB0aGlzLmVuZW15RGVja0ljb25zW2ldWydpZCddO1xuICAgIGlmIChhcmd1bWVudC5hc3NldE5hbWUgPT09IGFyZ0ljb25JZCkge1xuICAgICAgdGFyZ2V0ZWRBcmcgPSB0aGlzLmVuZW15RGVja0ljb25zW2ldWydpY29uJ107XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgaWYgKHR5cGVvZiB0YXJnZXRlZEFyZyA9PT0gJ3VuZGVmaW5lZCcpXG4gICAgcmV0dXJuO1xuXG4gIC8vIGZpbmQgbWF0Y2hpbmcgY2FyZCBpY29uXG4gIGZvciAoaSA9IDA7IGkgPCB0aGlzLnBsYXllckRlY2tJY29ucy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBjYXJkSWNvbiA9IHRoaXMucGxheWVyRGVja0ljb25zW2ldO1xuICAgIGlmIChjYXJkLmtleSA9PT0gY2FyZEljb24uaWQpIHtcbiAgICAgIHZhciBsYXN0VHdlZW47XG4gICAgICAvLyBwbGF5IGRpZmZlcmVudCBhbmltYXRpb25zIG9uIGNvcnJlY3QgdnMuIGluY29ycmVjdCBjYXJkXG4gICAgICBpZiAoaXNDb3JyZWN0KSB7XG4gICAgICAgIGxhc3RUd2VlbiA9IHRoaXMuc3RhcnRDb3JyZWN0Q2FyZFR3ZWVuKGNhcmRJY29uLCBpLCB0YXJnZXRlZEFyZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsYXN0VHdlZW4gPSB0aGlzLnN0YXJ0SW5jb3JyZWN0Q2FyZFR3ZWVuKGNhcmRJY29uLCB0YXJnZXRlZEFyZyk7XG4gICAgICB9XG4gICAgICBsYXN0VHdlZW4ub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoY2FyZC5tdWx0aVVzZSAmJiBpc0NvcnJlY3QpXG4gICAgICAgICAgdGhpcy5tYWtlQ2FyZEljb24oY2FyZCk7XG4gICAgICAgIHRoaXMuY2FyZEFuaW1Db21wbGV0ZVNpZ25hbC5kaXNwYXRjaCh0aGlzLl9nYW1lKTtcblxuICAgICAgfSwgdGhpcyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG59O1xuXG5CYXR0bGVVaS5wcm90b3R5cGUudXBkYXRlQXJndW1lbnRzID0gZnVuY3Rpb24gKGFyZ3MsIGN1cnJlbnRBcmdJZHgpIHtcbiAgdmFyIG5ld0VuZW15RGVja0ljb25zID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGlkeCA9IGN1cnJlbnRBcmdJZHggKyBpO1xuICAgIGlmIChpZHggPj0gYXJncy5sZW5ndGgpXG4gICAgICBpZHggLT0gYXJncy5sZW5ndGg7XG5cbiAgICAvLyBudWxsIGFyZ3VtZW50XG4gICAgaWYgKHR5cGVvZiBhcmdzW2lkeF0gPT09ICd1bmRlZmluZWQnIHx8IGFyZ3NbaWR4XSA9PT0gbnVsbClcbiAgICAgIGNvbnRpbnVlO1xuXG4gICAgdmFyIGFyZ0ljb25XaXRoSWQgPSB0aGlzLmdldEFyZ0ljb24oYXJnc1tpZHhdKTtcbiAgICAvLyBub3QgZm91bmRcbiAgICBpZiAoYXJnSWNvbldpdGhJZFsnaW5kZXgnXSA9PT0gLTEpIHtcbiAgICAgIC8vIGFkZCBhIG5ldyBhcmd1bWVudCBpY29uXG4gICAgICBhcmdJY29uV2l0aElkWydpZCddID0gYXJnc1tpZHhdWydhc3NldE5hbWUnXTtcbiAgICAgIGFyZ0ljb25XaXRoSWRbJ2ljb24nXSA9IHRoaXMuX2dhbWUuYWRkLmV4aXN0aW5nKG5ldyBJY29uKHRoaXMuX2dhbWUsIDAsMCxcbiAgICAgICAgJ3F1ZXN0aW9uLW1hcmsnLCAnbWVtb3J5LWJhbmstaWNvbi1tYXNrJywgJ2VuZW15LWFyZy1pY29uJywgdGhpcy5fY2FyZFdpZHRoKSk7XG4gICAgICAvLyBUT0RPOiBoYXJkY29kZWQgYXMgY2VudGVyIHJpZ2h0IG5vdy5cbiAgICAgIGFyZ0ljb25XaXRoSWRbJ2ljb24nXS54ID0gdGhpcy5fY2VudGVyWCAtIHRoaXMuX2NhcmRXaWR0aC8yO1xuICAgICAgYXJnSWNvbldpdGhJZFsnaWNvbiddLnkgPSB0aGlzLl9lbmVteU9yaWdpblkgLSB0aGlzLl9jYXJkV2lkdGgvMjtcbiAgICB9XG4gICAgbmV3RW5lbXlEZWNrSWNvbnMucHVzaCh7XG4gICAgICAnaWQnOiBhcmdJY29uV2l0aElkWydpZCddLCBcbiAgICAgICdpY29uJzogYXJnSWNvbldpdGhJZFsnaWNvbiddXG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmVuZW15RGVja0ljb25zID0gbmV3RW5lbXlEZWNrSWNvbnM7XG59O1xuXG5CYXR0bGVVaS5wcm90b3R5cGUucG9zaXRpb25Bcmd1bWVudHMgPSBmdW5jdGlvbiAoZ2FtZSwgaXNUd2VlbmluZyA9IHRydWUpIHtcbiAgdmFyIG5BcmdzID0gdGhpcy5lbmVteURlY2tJY29ucy5sZW5ndGg7XG4gIHZhciBhcmdJY29uO1xuXG4gIGlmICghaXNUd2VlbmluZykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbkFyZ3M7IGkrKykge1xuICAgICAgYXJnSWNvbiA9IHRoaXMuZW5lbXlEZWNrSWNvbnNbaV1bJ2ljb24nXTtcbiAgICAgIGFyZ0ljb24ueCA9IHRoaXMuX2NlbnRlclggKyBNYXRoLnNpbihpIC8gbkFyZ3MgKiAyKk1hdGguUEkpICogdGhpcy5fYXJndW1lbnRSYWRpdXMgLSB0aGlzLl9jYXJkV2lkdGggLyAyO1xuICAgICAgYXJnSWNvbi55ID0gdGhpcy5fZW5lbXlPcmlnaW5ZICsgTWF0aC5jb3MoaSAvIG5BcmdzICogMipNYXRoLlBJKSAqIHRoaXMuX2FyZ3VtZW50UmFkaXVzIC0gdGhpcy5fY2FyZFdpZHRoIC8gMjtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHR3ZWVuaW5nUG9zaXRpb25zID0gW107XG4gIHZhciB0d2VlbnMgPSBbXTtcbiAgZm9yICh2YXIgaiA9IDA7IGogPCBuQXJnczsgaisrKSB7XG4gICAgdHdlZW5pbmdQb3NpdGlvbnMucHVzaChcbiAgICAgIG5ldyBQaGFzZXIuUG9pbnQoXG4gICAgICAgIHRoaXMuX2NlbnRlclggKyBNYXRoLnNpbihqIC8gbkFyZ3MgKiAyKk1hdGguUEkpICogdGhpcy5fYXJndW1lbnRSYWRpdXMgLSB0aGlzLl9jYXJkV2lkdGggLyAyLFxuICAgICAgICB0aGlzLl9lbmVteU9yaWdpblkgKyBNYXRoLmNvcyhqIC8gbkFyZ3MgKiAyKk1hdGguUEkpICogdGhpcy5fYXJndW1lbnRSYWRpdXMgLSB0aGlzLl9jYXJkV2lkdGggLyAyKSk7XG4gIH1cbiAgZm9yIChqID0gMDsgaiA8IG5BcmdzOyBqKyspIHtcbiAgICBhcmdJY29uID0gdGhpcy5lbmVteURlY2tJY29uc1tqXVsnaWNvbiddO1xuICAgIGlmICh0eXBlb2YgYXJnSWNvbiA9PT0gJ3VuZGVmaW5lZCcgfHwgYXJnSWNvbiA9PT0gbnVsbClcbiAgICAgIGNvbnRpbnVlO1xuICAgIHR3ZWVucy5wdXNoKGdhbWUuYWRkLnR3ZWVuKGFyZ0ljb24pLnRvKFxuICAgICAgeyB4OiB0d2VlbmluZ1Bvc2l0aW9uc1tqXS54LCB5OiB0d2VlbmluZ1Bvc2l0aW9uc1tqXS55fSxcbiAgICAgIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhZHJhdGljLkluT3V0LCBmYWxzZSwgMCkpO1xuICB9XG4gIGZvciAoaiA9IDA7IGogPCB0d2VlbnMubGVuZ3RoOyBqKyspIHtcbiAgICAvLyBOb3RpZnkgY29tcGxldGlvbiBvZiBhcmd1bWVudCByb3RhdGlvblxuICAgIGlmIChqID09PSAwKSB7XG4gICAgICB0d2VlbnNbal0ub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFyZ0FuaW1Db21wbGV0ZVNpZ25hbC5kaXNwYXRjaCh0aGlzLl9nYW1lKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH1cbiAgICB0d2VlbnNbal0uc3RhcnQoKTtcbiAgfVxufTtcblxuLyogR2l2ZXMgdGhlIGltcHJlc3Npb24gb2YgYXJndW1lbnRzIHJhbmRvbWl6aW5nLiAqL1xuQmF0dGxlVWkucHJvdG90eXBlLnJvdWxldHRlQXJndW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgbGFzdFR3ZWVuID0gbnVsbDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmVuZW15RGVja0ljb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgbGFzdFR3ZWVuID0gdGhpcy5fZ2FtZS5hZGQudHdlZW4odGhpcy5lbmVteURlY2tJY29uc1tpXVsnaWNvbiddKS50byhcbiAgICAgIHsgeDogdGhpcy5fY2VudGVyWCAtIHRoaXMuX2NhcmRXaWR0aC8yLCB5OiB0aGlzLl9lbmVteU9yaWdpblkgLSB0aGlzLl9jYXJkV2lkdGgvMn0sIFxuICAgICAgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFkcmF0aWMuSW5PdXQsIHRydWUsIDApO1xuICB9XG4gIHJldHVybiBsYXN0VHdlZW47XG59O1xuXG5CYXR0bGVVaS5wcm90b3R5cGUucG9zaXRpb25DYXJkcyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGRlY2tPcmlnaW5YID0gdGhpcy5fZ2FtZS53aWR0aCAqIDMgLyA1O1xuICB2YXIgZGVja09yaWdpblkgPSB0aGlzLmNyZWRJY29uLnkgKyAodGhpcy5fY3JlZFNpemUgLSB0aGlzLl9jYXJkV2lkdGgpIC8gMjtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGxheWVyRGVja0ljb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHR3ZWVuID0gdGhpcy5fZ2FtZS5hZGQudHdlZW4odGhpcy5wbGF5ZXJEZWNrSWNvbnNbaV0pO1xuICAgIHR3ZWVuLnRvKHt4OiBkZWNrT3JpZ2luWCArIGkldGhpcy5fcGxheWVySWNvbnNQZXJSb3cgKiB0aGlzLl9jYXJkV2lkdGgsXG4gICAgICB5OiBkZWNrT3JpZ2luWSAtIE1hdGguZmxvb3IoaS90aGlzLl9wbGF5ZXJJY29uc1BlclJvdykgKiB0aGlzLl9jYXJkSGVpZ2h0fSxcbiAgICAgIDMwMCwgUGhhc2VyLkVhc2luZy5RdWFkcmF0aWMuSW5PdXQsIHRydWUsIDApO1xuICB9XG59O1xuXG5CYXR0bGVVaS5wcm90b3R5cGUuYmF0dGxlU3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuY2FyZHNJbnB1dEVuYWJsZWQodHJ1ZSk7XG4gIHRoaXMucmV2ZWFsQ3VycmVudCgpO1xufTtcblxuQmF0dGxlVWkucHJvdG90eXBlLmludHJvVHdlZW5zID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdHdlZW5UaW1lID0gNTAwO1xuICB0aGlzLnR3ZWVuSW5PdmVybGF5KHR3ZWVuVGltZSk7XG4gIHJldHVybiB0aGlzLnR3ZWVuSW5CYWNrZ3JvdW5kVGludCh0d2VlblRpbWUpO1xufTtcblxuQmF0dGxlVWkucHJvdG90eXBlLnR3ZWVuSW5PdmVybGF5ID0gZnVuY3Rpb24gKHR3ZWVuVGltZSkge1xuICB2YXIgdHdlZW4gPSB0aGlzLl9nYW1lLmFkZC50d2Vlbih0aGlzLl9vdmVybGF5KTtcbiAgdHdlZW4udG8oIHthbHBoYTogMX0sIHR3ZWVuVGltZSwgUGhhc2VyLkVhc2luZy5FeHBvbmVudGlhbC5JbiwgdHJ1ZSwgMCk7XG4gIHJldHVybiB0d2Vlbjtcbn07XG5cbkJhdHRsZVVpLnByb3RvdHlwZS50d2VlbkluQmFja2dyb3VuZFRpbnQgPSBmdW5jdGlvbiAodHdlZW5UaW1lKSB7XG4gIHZhciB0d2VlbiA9IHRoaXMuX2dhbWUuYWRkLnR3ZWVuKHRoaXMuX2JhY2tncm91bmQpO1xuICB0d2Vlbi50bygge3RpbnQ6IDB4MzMzNDNhfSwgdHdlZW5UaW1lLCBQaGFzZXIuRWFzaW5nLkV4cG9uZW50aWFsLkluLCB0cnVlLCAwKTtcbiAgcmV0dXJuIHR3ZWVuO1xufTtcblxuQmF0dGxlVWkucHJvdG90eXBlLmZsaWNrZXJPdmVybGF5ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdHdlZW4gPSB0aGlzLl9nYW1lLmFkZC50d2Vlbih0aGlzLl9vdmVybGF5KTtcbiAgdmFyIHRpbWVMZWZ0ID0gNTAwOyAvLyBoYWxmIGEgc2Vjb25kIHRvdGFsXG4gIHZhciBmbGlja2VyVGltZSA9IDEwO1xuICB2YXIgbkZsaWNrZXJzID0gdGhpcy5fZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMiw0KTtcbiAgdmFyIGRlZmF1bHRUaW50ID0gdGhpcy5fb3ZlcmxheS50aW50O1xuICB2YXIgdGludENvbG9yID0gMHgzMzM1MzU7XG4gIHZhciBmaXJzdFR3ZWVuID0gdHdlZW47XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBuRmxpY2tlcnM7IGkrKykge1xuICAgIC8vIHVzZSB1cCBhbGwgcmVtYWluaW5nIHRpbWUgaWYgaXQgaXMgdGhlIGxhc3QgZmxpY2tlclxuICAgIHZhciByYW5kVGltZSA9IGkgPT0gbkZsaWNrZXJzIC0gMVxuICAgICAgPyB0aW1lTGVmdFxuICAgICAgOiB0aGlzLl9nYW1lLnJuZC5mcmFjKCkgKiB0aW1lTGVmdDtcblxuICAgIC8vIGZsaWNrZXIgaW5zdGFudGx5IGlmIGl0J3MgdGhlIGZpcnN0IGZsaWNrZXJcbiAgICB2YXIgc3BsaXRUaW1lID0gaSA9PSAwID8gMCA6IHRoaXMuX2dhbWUucm5kLmZyYWMoKSAqIHJhbmRUaW1lO1xuICAgIHR3ZWVuLnRvKCB7IHRpbnQ6IHRpbnRDb2xvciB9LCBmbGlja2VyVGltZSwgUGhhc2VyLkVhc2luZy5MaW5lYXIuSW4sIGZhbHNlLCBzcGxpdFRpbWUpO1xuXG4gICAgdmFyIG5leHRUd2VlbiA9IHRoaXMuX2dhbWUuYWRkLnR3ZWVuKHRoaXMuX292ZXJsYXkpO1xuICAgIG5leHRUd2Vlbi50byggeyB0aW50OiBkZWZhdWx0VGludCB9LCBmbGlja2VyVGltZSwgUGhhc2VyLkVhc2luZy5MaW5lYXIuSW4sIGZhbHNlLCByYW5kVGltZSAtIHNwbGl0VGltZSk7XG4gICAgdHdlZW4uY2hhaW4obmV4dFR3ZWVuKTtcblxuICAgIHR3ZWVuID0gbmV4dFR3ZWVuO1xuICAgIHRpbWVMZWZ0IC09IHJhbmRUaW1lO1xuICB9XG4gIGZpcnN0VHdlZW4uc3RhcnQoKTtcbn07XG5cbkJhdHRsZVVpLnByb3RvdHlwZS51cGRhdGVDcmVkQmFyID0gZnVuY3Rpb24gKHZhbHVlLCBpc0RhbWFnZSkge1xuICAvLyBkYW1hZ2UgaW5kaWNhdGlvblxuICBpZiAoaXNEYW1hZ2UpIHtcbiAgICB0aGlzLmZsaWNrZXJPdmVybGF5KCk7XG4gICAgdGhpcy5fZ2FtZS5zb3VuZC5wbGF5KCdtYXJibGUtaW1wYWN0Jyk7XG4gIH1cbiAgdGhpcy5jcmVkVGV4dC5kaXNwbGF5T2JqZWN0LnRleHQgPSB2YWx1ZTtcbiAgdmFyIG9yaWdpbmFsVGludCA9IHRoaXMuY3JlZFRleHQuZGlzcGxheU9iamVjdC50aW50O1xuICB2YXIgZmlyc3RUd2VlbiA9IHRoaXMuX2dhbWUuYWRkLnR3ZWVuKHRoaXMuY3JlZFRleHQuZGlzcGxheU9iamVjdCk7XG4gIGZpcnN0VHdlZW4udG8oeyB0aW50OiAweDk3MEIyNiB9LCAxMDAsIFBoYXNlci5FYXNpbmcuTGluZWFyLkluLCBmYWxzZSwgMCk7XG4gIHZhciBzZWNvbmRUd2VlbiA9IHRoaXMuX2dhbWUuYWRkLnR3ZWVuKHRoaXMuY3JlZFRleHQuZGlzcGxheU9iamVjdCk7XG4gIHNlY29uZFR3ZWVuLnRvKHsgdGludDogb3JpZ2luYWxUaW50IH0sIDUwMCwgUGhhc2VyLkVhc2luZy5MaW5lYXIuSW4sIGZhbHNlLCAwKTtcbiAgZmlyc3RUd2Vlbi5jaGFpbihzZWNvbmRUd2Vlbik7XG4gIGZpcnN0VHdlZW4uc3RhcnQoKTtcbn07XG5cbkJhdHRsZVVpLnByb3RvdHlwZS51cGRhdGVQZXJzdWFzaW9uQmFyID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnBlcnN1YWRlQmFyLnNldFBlcmNlbnQodGhpcy5fZ2FtZS5wZXJzdWFzaW9uICogMjUpO1xuICB0aGlzLl9nYW1lLnNvdW5kLnBsYXkoJ3N1Y2Nlc3MnKTtcbn07XG5cbkJhdHRsZVVpLnByb3RvdHlwZS5jYXJkc0lucHV0RW5hYmxlZCA9IGZ1bmN0aW9uIChpc0VuYWJsZWQpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBsYXllckRlY2tJY29ucy5sZW5ndGg7IGkrKykge1xuICAgIHRoaXMucGxheWVyRGVja0ljb25zW2ldLmlucHV0RW5hYmxlZCA9IGlzRW5hYmxlZDtcbiAgfVxuICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5jb21wYW5pb25JY29ucy5sZW5ndGg7IGkrKykge1xuICAgIHRoaXMuY29tcGFuaW9uSWNvbnNbaV0uaW5wdXRFbmFibGVkID0gaXNFbmFibGVkO1xuICB9XG59O1xuXG5CYXR0bGVVaS5wcm90b3R5cGUuYWRkVG9vbHRpcCA9IGZ1bmN0aW9uIChjYXJkLCBjYXJkSWR4LCB4LCB5KSB7XG4gIHZhciBwbGF5ZXJDYXJkSWNvbiA9IHRoaXMucGxheWVyRGVja0ljb25zW2NhcmRJZHhdO1xuXG4gIHZhciB0b29sdGlwID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0b29sdGlwV2lkdGggPSAyNTA7XG4gICAgdmFyIHRvb2x0aXBIZWlnaHQgPSAyMDA7XG5cbiAgICB2YXIgYm1kID0gdGhpcy5fZ2FtZS5hZGQuYml0bWFwRGF0YSh0b29sdGlwV2lkdGgsIHRvb2x0aXBIZWlnaHQpO1xuICAgIGJtZC5jdHguYmVnaW5QYXRoKCk7XG4gICAgYm1kLmN0eC5yZWN0KDAsIDAsIHRvb2x0aXBXaWR0aCwgdG9vbHRpcEhlaWdodCk7XG4gICAgYm1kLmN0eC5maWxsU3R5bGUgPSAnIzQyNGQ0Zic7XG4gICAgYm1kLmN0eC5maWxsKCk7XG5cbiAgICB0aGlzLl9nYW1lLnNsaWNrVUkuYWRkKHRoaXMudG9vbHRpcCA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICAgIHgseSwgdGhpcy5fZ2FtZS5tYWtlLnNwcml0ZSgwLCAwLCBibWQpKSk7XG4gICAgdGhpcy50b29sdGlwLmFscGhhID0gMC44O1xuXG4gICAgdmFyIG5hbWVUZXh0U3R5bGUgPSB7IGZvbnQ6ICcxNHB4IEdvdWR5IEJvb2tsZXR0ZXIgMTkxMScsIGZpbGw6ICcjNDhmMmZmJywgd29yZFdyYXA6IHRydWUsIHdvcmRXcmFwV2lkdGg6IHRvb2x0aXBXaWR0aCwgZm9udFdlaWdodDogJ2JvbGQnLCBib3VuZHNBbGlnbkg6ICdjZW50ZXInIH07XG4gICAgdmFyIG5hbWVUZXh0ID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KDAsMCxcbiAgICAgIHRoaXMuX2dhbWUubWFrZS50ZXh0KDAsMCwgY2FyZC5nZXROYW1lKCkudG9VcHBlckNhc2UoKSwgbmFtZVRleHRTdHlsZSkpO1xuICAgIHRoaXMudG9vbHRpcC5hZGQobmFtZVRleHQpO1xuICAgIC8vIGZvciBhbGlnbm1lbnQgcHVycG9zZXNcbiAgICB2YXIgbmFtZVRleHRIZWlnaHQgPSBuYW1lVGV4dC5kaXNwbGF5T2JqZWN0LmdldEJvdW5kcygpLmhlaWdodDtcbiAgICBuYW1lVGV4dC5kaXNwbGF5T2JqZWN0LnNldFRleHRCb3VuZHMoMCwwLCB0b29sdGlwV2lkdGgsIHRvb2x0aXBIZWlnaHQpO1xuXG4gICAgdmFyIGRlc2NUZXh0U3R5bGUgPSB7IGZvbnQ6ICcxNHB4IE9wZW4gU2FucycsIGZpbGw6ICcjNDhmMmZmJywgd29yZFdyYXA6IHRydWUsIHdvcmRXcmFwV2lkdGg6IHRvb2x0aXBXaWR0aCwgYWxpZ246ICdsZWZ0JyB9O1xuICAgIHZhciBkZXNjVGV4dCA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICAgIDAsIE1hdGgucm91bmQobmFtZVRleHRIZWlnaHQpLFxuICAgICAgdGhpcy5fZ2FtZS5tYWtlLnRleHQoMCwwLCBjYXJkLmdldERlc2NyaXB0aW9uKCksIGRlc2NUZXh0U3R5bGUpKTtcbiAgICB0aGlzLnRvb2x0aXAuYWRkKGRlc2NUZXh0KTtcbiAgfTtcblxuICB2YXIgZGVsZXRlVG9vbHRpcCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy50b29sdGlwKSB7XG4gICAgICB0aGlzLnRvb2x0aXAuY29udGFpbmVyLmRpc3BsYXlHcm91cC5yZW1vdmVBbGwoKTtcbiAgICB9XG4gICAgdGhpcy50b29sdGlwID0gdW5kZWZpbmVkO1xuICB9O1xuXG4gIHBsYXllckNhcmRJY29uLmV2ZW50cy5vbklucHV0RG93bi5hZGQoZGVsZXRlVG9vbHRpcCwgcGxheWVyQ2FyZEljb24pO1xuXG4gIC8vIHRvb2x0aXAgZnVuY3Rpb25zXG4gIHBsYXllckNhcmRJY29uLmV2ZW50cy5vbklucHV0T3Zlci5hZGQodG9vbHRpcCwgcGxheWVyQ2FyZEljb24pO1xuICBwbGF5ZXJDYXJkSWNvbi5ldmVudHMub25JbnB1dE91dC5hZGQoZGVsZXRlVG9vbHRpcCwgcGxheWVyQ2FyZEljb24pO1xuXG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgaXRlbXMgPSByZXF1aXJlKCcuLi8uLi9zdGF0aWMvYXNzZXRzL2l0ZW1zLmpzb24nKTtcblxuZnVuY3Rpb24gQ2FyZChnYW1lLCB4LCB5LCBhc3NldE5hbWUsIG11bHRpVXNlID0gZmFsc2UpIHtcbiAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIHgsIHksIGFzc2V0TmFtZSk7XG4gIHRoaXMuX2dhbWUgPSBnYW1lO1xuICB0aGlzLmFzc2V0TmFtZSA9IGFzc2V0TmFtZTtcbiAgdGhpcy5rZXkgPSBhc3NldE5hbWU7XG4gIHRoaXMuZGVzY3JpcHRpb24gPSAndGVzdCc7XG4gIHRoaXMubXVsdGlVc2UgPSBtdWx0aVVzZTtcbn1cblxuQ2FyZC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcbm1vZHVsZS5leHBvcnRzID0gQ2FyZC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDYXJkO1xuXG5DYXJkLnByb3RvdHlwZS5nZXROYW1lID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gaXRlbXNbdGhpcy5rZXldWyduYW1lJ107XG59O1xuXG5DYXJkLnByb3RvdHlwZS5nZXREZXNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGl0ZW1zW3RoaXMua2V5XVsnZGVzYyddO1xufTtcbiIsIi8qXG4qIENsaWNrYWJsZVxuKiA9PT09XG4qXG4qIEEgc2FtcGxlIHByZWZhYiAoZXh0ZW5kZWQgZ2FtZSBvYmplY3QgY2xhc3MpLCBkaXNwbGF5aW5nIGEgY2xpY2thYmxlIG9iamVjdCBpbiBhIHJvb20uXG4qL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBUb2FzdCA9IHJlcXVpcmUoJy4vVG9hc3QnKTtcbnZhciBpdGVtcyA9IHJlcXVpcmUoJy4uLy4uL3N0YXRpYy9hc3NldHMvaXRlbXMuanNvbicpO1xuXG5mdW5jdGlvbiBDbGlja2FibGUoZ2FtZSwgeCwgeSwgaWQsIGhlaWdodCwgd2lkdGgpIHtcbiAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIHgsIHksIGlkKTtcbiAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gIHRoaXMud2lkdGggPSB3aWR0aDtcblxuICB0aGlzLl9nYW1lID0gZ2FtZTtcbiAgdGhpcy5pZCA9IGlkO1xuICB0aGlzLm5hbWUgPSBpdGVtc1t0aGlzLmlkXVsnbmFtZSddO1xuICB0aGlzLmFuY2hvci5zZXQoMC41KTtcbiAgdGhpcy5hbHBoYSA9IDAuNTtcbiAgdGhpcy5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICB0aGlzLmlucHV0LnVzZUhhbmRDdXJzb3IgPSB0cnVlO1xuICB0aGlzLmV2ZW50cy5vbklucHV0RG93bi5hZGQoY2xpY2ssIHRoaXMpO1xuICB0aGlzLmV2ZW50cy5vbklucHV0T3Zlci5hZGQobW91c2VvdmVyLCB0aGlzKTtcbiAgdGhpcy5ldmVudHMub25JbnB1dE91dC5hZGQobW91c2VvdXQsIHRoaXMpO1xuXG4gIHRoaXMuaW5wdXQucGl4ZWxQZXJmZWN0T3ZlciA9IHRydWU7ICAgLy8gY2hlY2tzIHBpeGVscyBzbyB0aGF0IGNvbGxpc2lvbiBvbmx5IGhhcHBlbnMgd2l0aCBub24tdHJhbnNwYXJlbnQgYXJlYXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21wdXRhdGlvbmFsbHkgZXhwZW5zaXZlLCBidXQgbWF5YmUgbmVjZXNzYXJ5IGZvciByZWFsaXNtIHB1cnBvc2VzP1xufVxuXG5mdW5jdGlvbiBjbGljaygpIHtcbiAgdGhpcy5fZ2FtZS5zb3VuZC5wbGF5KCdpbnZlbnRvcnktYWRkJyk7XG4gIHRoaXMuZGVzdHJveSgpO1xuICB0aGlzLl9nYW1lLmFkZC5leGlzdGluZyhuZXcgVG9hc3QodGhpcy5fZ2FtZSwgJ1lvdVxcJ3ZlIGFjcXVpcmVkICcgKyB0aGlzLm5hbWUgKyAnIScsIDUpKTtcbiAgdGhpcy5fZ2FtZS5wbGF5ZXIuaW52ZW50b3J5LnB1c2godGhpcy5pZCk7XG4gIHZhciBpdGVtcyA9IHRoaXMuX2dhbWUucm9vbS5hcmVhLml0ZW1zO1xuICB2YXIgcmVtb3ZlX2l0ZW0gPSAtMTtcbiAgLy9iZWNhdXNlIGl0IGlzIGNoZWNraW5nIHRoZSBpZCBvZiB0aGUgaXRlbSBhbmQgbm90IHRoZSBhY3R1YWwgaXRlbVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGl0ZW1zW2ldLmlkID09PSB0aGlzLmlkKXtcbiAgICAgIHJlbW92ZV9pdGVtID0gaTtcbiAgICB9XG4gIH1cbiAgaWYgKHJlbW92ZV9pdGVtID4gLTEpIHtcbiAgICBpdGVtcy5zcGxpY2UocmVtb3ZlX2l0ZW0sIDEpO1xuICB9XG4gIHRoaXMuX2dhbWUuZGlhbG9ndWVXaW5kb3cuZGlzcGxheSh0cnVlKTsgLy8gcmVmcmVzaCBkaWFsb2d1ZSBkaXNwbGF5LCBkaXNwbGF5IGluc3RhbnRseVxuICB0aGlzLl9nYW1lLm1lbW9yeUJhbmtXaW5kb3cuZGlzcGxheSgpOyAgLy8gcmVmcmVzaCBtZW1vcnkgYmFuayBkaXNwbGF5XG59XG5cbmZ1bmN0aW9uIG1vdXNlb3ZlcigpIHtcbiAgdGhpcy5hbHBoYSA9IDE7XG4gIHRoaXMuX2dhbWUuYWRkLmV4aXN0aW5nKHRoaXMudG9hc3QgPSBuZXcgVG9hc3QodGhpcy5fZ2FtZSwgdGhpcy5uYW1lLCA1KSk7XG59XG5cbmZ1bmN0aW9uIG1vdXNlb3V0KCkge1xuICBpZiAodGhpcy50b2FzdCkge1xuICAgIHRoaXMudG9hc3QudG9hc3QuY29udGFpbmVyLmRpc3BsYXlHcm91cC5yZW1vdmVBbGwoKTtcbiAgICB0aGlzLnRvYXN0LmRlc3Ryb3koKTtcbiAgfVxufVxuXG5DbGlja2FibGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XG5tb2R1bGUuZXhwb3J0cyA9IENsaWNrYWJsZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDbGlja2FibGU7XG4iLCIvKlxuICogQ29udmVyc2F0aW9uTWFuYWdlclxuICogPT09PT09PT09PT09PT09PT09PVxuICpcbiAqIEhhbmRsZXMgbG9hZGluZyBKU09OIGFzc2V0cyBmb3IgY29udmVyc2F0aW9uIGFuZCBtYW5hZ2luZyBjb252ZXJzYXRpb24gc3RhdGVcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0gQ29udmVyc2F0aW9uTWFuYWdlcjtcblxudmFyIG5wY3MgPSByZXF1aXJlKCcuLi8uLi9zdGF0aWMvYXNzZXRzL25wY3MuanNvbicpO1xuXG5mdW5jdGlvbiBDb252ZXJzYXRpb25NYW5hZ2VyKGdhbWUsIGN1c3RvbUFjdGlvbnMvKiwgLi4uYXJncyovKSB7XG4gIC8vIFBST1BFUlRJRVM6XG4gIC8vIC0gY29udmVyc2F0aW9uIC0ganNvbiBjb252ZXJzYXRpb25cblxuICB0aGlzLl9nYW1lID0gZ2FtZTtcbiAgdGhpcy5jdXN0b21BY3Rpb25zID0gY3VzdG9tQWN0aW9ucztcblxuICB0aGlzLmNvbnZlcnNhdGlvbiA9IG51bGw7XG4gIHRoaXMuaWR4ID0gMDtcbiAgdGhpcy5zaG93biA9IFtdO1xufVxuQ29udmVyc2F0aW9uTWFuYWdlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDb252ZXJzYXRpb25NYW5hZ2VyO1xuXG4vKiBBc3N1bWVzIEpTT04gaGFzIGFscmVhZHkgYmVlbiBsb2FkZWQgaW50byBjYWNoZSFcbiAqIFVzZSBnYW1lLmxvYWQuanNvbiBvdGhlcndpc2VcbiAqL1xuQ29udmVyc2F0aW9uTWFuYWdlci5wcm90b3R5cGUubG9hZEpTT05Db252ZXJzYXRpb24gPSBmdW5jdGlvbiAoanNvbktleSkge1xuICB2YXIganNvbiA9IHRoaXMuX2dhbWUuY2FjaGUuZ2V0SlNPTihqc29uS2V5KTtcblxuICB0aGlzLmNvbnZlcnNhdGlvbiA9IGpzb247XG5cbiAgaWYgKHRoaXMuX2dhbWUuYXJlYVRyYW5zaXRpb25XaW5kb3cgIT09IG51bGwgXG4gICAgJiYgdHlwZW9mIHRoaXMuX2dhbWUuYXJlYVRyYW5zaXRpb25XaW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdGhpcy5fZ2FtZS5hcmVhVHJhbnNpdGlvbldpbmRvdy5kaXNhYmxlKCk7XG4gIH1cbiAgLy90aGUgcGxheWVyIG9iamVjdCB3aWxsIGluaXRpYWxpemUgdGhlIHN0YXJ0IGluZGV4IG9mIGEgY29udmVyc2F0aW9uXG4gIC8vIGF0IHRoZSBlbmQgb2YgYSBjb252ZXJzYXRpb24gdGhlIGluZGV4IHdpbGwgcmV0dXJuIHRvIDBcbiAgLy8gc28gdGhhdCB0aGUgbmV4dCBmaWxlIHdpbGwgc3RhcnQgYXQgdGhlIGJlZ2luaW5nLlxuXG59O1xuXG5Db252ZXJzYXRpb25NYW5hZ2VyLnByb3RvdHlwZS5nZXRDdXJyZW50VGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuY29udmVyc2F0aW9uID09PSBudWxsKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uW3RoaXMuaWR4XVsndGV4dCddO1xufTtcblxuQ29udmVyc2F0aW9uTWFuYWdlci5wcm90b3R5cGUuZ2V0UmVzcG9uc2VzID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMuY29udmVyc2F0aW9uID09PSBudWxsKSB7XG4gICAgcmV0dXJuIFsnJ107XG4gIH1cbiAgdmFyIHJlc3BvbnNlcyA9IHRoaXMuY29udmVyc2F0aW9uW3RoaXMuaWR4XVsncmVzcG9uc2VzJ107XG4gIHZhciByZXQgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZXMubGVuZ3RoOyBpKyspIHtcbiAgICAvL2NoZWNrIHNob3dPbmNlIG9mIHRhcmdldCBub2RlXG4gICAgaWYgKHRoaXMuc2hvd24uaW5kZXhPZihyZXNwb25zZXNbaV1bJ3RhcmdldCddKSA+IC0xKSB7ICAgIC8vIHRoaXMgbm9kZSBpcyBtYXJrZWQgXCJzaG93IG9uY2VcIiBhbmQgaGFzIGFscmVhZHkgYmVlbiBzaG93blxuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIC8vY2hlY2sgY29uZGl0aW9ucyBvbiByZXNwb25zZVxuICAgIGlmICgnY29uZGl0aW9ucycgaW4gcmVzcG9uc2VzW2ldKSB7XG4gICAgICB2YXIgY29uZGl0aW9uc05lZWRlZCA9IDA7XG4gICAgICB2YXIgY29uZGl0aW9uc01ldCA9IDA7XG4gICAgICBmb3IgKHZhciBjb25kaXRpb24gaW4gcmVzcG9uc2VzW2ldWydjb25kaXRpb25zJ10pIHtcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tDb25kaXRpb24odGhpcy5fZ2FtZSwgY29uZGl0aW9uLCByZXNwb25zZXNbaV1bJ2NvbmRpdGlvbnMnXVtjb25kaXRpb25dKSkge1xuICAgICAgICAgIGNvbmRpdGlvbnNNZXQrKztcbiAgICAgICAgfVxuICAgICAgICBjb25kaXRpb25zTmVlZGVkKys7XG4gICAgICB9XG4gICAgICBpZiAoY29uZGl0aW9uc01ldCA+PSBjb25kaXRpb25zTmVlZGVkKSB7XG4gICAgICAgIHJldC5wdXNoKHJlc3BvbnNlc1tpXSk7IC8vaWYgYWxsIGNvbmRpdGlvbnMgYXJlIG1ldCwgZGlzcGxheSByZXNwb25zZVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXQucHVzaChyZXNwb25zZXNbaV0pOyAgIC8vbm8gY29uZGl0aW9ucyBvbiB0aGlzIHJlc3BvbnNlLCBkaXNwbGF5IGl0XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJldDtcbn07XG5cbkNvbnZlcnNhdGlvbk1hbmFnZXIucHJvdG90eXBlLmNoZWNrQ29uZGl0aW9uID0gZnVuY3Rpb24oZ2FtZSwgY29uZGl0aW9uLCB2YWx1ZSkge1xuICBpZiAoY29uZGl0aW9uLnN0YXJ0c1dpdGgoJ3ZhcicpKSB7XG4gICAgdmFyIHZhcmlhYmxlID0gY29uZGl0aW9uLnN1YnN0cmluZygzKTtcbiAgICBpZiAodmFsdWUuc3RhcnRzV2l0aCgnIScpKSB7XG4gICAgICBpZiAoISh2YXJpYWJsZSBpbiBnYW1lLnBsYXllci52YXJpYWJsZXMpIHx8IGdhbWUucGxheWVyLnZhcmlhYmxlc1t2YXJpYWJsZV0gIT09IHZhbHVlLnN1YnN0cmluZygxKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTsgICAgLy9wbGF5ZXIgZG9lcyBub3QgaGF2ZSB0aGlzIHZhcmlhYmxlIHNldCwgb3IgaGFzIGl0IHNldCB0byBhIGRpZmZlcmVudCB2YWx1ZVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodmFyaWFibGUgaW4gZ2FtZS5wbGF5ZXIudmFyaWFibGVzICYmIGdhbWUucGxheWVyLnZhcmlhYmxlc1t2YXJpYWJsZV0gPT09IHZhbHVlKSB7XG4gICAgICByZXR1cm4gdHJ1ZTsgICAgICAvL3BsYXllciBoYXMgdGhpcyB2YXJpYWJsZSBzZXQgdG8gdGhpcyB2YWx1ZVxuICAgIH1cbiAgfSBlbHNlIGlmIChjb25kaXRpb24uc3RhcnRzV2l0aCgnaW52JykpIHtcbiAgICB2YXIgaXRlbSA9IGNvbmRpdGlvbi5zdWJzdHJpbmcoMyk7XG4gICAgaWYgKHZhbHVlLnN0YXJ0c1dpdGgoJyEnKSkge1xuICAgICAgaWYgKGdhbWUucGxheWVyLmludmVudG9yeS5pbmRleE9mKGl0ZW0pID09PSAtMSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTsgICAgLy9wbGF5ZXIgZG9lcyBub3QgaGF2ZSB0aGlzIGludmVudG9yeSBpdGVtXG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChnYW1lLnBsYXllci5pbnZlbnRvcnkuaW5kZXhPZihpdGVtKSA+IC0xKSB7XG4gICAgICByZXR1cm4gdHJ1ZTsgICAgICAvL3BsYXllciBoYXMgdGhpcyBpbnZlbnRvcnkgaXRlbVxuICAgIH1cbiAgfSBlbHNlIGlmIChjb25kaXRpb24uc3RhcnRzV2l0aCgnc2VlbicpKSB7XG4gICAgdmFyIHZpc2l0ZWQgPSB2YWx1ZS5zcGxpdCgnICcpO1xuICAgIHZhciB2aXNpdGVkQWxsID0gdHJ1ZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZpc2l0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLnNob3duLmluZGV4T2YocGFyc2VJbnQodmlzaXRlZFtpXSkpID09PSAtMSkge1xuICAgICAgICB2aXNpdGVkQWxsID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2aXNpdGVkQWxsO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbkNvbnZlcnNhdGlvbk1hbmFnZXIucHJvdG90eXBlLmdldFNwZWFrZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0aGlzLmNvbnZlcnNhdGlvbiA9PT0gbnVsbCkge1xuICAgIHJldHVybiBbJyddO1xuICB9XG5cbiAgcmV0dXJuIG5wY3NbdGhpcy5jb252ZXJzYXRpb25bdGhpcy5pZHhdWydzcGVha2VyJ11dWyduYW1lJ107XG59O1xuXG5Db252ZXJzYXRpb25NYW5hZ2VyLnByb3RvdHlwZS5nZXRBdmF0YXIgPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMuY29udmVyc2F0aW9uID09PSBudWxsKSB7XG4gICAgcmV0dXJuIFsnJ107XG4gIH1cblxuICByZXR1cm4gbnBjc1t0aGlzLmNvbnZlcnNhdGlvblt0aGlzLmlkeF1bJ3NwZWFrZXInXV1bJ2F2YXRhciddO1xufTtcblxuQ29udmVyc2F0aW9uTWFuYWdlci5wcm90b3R5cGUudGFrZUFjdGlvbnMgPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMuY29udmVyc2F0aW9uID09PSBudWxsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHRoaXMuY29udmVyc2F0aW9uW3RoaXMuaWR4XVsnc2hvd09uY2UnXSA9PT0gMSAmJiAhdGhpcy5zaG93bi5pbmNsdWRlcyh0aGlzLmlkeCkpIHtcbiAgICAvL2lmIHNhdmUgYXQgdGhpcyBwb2ludCBrZWVwcyBnZXR0aW5nIHJlc2F2ZWQuXG4gICAgdGhpcy5zaG93bi5wdXNoKHRoaXMuaWR4KTtcbiAgfVxuXG4gIGlmICh0aGlzLmNvbnZlcnNhdGlvblt0aGlzLmlkeF1bJ2FjdGlvbnMnXS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBmb3IgKHZhciBhY3Rpb24gaW4gdGhpcy5jb252ZXJzYXRpb25bdGhpcy5pZHhdWydhY3Rpb25zJ10pIHtcbiAgICB0aGlzLnRha2VBY3Rpb24odGhpcy5fZ2FtZSwgYWN0aW9uLCB0aGlzLmNvbnZlcnNhdGlvblt0aGlzLmlkeF1bJ2FjdGlvbnMnXVthY3Rpb25dKTtcbiAgfVxuICByZXR1cm47XG59O1xuXG5Db252ZXJzYXRpb25NYW5hZ2VyLnByb3RvdHlwZS50YWtlQWN0aW9uID0gZnVuY3Rpb24oZ2FtZSwgYWN0aW9uLCB2YWx1ZSkge1xuICBpZiAoYWN0aW9uLnN0YXJ0c1dpdGgoJ3ZhcicpKSB7XG4gICAgdmFyIHZhcmlhYmxlID0gYWN0aW9uLnN1YnN0cmluZygzKTtcbiAgICBpZiAodmFsdWUuc3RhcnRzV2l0aCgnIScpKSB7XG4gICAgICBkZWxldGUgZ2FtZS5wbGF5ZXIudmFyaWFibGVzW3ZhcmlhYmxlXTsgLy9yZW1vdmUgdmFyaWFibGUgZnJvbVxuICAgIH0gZWxzZSB7XG4gICAgICBnYW1lLnBsYXllci52YXJpYWJsZXNbdmFyaWFibGVdID0gdmFsdWU7ICAvL3NldCB2YXJpYWJsZSBvbiBwbGF5ZXJcbiAgICB9XG4gIH0gZWxzZSBpZiAoYWN0aW9uLnN0YXJ0c1dpdGgoJ2ludicpKSB7XG4gICAgdmFyIGl0ZW0gPSBhY3Rpb24uc3Vic3RyaW5nKDMpO1xuICAgIGlmICh2YWx1ZS5zdGFydHNXaXRoKCchJykpIHtcbiAgICAgIGlmICghKGl0ZW0gaW4gZ2FtZS5wbGF5ZXIuaW52ZW50b3J5KSkge1xuICAgICAgICB2YXIgaW5kZXggPSBnYW1lLnBsYXllci5pbnZlbnRvcnkuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICBnYW1lLnBsYXllci5pbnZlbnRvcnkuc3BsaWNlKGluZGV4LCAxKTsgLy9yZW1vdmUgaXRlbSBmcm9tIHBsYXllciBpbnZlbnRvcnlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBnYW1lLnBsYXllci5pbnZlbnRvcnkucHVzaChpdGVtKTsgLy9hZGQgaXRlbSB0byBwbGF5ZXIgaW52ZW50b3J5XG4gICAgfVxuICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gJ2N1c3RvbScpIHtcbiAgICB0aGlzLmN1c3RvbUFjdGlvbnMuY3VzdG9tQWN0aW9uKHZhbHVlKTtcbiAgfVxufTtcblxuQ29udmVyc2F0aW9uTWFuYWdlci5wcm90b3R5cGUuZW5kQ29udmVyc2F0aW9uID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLmNvbnZlcnNhdGlvbiA9PT0gbnVsbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZ2FtZS5yb29tLm5wY3MubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbnBjID0gdGhpcy5fZ2FtZS5yb29tLm5wY3NbaV07XG4gICAgbnBjLnNob3coKTtcbiAgfVxuICAgIFxuICBpZiAoJ29uRW5kJyBpbiB0aGlzLmNvbnZlcnNhdGlvbikge1xuICAgIHRoaXMuY3VzdG9tQWN0aW9ucy5jdXN0b21BY3Rpb24odGhpcy5jb252ZXJzYXRpb25bJ29uRW5kJ10pO1xuICB9XG5cbiAgdGhpcy5zaG93biA9IFtdO1xuICB0aGlzLmlkeCA9IDA7XG4gIC8vdGhpbmsgdGhpcyBpcyBhIGN5Y2xpYyByZWYuIFRPRE86IGZpeCBcbiAgdGhpcy5fZ2FtZS5kaWFsb2d1ZVdpbmRvdy5jb252b0ZpbGUgPSBudWxsO1xuICB0aGlzLl9nYW1lLmFyZWFUcmFuc2l0aW9uV2luZG93LmVuYWJsZSgpO1xufTtcblxuQ29udmVyc2F0aW9uTWFuYWdlci5wcm90b3R5cGUuYWR2YW5jZVRvVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkeCkge1xuICB0aGlzLmlkeCA9IHRhcmdldElkeDtcbiAgcmV0dXJuIHRydWU7ICAvLyByZXR1cm5zIHdoZXRoZXIgc2hvdWxkIHJlZnJlc2ggZGlzcGxheS5cbn07XG5cbkNvbnZlcnNhdGlvbk1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gVE9ETzogU3R1Yi5cbn07XG4iLCIvKlxuKiBEaWFsb2d1ZVdpbmRvd1xuKiA9PT09PT09PT09PT09PVxuKlxuKiBIYW5kbGVzIGRpc3BsYXlpbmcgZGlhbG9ndWUgKGNvbnZlcnNhdGlvbiBkYXRhKSB0byBzY3JlZW5cbiovXG5cbid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBEaWFsb2d1ZVdpbmRvdztcblxudmFyIFNjcm9sbGJhciA9IHJlcXVpcmUoJy4vU2Nyb2xsYmFyJyk7XG52YXIgdGV4dHN0eWxlcyA9IHJlcXVpcmUoJy4uLy4uL3N0YXRpYy9hc3NldHMvdGV4dHN0eWxlcy5qc29uJyk7XG5cbmZ1bmN0aW9uIERpYWxvZ3VlV2luZG93KGdhbWUsIGNvbnZvTWFuYWdlci8qLCAuLi5hcmdzKi8pIHtcbiAgUGhhc2VyLkdyb3VwLmNhbGwodGhpcywgZ2FtZS8qLCAuLi5hcmdzKi8pO1xuXG4gIC8vIFBST1BFUlRJRVNcbiAgLy8gLSBkaWFsb2dQYW5lbFxuICAvLyAtIHNwZWFrZXJUZXh0XG4gIC8vIC0gZGlhbG9nVGV4dFxuICAvLyAtIGNvbnZvTWFuYWdlciAocGFzc2VkIGluIENvbnZlcnNhdGlvbk1hbmFnZXIpXG4gIC8vIC0gZGlhbG9nV2lkdGhcbiAgLy8gLSBkaWFsb2dIZWlnaHRcbiAgLy8gLSBidXR0b25zXG5cbiAgdGhpcy5jb252b01hbmFnZXIgPSBjb252b01hbmFnZXI7XG4gIC8vIG1lc3N5LCBidXQgdXNlZnVsIGlmIHdlIG5lZWQgYSByZWZlcmVuY2UgdG8gdGhlIGdhbWVcbiAgdGhpcy5fZ2FtZSA9IGdhbWU7XG5cbiAgLyogU0lHTkFMUyAqL1xuICAvLyBwcml2YXRlXG4gIHRoaXMuX29uRGlhbG9nVGV4dEZpbmlzaGVkID0gbmV3IFBoYXNlci5TaWduYWwoKTsgLy8gd2hlbiB0aGUgY2hhci1ieS1jaGFyIGRpc3BsYXkgZmluaXNoZXNcblxuICAvLyBwcml2YXRlIG1lbWJlcnMgc3BlY2lmeWluZyBtYXJnaW4gYW5kIHBhZGRpbmdcbiAgdGhpcy5fZGlhbG9nVGV4dE9yaWdpblggPSA5NjtcbiAgdGhpcy5fZGlhbG9nVGV4dE9yaWdpblkgPSA2MDtcbiAgdGhpcy5fZGlhbG9nUGFkZGluZyA9IDMyO1xuXG4gIC8vIHNwZWFrZXIgYXZhdGFyIGRpc3BsYXlcbiAgZ2FtZS5zbGlja1VJLmFkZCh0aGlzLmF2YXRhciA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICA0MDAsIDEwMCwgZ2FtZS5tYWtlLnNwcml0ZSgwLCAwLCAnaW52aXNpYmxlJyksXG4gICAgNDAwLCA1MDApKTtcblxuICB0aGlzLmRpYWxvZ0hlaWdodCA9IGdhbWUuaGVpZ2h0ICogMyAvIDggLyogMy84IGhlaWdodCAqLyAtIHRoaXMuX2RpYWxvZ1BhZGRpbmcgLyAyO1xuICB0aGlzLmRpYWxvZ1dpZHRoID0gZ2FtZS53aWR0aCAtIHRoaXMuX2RpYWxvZ1BhZGRpbmc7XG5cbiAgLy8gZGlhbG9nIHRleHQgZGltZW5zaW9ucyAocHJpdmF0ZSlcbiAgdGhpcy5fZGlhbG9nVGV4dEhlaWdodCA9IHRoaXMuZGlhbG9nSGVpZ2h0IC0gdGhpcy5fZGlhbG9nVGV4dE9yaWdpblkgLSAxODtcbiAgdGhpcy5fZGlhbG9nVGV4dFdpZHRoID0gdGhpcy5kaWFsb2dXaWR0aCAtIDE4NTtcblxuICAvLyB3aW5kb3cgY29vcmRpbmF0ZXNcbiAgdmFyIGRpYWxvZ1ggPSB0aGlzLl9kaWFsb2dQYWRkaW5nIC8gMjtcbiAgdmFyIGRpYWxvZ1kgPSBnYW1lLmhlaWdodCAqIDUgLyA4OyAgLy8gNS84IGRvd25cblxuICBnYW1lLnNsaWNrVUkuYWRkKFxuICAgIHRoaXMuZGlhbG9nUGFuZWwgPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoXG4gICAgICBkaWFsb2dYLCBkaWFsb2dZLCBnYW1lLm1ha2Uuc3ByaXRlKDAsMCwgJ2RpYWxvZ3VlLXBhbmVsJyksXG4gICAgICB0aGlzLmRpYWxvZ1dpZHRoLCB0aGlzLmRpYWxvZ0hlaWdodCkpO1xuICB0aGlzLmRpYWxvZ1BhbmVsLmRpc3BsYXlPYmplY3Qud2lkdGggPSB0aGlzLmRpYWxvZ1dpZHRoO1xuICB0aGlzLmRpYWxvZ1BhbmVsLmRpc3BsYXlPYmplY3QuaGVpZ2h0ID0gdGhpcy5kaWFsb2dIZWlnaHQ7XG5cbiAgLy8gYWN0dWFsIHdpbmRvdyBjb250ZW50c1xuICB2YXIgc3BlYWtlclggPSB0aGlzLl9kaWFsb2dQYWRkaW5nICsgNjQ7XG4gIHZhciBzcGVha2VyWSA9IHRoaXMuX2RpYWxvZ1BhZGRpbmcgLyA0O1xuICB0aGlzLmRpYWxvZ1BhbmVsLmFkZChcbiAgICB0aGlzLnNwZWFrZXJUZXh0ID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KFxuICAgICAgTWF0aC5yb3VuZChzcGVha2VyWCksIHNwZWFrZXJZLFxuICAgICAgZ2FtZS5tYWtlLnRleHQoMCwgMCwgJ1NwZWFrZXInLCB0ZXh0c3R5bGVzWydzcGVha2VyJ10pKSk7XG5cbiAgLy8gdXNpbmcgYSBtYXNrIGZvciBzY3JvbGxpbmcgcHVycG9zZXNcbiAgdGhpcy5fc2Nyb2xsTWFzayA9IGdhbWUubWFrZS5ncmFwaGljcygwLCAwKTtcbiAgdGhpcy5fc2Nyb2xsTWFzay5iZWdpbkZpbGwoMHhmZmZmZmYpO1xuICB0aGlzLl9zY3JvbGxNYXNrLmRyYXdSZWN0KCB0aGlzLl9kaWFsb2dUZXh0T3JpZ2luWCwgdGhpcy5fZGlhbG9nVGV4dE9yaWdpblksIHRoaXMuX2RpYWxvZ1RleHRXaWR0aCwgdGhpcy5fZGlhbG9nVGV4dEhlaWdodCApO1xuICB0aGlzLl9zY3JvbGxNYXNrLmVuZEZpbGwoKTtcblxuICB2YXIgYm9keVN0eWxlID0gdGV4dHN0eWxlc1snZGlhbG9ndWVCb2R5J107XG4gIGJvZHlTdHlsZS53b3JkV3JhcFdpZHRoID0gdGhpcy5fZGlhbG9nVGV4dFdpZHRoO1xuICB0aGlzLmRpYWxvZ1BhbmVsLmFkZChcbiAgICB0aGlzLmRpYWxvZ1RleHQgPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QodGhpcy5fZGlhbG9nVGV4dE9yaWdpblgsIHRoaXMuX2RpYWxvZ1RleHRPcmlnaW5ZLFxuICAgICAgZ2FtZS5tYWtlLnRleHQoMCwgMCwgJ3BsYWNlaG9sZGVyIHRleHQnLCBib2R5U3R5bGUpKSk7XG4gIHRoaXMuZGlhbG9nVGV4dC5kaXNwbGF5T2JqZWN0LmxpbmVTcGFjaW5nID0gMDtcblxuICB0aGlzLmRpYWxvZ1BhbmVsLmFkZChuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoMCwgMCwgdGhpcy5fc2Nyb2xsTWFzaykpO1xuICB0aGlzLmRpYWxvZ1RleHQuZGlzcGxheU9iamVjdC5tYXNrID0gdGhpcy5fc2Nyb2xsTWFzaztcblxuICB0aGlzLmRpYWxvZ1BhbmVsLmFscGhhID0gMC44O1xuXG4gIC8vIGZvciByZW1vdmluZyBwbGF5ZXIgY2hvaWNlIGJ1dHRvbnNcbiAgdGhpcy5idXR0b25zID0gW107XG4gIHRoaXMuYnV0dG9uVHdlZW5zID0gW107XG4gIC8vIHNsaWRlciBmb3Igc2Nyb2xsaW5nIG92ZXJmbG93XG4gIHRoaXMuc2xpZGVyID0gbnVsbDtcbiAgLy8gc3RvcmVzIGVhY2ggYnV0dG9uIFkgdmFsdWVcbiAgLy8gYWxzbyBrZWVwcyB0cmFjayBvZiBob3cgbG93IG91ciBjb250ZW50IGdvZXM7IGxhc3QgZWxlbWVudCBpcyBjb250ZW50IGJvdHRvbVxuICB0aGlzLl9idXR0b25zWSA9IFtdO1xuXG4gIC8vZm9yIGtlZXBpbmcgdHJhY2sgb2Ygd2hldGhlciB0aGUgYXZhdGFyIG5lZWRzIHRvIGJlIHVwZGF0ZWQgKHBlcmZvcm1hbmNlIGludGVuc2l2ZSlcbiAgdGhpcy5hdmF0YXJOYW1lID0gJ2ludmlzaWJsZSc7XG5cbiAgLy8gd2lsbCB0cmFjayB0aGUgY29udmVyc2F0aW9uIGZpbGUsIHNvIHRoYXQgc2F2ZSBjaGVja3BvaW50cyB3aWxsXG4gIC8vIGdvIHRvIHRoZSBjb3JyZWN0IGFyZWEgaW4gdGhlIGNvbnZlcnNhdGlvblxuICB0aGlzLmNvbnZvRmlsZSA9IG51bGw7XG5cbiAgLy8gZm9yIHJlbmRlcmluZyBsaW5lcyBjaGFyYWN0ZXIgYnkgY2hhcmFjdGVyXG4gIHRoaXMuY2hhclRpbWVyID0gbnVsbDtcbn1cblxuRGlhbG9ndWVXaW5kb3cucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuR3JvdXAucHJvdG90eXBlKTtcbkRpYWxvZ3VlV2luZG93LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IERpYWxvZ3VlV2luZG93O1xuXG5EaWFsb2d1ZVdpbmRvdy5wcm90b3R5cGUuYmVnaW4gPSBmdW5jdGlvbihqc29uS2V5KSB7XG4gIGlmIChqc29uS2V5KSB7XG4gICAgdGhpcy5sb2FkSlNPTkNvbnZlcnNhdGlvbihqc29uS2V5KTtcbiAgICB0aGlzLnNob3coKTtcbiAgICB0aGlzLmRpc3BsYXkoKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmhpZGUoKTtcbiAgfVxufTtcblxuRGlhbG9ndWVXaW5kb3cucHJvdG90eXBlLmxvYWRKU09OQ29udmVyc2F0aW9uID0gZnVuY3Rpb24gKGpzb25LZXkpIHtcbiAgaWYgKGpzb25LZXkpIHtcbiAgICB0aGlzLmNvbnZvRmlsZSA9IGpzb25LZXk7XG4gICAgdGhpcy5jb252b01hbmFnZXIubG9hZEpTT05Db252ZXJzYXRpb24oanNvbktleSk7XG4gIH1cbn07XG5cbkRpYWxvZ3VlV2luZG93LnByb3RvdHlwZS5kaXNwbGF5ID0gZnVuY3Rpb24gKGRpc3BsYXlzSW5zdGFudCA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBieSBkZWZhdWx0LCBub3Qgc2V0IHRvIGRpc3BsYXkgdGV4dCBpbnN0YW50bHkgKi8pIHtcbiAgdGhpcy5jbGVhbldpbmRvdygpO1xuICBpZiAodGhpcy5jb252b0ZpbGUpIHtcbiAgICB0aGlzLnRha2VBY3Rpb25zKCk7XG4gICAgdGhpcy5kaXNwbGF5QXZhdGFyKCk7XG5cbiAgICAvLyBPbiBmaW5pc2hpbmcgdGhlIGRpYWxvZyB0ZXh0IGRpc3BsYXksIGRpc3BsYXkgb3VyIHJlc3BvbnNlc1xuICAgIC8vIEFkZGVkIGJlZm9yZSBvdXIgYWN0dWFsIGRpc3BsYXkgY2FsbCBpbiBjYXNlIHdlIGRpc3BsYXkgaW5zdGFudGx5XG4gICAgdGhpcy5fb25EaWFsb2dUZXh0RmluaXNoZWQuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuZGlzcGxheVJlc3BvbnNlcygpO1xuICAgICAgdGhpcy5fb25EaWFsb2dUZXh0RmluaXNoZWQucmVtb3ZlQWxsKCk7XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy5kaXNwbGF5VGV4dChkaXNwbGF5c0luc3RhbnQpO1xuICB9XG59O1xuXG5EaWFsb2d1ZVdpbmRvdy5wcm90b3R5cGUuY2xlYW5XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIHN0b3AgYWxsIGJ1dHRvbiB0d2VlbnNcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJ1dHRvblR3ZWVucy5sZW5ndGg7IGkrKykge1xuICAgIHRoaXMuYnV0dG9uVHdlZW5zW2ldLnN0b3AoKTtcbiAgfVxuXG4gIC8vIHJlbW92ZSBhbGwgYnV0dG9uc1xuICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuYnV0dG9ucy5sZW5ndGg7IGorKykge1xuICAgIHZhciBidXR0b24gPSB0aGlzLmJ1dHRvbnNbal07XG4gICAgYnV0dG9uLmNvbnRhaW5lci5kaXNwbGF5R3JvdXAucmVtb3ZlQWxsKHRydWUpO1xuICAgIGJ1dHRvbi5jb250YWluZXIuZGlzcGxheUdyb3VwLmRlc3Ryb3koKTtcbiAgICBidXR0b24uY29udGFpbmVyLmNoaWxkcmVuID0gW107XG4gICAgYnV0dG9uLmNvbnRhaW5lciA9IHVuZGVmaW5lZDtcbiAgICBidXR0b24uc3ByaXRlID0gdW5kZWZpbmVkO1xuICB9XG4gIHRoaXMuYnV0dG9ucyA9IFtdO1xuICB0aGlzLl9idXR0b25zWSA9IFtdO1xuXG4gIC8vIHJlbW92ZSBzY3JvbGxlciBhbmQgcmVzdG9yZSBkaWFsb2cgdGV4dCBwb3NpdGlvblxuICBpZiAodGhpcy5zbGlkZXIgIT09IG51bGwpIHtcbiAgICB0aGlzLnNsaWRlci5kZXN0cm95KCk7XG4gICAgdGhpcy5zbGlkZXIgPSBudWxsO1xuICB9XG4gIHRoaXMuZGlhbG9nVGV4dC55ID0gdGhpcy5fZGlhbG9nVGV4dE9yaWdpblk7XG4gIHRoaXMuZGlhbG9nVGV4dC5kaXNwbGF5T2JqZWN0LmlucHV0RW5hYmxlZCA9IGZhbHNlO1xuICB0aGlzLmRpYWxvZ1RleHQuZGlzcGxheU9iamVjdC5ldmVudHMub25JbnB1dE92ZXIucmVtb3ZlQWxsKCk7XG4gIHRoaXMuZGlhbG9nVGV4dC5kaXNwbGF5T2JqZWN0LmV2ZW50cy5vbklucHV0T3V0LnJlbW92ZUFsbCgpO1xuICB0aGlzLl9nYW1lLmlucHV0Lm1vdXNlLm1vdXNlV2hlZWxDYWxsYmFjayA9IG51bGw7XG59O1xuXG5EaWFsb2d1ZVdpbmRvdy5wcm90b3R5cGUudGFrZUFjdGlvbnMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jb252b01hbmFnZXIudGFrZUFjdGlvbnModGhpcy5fZ2FtZSk7XG59O1xuXG4vLyBpZiBhdmF0YXIgbmVlZHMgdG8gY2hhbmdlLCBmYWRlIG91dCB0aGUgY3VycmVudCBvbmUgYW5kIGZhZGUgaW4gdGhlIG5ldyBvbmVcbkRpYWxvZ3VlV2luZG93LnByb3RvdHlwZS5kaXNwbGF5QXZhdGFyID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzcGVha2VyID0gdGhpcy5jb252b01hbmFnZXIuZ2V0QXZhdGFyKCk7XG4gIHZhciBmYWRlT3V0ID0gMjAwO1xuICB2YXIgZmFkZUluID0gMjAwO1xuICBpZiAoc3BlYWtlciAhPT0gdGhpcy5hdmF0YXJOYW1lKSB7XG4gICAgdmFyIGZhZGVJblR3ZWVuID0gdGhpcy5fZ2FtZS5hZGQudHdlZW4odGhpcy5hdmF0YXIpO1xuICAgIGZhZGVJblR3ZWVuLnRvKHthbHBoYTogMH0sIGZhZGVPdXQsIFBoYXNlci5FYXNpbmcuTGluZWFyLk5vbmUsIHRydWUpO1xuICAgIGZhZGVJblR3ZWVuLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5hdmF0YXIuZGlzcGxheU9iamVjdC5sb2FkVGV4dHVyZShzcGVha2VyKTtcbiAgICAgIHRoaXMuX2dhbWUuYWRkLnR3ZWVuKHRoaXMuYXZhdGFyKS50byh7YWxwaGE6IDF9LCBmYWRlSW4sIFBoYXNlci5FYXNpbmcuTGluZWFyLk5vbmUsIHRydWUpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMuYXZhdGFyTmFtZSA9IHNwZWFrZXI7XG4gIH1cbn07XG5cbkRpYWxvZ3VlV2luZG93LnByb3RvdHlwZS5kaXNwbGF5VGV4dCA9IGZ1bmN0aW9uIChkaXNwbGF5c0luc3RhbnQpIHtcbiAgdGhpcy5zcGVha2VyVGV4dC5kaXNwbGF5T2JqZWN0LnRleHQgPSB0aGlzLmNvbnZvTWFuYWdlci5nZXRTcGVha2VyKCkudG9VcHBlckNhc2UoKTtcbiAgdGhpcy5kaWFsb2dUZXh0LmRpc3BsYXlPYmplY3QubWFzayA9IHRoaXMuX3Njcm9sbE1hc2s7XG5cbiAgaWYgKGRpc3BsYXlzSW5zdGFudCkge1xuICAgIHRoaXMuZGlhbG9nVGV4dC5kaXNwbGF5T2JqZWN0LnRleHQgPSB0aGlzLmNvbnZvTWFuYWdlci5nZXRDdXJyZW50VGV4dCgpO1xuICAgIGlmICh0aGlzLmNoYXJUaW1lciAhPSBudWxsKSB7XG4gICAgICB0aGlzLl9nYW1lLnRpbWUuZXZlbnRzLnJlbW92ZSh0aGlzLmNoYXJUaW1lcik7ICAvLyBzdG9wIGNoYXJhY3RlcnMgZnJvbSByZW5kZXJpbmcgb25lIGJ5IG9uZSwgaWYgdGhleSBhcmUgY3VycmVudGx5IHJlbmRlcmluZ1xuICAgIH1cbiAgICB0aGlzLl9vbkRpYWxvZ1RleHRGaW5pc2hlZC5kaXNwYXRjaCgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGNoYXJhY3Rlci1ieS1jaGFyYWN0ZXIgZGlzcGxheVxuICB0aGlzLmRpc3BsYXlDdXJyZW50TGluZSgpO1xuXG59O1xuXG5EaWFsb2d1ZVdpbmRvdy5wcm90b3R5cGUuZGlzcGxheVJlc3BvbnNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gc3RhcnQgcmVuZGVyaW5nIGJ1dHRvbnMgYXQgdGhlIGJvdHRvbSBvZiBkaWFsb2d1ZVxuICB2YXIgcmVzcG9uc2VzID0gdGhpcy5jb252b01hbmFnZXIuZ2V0UmVzcG9uc2VzKHRoaXMuX2dhbWUpO1xuXG4gIHZhciB0ZXh0Qm90dG9tID0gdGhpcy5fZGlhbG9nVGV4dE9yaWdpblkgKyB0aGlzLmRpYWxvZ1RleHQuZGlzcGxheU9iamVjdC5nZXRCb3VuZHMoKS5oZWlnaHQ7XG4gIHRoaXMubmV4dEJ1dHRvblkgPSB0ZXh0Qm90dG9tO1xuXG4gIGlmIChyZXNwb25zZXMubGVuZ3RoID09PSAwKSB7XG4gICAgLy8gbm8gcmVzcG9uc2VzIC0gd2FpdGluZyBvbiBwbGF5ZXIgdG8gZG8gc29tZXRoaW5nIHRvIHByb2dyZXNzXG4gICAgdmFyIHdhaXRCdXR0b24gPSB0aGlzLmFkZENob2ljZUJ1dHRvbih0aGlzLl9kaWFsb2dUZXh0T3JpZ2luWCwgdGhpcy5uZXh0QnV0dG9uWSxcbiAgICAgICdFTkQnLCBudWxsKTtcbiAgICB3YWl0QnV0dG9uLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmJ1dHRvbnMucHVzaCh3YWl0QnV0dG9uKTtcbiAgfVxuXG4gIHRoaXMuYnV0dG9uVHdlZW5zID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZXMubGVuZ3RoOyBpKyspIHtcbiAgICAvLyBwYXNzIGFsb25nIHNwZWNpYWwgcGFyYW1ldGVycywgaWYgYW55XG4gICAgdmFyIHBhcmFtcyA9IFtdO1xuICAgIGlmICgncGFyYW1zJyBpbiByZXNwb25zZXNbaV0pIHtcbiAgICAgIHBhcmFtcyA9IHJlc3BvbnNlc1tpXVsncGFyYW1zJ107XG4gICAgfVxuXG4gICAgLy8ga2VlcCB0cmFjayBvZiBidXR0b25zIHRvIGJlIGRlbGV0ZWRcbiAgICB2YXIgcmVzcG9uc2VEZWxheSA9IDI1MDtcbiAgICB2YXIgYnV0dG9uID0gdGhpcy5hZGRDaG9pY2VCdXR0b24oXG4gICAgICB0aGlzLl9kaWFsb2dUZXh0T3JpZ2luWCwgdGhpcy5uZXh0QnV0dG9uWSxcbiAgICAgIHJlc3BvbnNlc1tpXVsndGV4dCddLCByZXNwb25zZXNbaV1bJ3RhcmdldCddLCBwYXJhbXMpO1xuICAgIGJ1dHRvbi5hbHBoYSA9IDA7XG4gICAgdmFyIHR3ZWVuID0gdGhpcy5fZ2FtZS5hZGQudHdlZW4oYnV0dG9uKS50byh7YWxwaGE6IDF9LCByZXNwb25zZURlbGF5LCBQaGFzZXIuRWFzaW5nLkxpbmVhci5Ob25lLCB0cnVlLCByZXNwb25zZURlbGF5ICogaSk7XG4gICAgaWYgKGkgPT09IHJlc3BvbnNlcy5sZW5ndGggLSAxKSB7XG4gICAgICB0d2Vlbi5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5hZGRPdmVyZmxvd1Njcm9sbCgpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfVxuICAgIHRoaXMuYnV0dG9uVHdlZW5zLnB1c2godHdlZW4pOyAgLy8gZm9yIGRlbGV0aW9uIGxhdGVyXG4gICAgdGhpcy5idXR0b25zLnB1c2goYnV0dG9uKTtcbiAgICB0aGlzLl9idXR0b25zWS5wdXNoKGJ1dHRvbi55KTtcbiAgICB0aGlzLm5leHRCdXR0b25ZICs9IGJ1dHRvbi5zcHJpdGUuaGVpZ2h0O1xuICB9XG5cbiAgLy8gbGFzdCBlbGVtZW50IGlzIGJvdHRvbSBvZiBjb250ZW50XG4gIHRoaXMuX2J1dHRvbnNZLnB1c2godGhpcy5uZXh0QnV0dG9uWSk7XG59O1xuXG5EaWFsb2d1ZVdpbmRvdy5wcm90b3R5cGUuYWRkQ2hvaWNlQnV0dG9uID0gZnVuY3Rpb24gKHgsIHksIHJlc3BvbnNlVGV4dEZpZWxkLCByZXNwb25zZVRhcmdldCwgcmVzcG9uc2VQYXJhbXMgPSBbXSkge1xuICAvLyBkaXNwbGF5IHRleHRcbiAgdmFyIGJ1dHRvblNpZGVQYWRkaW5nID0gMzI7XG4gIHZhciBidXR0b25UZXh0U3R5bGUgPSB0ZXh0c3R5bGVzWydjaG9pY2VCdXR0b24nXTtcbiAgYnV0dG9uVGV4dFN0eWxlLndvcmRXcmFwV2lkdGggPSB0aGlzLl9kaWFsb2dUZXh0V2lkdGggLSBidXR0b25TaWRlUGFkZGluZztcbiAgdmFyIHJlc3BvbnNlVGV4dCA9IHRoaXMuX2dhbWUubWFrZS50ZXh0KDAsIDAsIHJlc3BvbnNlVGV4dEZpZWxkLCBidXR0b25UZXh0U3R5bGUpO1xuICB2YXIgYnV0dG9uVGV4dCA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICBNYXRoLnJvdW5kKHRoaXMuX2RpYWxvZ1RleHRXaWR0aCAvIDIgLSByZXNwb25zZVRleHQud2lkdGggLyAyKSwwLCAvKiBjZW50ZXIgdGV4dCAqL1xuICAgIHJlc3BvbnNlVGV4dCk7XG5cbiAgLy8gYWRkIHRvIHNpemVkIGJ1dHRvblxuICB2YXIgY2hvaWNlQnV0dG9uO1xuICB0aGlzLmRpYWxvZ1BhbmVsLmFkZChjaG9pY2VCdXR0b24gPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoXG4gICAgeCwgeSxcbiAgICB0aGlzLl9nYW1lLm1ha2UuYnV0dG9uKDAsMCwgJ2RpYWxvZ3VlLWNob2ljZS1idXR0b24nKSxcbiAgICB0aGlzLmRpYWxvZ1dpZHRoLCByZXNwb25zZVRleHQuaGVpZ2h0KSk7XG4gIGNob2ljZUJ1dHRvbi5hZGQoYnV0dG9uVGV4dCk7XG4gIGNob2ljZUJ1dHRvbi5zcHJpdGUud2lkdGggPSB0aGlzLl9kaWFsb2dUZXh0V2lkdGg7XG4gIGNob2ljZUJ1dHRvbi5zcHJpdGUuaGVpZ2h0ID0gcmVzcG9uc2VUZXh0LmhlaWdodDtcblxuICAvLyBlbmQgb2YgY29udmVyc2F0aW9uLiBhY3Rpb24gZGVsZXRlcyB3aW5kb3dcbiAgaWYgKHJlc3BvbnNlVGFyZ2V0IDwgMCkge1xuICAgIGNob2ljZUJ1dHRvbi5ldmVudHMub25JbnB1dFVwLmFkZChcbiAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5kaWFsb2d1ZVdpbmRvdy5oaWRlKCk7XG4gICAgICAgIHRoaXMuZGlhbG9ndWVXaW5kb3cuY29udm9NYW5hZ2VyLmVuZENvbnZlcnNhdGlvbigpOyAgLy8gdGFrZSBhbnkgYWN0aW9ucyB0aGF0IHRyaWdnZXIgd2hlbiB0aGlzIGNvbnZlcnNhdGlvbiBlbmRzXG4gICAgICB9LCB7ZGlhbG9ndWVXaW5kb3c6IHRoaXN9KTtcbiAgfVxuXG4gIGNob2ljZUJ1dHRvbi5ldmVudHMub25JbnB1dFVwLmFkZChcbiAgICBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmRpYWxvZ3VlV2luZG93Ll9nYW1lLnNvdW5kLnBsYXkoJ3RhcCcpO1xuICAgICAgdmFyIHNob3VsZFJlZnJlc2ggPSB0aGlzLmRpYWxvZ3VlV2luZG93LmNvbnZvTWFuYWdlci5hZHZhbmNlVG9UYXJnZXQoXG4gICAgICAgIHRoaXMucmVzcG9uc2VUYXJnZXQsIHRoaXMucmVzcG9uc2VQYXJhbXMpO1xuICAgICAgaWYgKHNob3VsZFJlZnJlc2gpXG4gICAgICAgIHRoaXMuZGlhbG9ndWVXaW5kb3cuZGlzcGxheSgpO1xuICAgIH0sIHtkaWFsb2d1ZVdpbmRvdzogdGhpcywgcmVzcG9uc2VUYXJnZXQ6IHJlc3BvbnNlVGFyZ2V0LCByZXNwb25zZVBhcmFtczogcmVzcG9uc2VQYXJhbXN9KTtcbiAgLy8gYWRkIG1hc2tcbiAgY2hvaWNlQnV0dG9uLnNwcml0ZS5tYXNrID0gdGhpcy5fc2Nyb2xsTWFzaztcbiAgYnV0dG9uVGV4dC5kaXNwbGF5T2JqZWN0Lm1hc2sgPSB0aGlzLl9zY3JvbGxNYXNrO1xuXG4gIHJldHVybiBjaG9pY2VCdXR0b247XG59O1xuXG5EaWFsb2d1ZVdpbmRvdy5wcm90b3R5cGUuYWRkT3ZlcmZsb3dTY3JvbGwgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIGNhbiB3ZSBmaXQgZXZlcnl0aGluZyBpbiB0aGUgY3VycmVudCB3aW5kb3c/XG4gIHZhciBoZWlnaHREaWZmID0gdGhpcy5fYnV0dG9uc1lbdGhpcy5fYnV0dG9uc1kubGVuZ3RoIC0gMV1cbiAgICAtICh0aGlzLl9kaWFsb2dUZXh0T3JpZ2luWSArIHRoaXMuX2RpYWxvZ1RleHRIZWlnaHQpO1xuICAvLyBhZGQgYSBzbGlkZXIgb3RoZXJ3aXNlXG4gIGlmIChoZWlnaHREaWZmID4gMCkge1xuXG4gICAgdmFyIHNjcm9sbGxpbmVXaWR0aCA9IDEuNTtcbiAgICB0aGlzLnNsaWRlciA9IG5ldyBTY3JvbGxiYXIoXG4gICAgICB0aGlzLl9nYW1lLFxuICAgICAgdGhpcy5fZGlhbG9nVGV4dE9yaWdpblggKyB0aGlzLl9kaWFsb2dUZXh0V2lkdGggKyB0aGlzLl9kaWFsb2dQYWRkaW5nIC0gc2Nyb2xsbGluZVdpZHRoLFxuICAgICAgdGhpcy5fZGlhbG9nVGV4dE9yaWdpblkgLSBzY3JvbGxsaW5lV2lkdGgsXG4gICAgICB0aGlzLmRpYWxvZ1BhbmVsLCAvLyBwYXJlbnRcbiAgICAgIHtcbiAgICAgICAgJ3gnOiBbMCwgdGhpcy5fZGlhbG9nUGFkZGluZywgMF0sXG4gICAgICAgICd5JzogWzAsIHRoaXMuX2RpYWxvZ1RleHRIZWlnaHQgLyAyLCB0aGlzLl9kaWFsb2dUZXh0SGVpZ2h0XVxuICAgICAgfSxcbiAgICAgIGhlaWdodERpZmYsIHNjcm9sbGxpbmVXaWR0aCk7XG5cbiAgICB2YXIgc2Nyb2xsQ2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIC8vIG1hcHBpbmcgaGVpZ2h0IGRpZmZlcmVuY2VzIHRvIHNjcm9sbCB2YWx1ZXNcbiAgICAgIHZhciBzY3JvbGxWYWx1ZSA9IGhlaWdodERpZmYqdmFsdWU7XG4gICAgICB0aGlzLmRpYWxvZ1RleHQueSA9IHRoaXMuX2RpYWxvZ1RleHRPcmlnaW5ZIC0gc2Nyb2xsVmFsdWU7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAvLyBzbGlkZSBhbGwgYnV0dG9ucyB1cFxuICAgICAgICB0aGlzLmJ1dHRvbnNbaV0ueSA9IHRoaXMuZGlhbG9nUGFuZWwueSArIHRoaXMuX2J1dHRvbnNZW2ldIC0gc2Nyb2xsVmFsdWU7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuc2xpZGVyLm9uRHJhZy5hZGQoc2Nyb2xsQ2FsbGJhY2ssIHRoaXMpO1xuICAgIHRoaXMuc2xpZGVyLm9uU2V0VmFsdWUuYWRkKHNjcm9sbENhbGxiYWNrLCB0aGlzKTtcblxuICAgIC8vIE1vdXNlIHdoZWVsIGV2ZW50c1xuICAgIHRoaXMuZGlhbG9nVGV4dC5kaXNwbGF5T2JqZWN0LmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgdGhpcy5kaWFsb2dUZXh0LmRpc3BsYXlPYmplY3QuZXZlbnRzLm9uSW5wdXRPdmVyLmFkZChcbiAgICAgIGZ1bmN0aW9uICgpIHsgdGhpcy5fZGlhbG9nT3ZlciA9IHRydWU7IH0sIHRoaXMpO1xuICAgIHRoaXMuZGlhbG9nVGV4dC5kaXNwbGF5T2JqZWN0LmV2ZW50cy5vbklucHV0T3V0LmFkZChcbiAgICAgIGZ1bmN0aW9uICgpIHsgdGhpcy5fZGlhbG9nT3ZlciA9IGZhbHNlOyB9LCB0aGlzKTtcbiAgICB0aGlzLl9nYW1lLmlucHV0Lm1vdXNlLm1vdXNlV2hlZWxDYWxsYmFjayA9IChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGlmICghdGhpcy5fZGlhbG9nT3ZlcilcbiAgICAgICAgcmV0dXJuO1xuICAgICAgdGhpcy5zbGlkZXIudmFsdWUgKz0gKDEvaGVpZ2h0RGlmZikgKiBldmVudC5kZWx0YVk7XG4gICAgfSkuYmluZCh0aGlzKTtcbiAgfVxufTtcblxuRGlhbG9ndWVXaW5kb3cucHJvdG90eXBlLnNob3dBdmF0YXIgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGZhZGVJblR3ZWVuID0gdGhpcy5fZ2FtZS5hZGQudHdlZW4odGhpcy5hdmF0YXIpO1xuICB2YXIgZmFkZUluID0gMjAwO1xuICBmYWRlSW5Ud2Vlbi50byh7YWxwaGE6IDF9LCBmYWRlSW4sIFBoYXNlci5FYXNpbmcuTGluZWFyLk5vbmUsIHRydWUpO1xufTtcblxuRGlhbG9ndWVXaW5kb3cucHJvdG90eXBlLmhpZGVBdmF0YXIgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGZhZGVPdXRUd2VlbiA9IHRoaXMuX2dhbWUuYWRkLnR3ZWVuKHRoaXMuYXZhdGFyKTtcbiAgdmFyIGZhZGVPdXQgPSAyMDA7XG4gIGZhZGVPdXRUd2Vlbi50byh7YWxwaGE6IDB9LCBmYWRlT3V0LCBQaGFzZXIuRWFzaW5nLkxpbmVhci5Ob25lLCB0cnVlKTtcbn07XG5cbkRpYWxvZ3VlV2luZG93LnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZGlhbG9nUGFuZWwudmlzaWJsZSA9IHRydWU7XG4gIHRoaXMuc2hvd0F2YXRhcigpO1xufTtcblxuRGlhbG9ndWVXaW5kb3cucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuY2xlYW5XaW5kb3coKTtcbiAgdGhpcy5kaWFsb2dQYW5lbC52aXNpYmxlID0gZmFsc2U7XG4gIHRoaXMuaGlkZUF2YXRhcigpOyAvL2hpZGUgYXZhdGFyXG59O1xuXG5EaWFsb2d1ZVdpbmRvdy5wcm90b3R5cGUuZGlzcGxheUN1cnJlbnRMaW5lID0gZnVuY3Rpb24gKCkge1xuXG4gIHZhciBsaW5lID0gdGhpcy5jb252b01hbmFnZXIuZ2V0Q3VycmVudFRleHQoKTtcbiAgdGhpcy5kaWFsb2dUZXh0LmRpc3BsYXlPYmplY3QudGV4dCA9ICcnO1xuXG4gIC8vICBTcGxpdCB0aGUgY3VycmVudCBsaW5lIG9uIGNoYXJhY3RlcnMsIHNvIG9uZSBjaGFyIHBlciBhcnJheSBlbGVtZW50XG4gIHZhciBzcGxpdCA9IGxpbmUuc3BsaXQoJycpO1xuXG4gIC8vICBSZXNldCB0aGUgd29yZCBpbmRleCB0byB6ZXJvICh0aGUgZmlyc3Qgd29yZCBpbiB0aGUgbGluZSlcbiAgdGhpcy5fY0luZGV4ID0gMDtcblxuICAvLyBBZGQgYW4gb3B0aW9uIHRvIHNraXAgdGhlIHRleHQgb24gY2xpY2tpbmcgZG93bi5cbiAgdGhpcy5kaWFsb2dQYW5lbC5kaXNwbGF5T2JqZWN0LmlucHV0RW5hYmxlZCA9IHRydWU7XG4gIHRoaXMuZGlhbG9nUGFuZWwuZXZlbnRzLm9uSW5wdXREb3duLmFkZCh0aGlzLnNraXBUZXh0LCB0aGlzKTtcblxuICB2YXIgbmV4dENoYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gVE9ETzogbWFrZSB0aGlzIGEgc2VsZWN0YWJsZSBvcHRpb25cbiAgICB2YXIgZGVsYXkgPSAzO1xuICAgIFxuICAgIHRoaXMuZGlhbG9nVGV4dC5kaXNwbGF5T2JqZWN0LnRleHQgPVxuICAgICAgdGhpcy5kaWFsb2dUZXh0LmRpc3BsYXlPYmplY3QudGV4dC5jb25jYXQoc3BsaXRbdGhpcy5fY0luZGV4XSk7XG4gICAgaWYgKHNwbGl0W3RoaXMuX2NJbmRleF0gPT09ICcsJykge1xuICAgICAgZGVsYXkgPSAyMDA7ICAgIC8vIGJyaWVmIHBhdXNlIG9uIGNvbW1hc1xuICAgIH0gZWxzZSBpZiAoWycuJywgJz8nLCAnISddLmluZGV4T2Yoc3BsaXRbdGhpcy5fY0luZGV4XSkgPiAtMSkge1xuICAgICAgZGVsYXkgPSAzMDA7ICAgIC8vIGxvbmdlciBwYXVzZSBhZnRlciBlYWNoIHNlbnRlbmNlXG4gICAgfVxuICAgIHRoaXMuX2NJbmRleCsrO1xuICAgIGlmICh0aGlzLl9jSW5kZXggPT0gc3BsaXQubGVuZ3RoKSB7XG4gICAgICAvLyBUZWxsIHRoZSB3aW5kb3cgd2hlbiB3ZSdyZSBkb25lXG4gICAgICB0aGlzLl9vbkRpYWxvZ1RleHRGaW5pc2hlZC5kaXNwYXRjaCgpO1xuICAgICAgdGhpcy5jaGFyVGltZXIgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBZGQgdGhlIG5leHQgZXZlbnQgaW4gdGhlIGNoYWluXG4gICAgICB0aGlzLmNoYXJUaW1lciA9IHRoaXMuX2dhbWUudGltZS5ldmVudHMuYWRkKGRlbGF5LCBuZXh0Q2hhciwgdGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIC8vICBDYWxsIHRoZSAnbmV4dENoYXInIGZ1bmN0aW9uIGFuZCBjaGFpbiB1bnRpbCBpdCByZWFjaGVzIHRoZSBlbmQgb2YgdGhlIGxpbmVcbiAgdGhpcy5jaGFyVGltZXIgPSB0aGlzLl9nYW1lLnRpbWUuZXZlbnRzLmFkZCgwLCBuZXh0Q2hhciwgdGhpcyk7XG5cbn07XG5cbkRpYWxvZ3VlV2luZG93LnByb3RvdHlwZS5za2lwVGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5fZ2FtZS50aW1lLnJlbW92ZUFsbCgpO1xuICB0aGlzLmRpc3BsYXlUZXh0KHRydWUpO1xuICB0aGlzLmRpYWxvZ1BhbmVsLmV2ZW50cy5vbklucHV0RG93bi5yZW1vdmVBbGwoKTtcbn07XG5cbkRpYWxvZ3VlV2luZG93LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIFRPRE86IFN0dWIuXG59O1xuIiwiLyoqXG5Db3B5cmlnaHQgKGMpIDIwMTUgQmVsYWhjZW4gTWFyd2FuZSAoYi5tYXJ3YW5lQGdtYWlsLmNvbSlcblxuUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxub2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xudG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG5mdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG5UaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcbmNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG5cblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbklNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG5BVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG5MSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcblNPRlRXQVJFLlxuKi9cblxudmFyIEhlYWx0aEJhciA9IGZ1bmN0aW9uKGdhbWUsIHByb3ZpZGVkQ29uZmlnKSB7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG5cbiAgdGhpcy5zZXR1cENvbmZpZ3VyYXRpb24ocHJvdmlkZWRDb25maWcpO1xuICB0aGlzLnNldFBvc2l0aW9uKHRoaXMuY29uZmlnLngsIHRoaXMuY29uZmlnLnkpO1xuICB0aGlzLmRyYXdCYWNrZ3JvdW5kKCk7XG4gIHRoaXMuZHJhd0hlYWx0aEJhcigpO1xuICB0aGlzLnNldEZpeGVkVG9DYW1lcmEodGhpcy5jb25maWcuaXNGaXhlZFRvQ2FtZXJhKTtcbn07XG5IZWFsdGhCYXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSGVhbHRoQmFyO1xuXG5IZWFsdGhCYXIucHJvdG90eXBlLnNldHVwQ29uZmlndXJhdGlvbiA9IGZ1bmN0aW9uIChwcm92aWRlZENvbmZpZykge1xuICB0aGlzLmNvbmZpZyA9IHRoaXMubWVyZ2VXaXRoRGVmYXVsdENvbmZpZ3VyYXRpb24ocHJvdmlkZWRDb25maWcpO1xuICB0aGlzLmZsaXBwZWQgPSB0aGlzLmNvbmZpZy5mbGlwcGVkO1xufTtcblxuSGVhbHRoQmFyLnByb3RvdHlwZS5tZXJnZVdpdGhEZWZhdWx0Q29uZmlndXJhdGlvbiA9IGZ1bmN0aW9uKG5ld0NvbmZpZykge1xuICB2YXIgZGVmYXVsdENvbmZpZz0ge1xuICAgIHdpZHRoOiAyNTAsXG4gICAgaGVpZ2h0OiA0MCxcbiAgICB4OiAwLFxuICAgIHk6IDAsXG4gICAgYmc6IHtcbiAgICAgIGNvbG9yOiAnIzgwODA4MCdcbiAgICB9LFxuICAgIGJhcjoge1xuICAgICAgY29sb3I6ICcjNjUxODI4J1xuICAgIH0sXG4gICAgYW5pbWF0aW9uRHVyYXRpb246IDIwMCxcbiAgICBmbGlwcGVkOiBmYWxzZSxcbiAgICBpc0ZpeGVkVG9DYW1lcmE6IGZhbHNlXG4gIH07XG4gICAgXG4gIGlmKG5ld0NvbmZpZy5mbGlwcGVkKSB7XG4gICAgZGVmYXVsdENvbmZpZy5iZy5jb2xvciA9ICcjNjUxODI4JztcbiAgICBkZWZhdWx0Q29uZmlnLmJhci5jb2xvciA9ICcjODA4MDgwJztcbiAgfVxuICAgIFxuICByZXR1cm4gbWVyZ2VPYmplY3RzKGRlZmF1bHRDb25maWcsIG5ld0NvbmZpZyk7XG59O1xuXG5mdW5jdGlvbiBtZXJnZU9iamVjdHModGFyZ2V0T2JqLCBuZXdPYmopIHtcbiAgZm9yICh2YXIgcCBpbiBuZXdPYmopIHtcbiAgICB0cnkge1xuICAgICAgdGFyZ2V0T2JqW3BdID0gbmV3T2JqW3BdLmNvbnN0cnVjdG9yPT1PYmplY3QgPyBtZXJnZU9iamVjdHModGFyZ2V0T2JqW3BdLCBuZXdPYmpbcF0pIDogbmV3T2JqW3BdO1xuICAgIH0gY2F0Y2goZSkge1xuICAgICAgdGFyZ2V0T2JqW3BdID0gbmV3T2JqW3BdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdGFyZ2V0T2JqO1xufVxuXG5IZWFsdGhCYXIucHJvdG90eXBlLmRyYXdCYWNrZ3JvdW5kID0gZnVuY3Rpb24oKSB7XG5cbiAgdmFyIGJtZCA9IHRoaXMuZ2FtZS5hZGQuYml0bWFwRGF0YSh0aGlzLmNvbmZpZy53aWR0aCwgdGhpcy5jb25maWcuaGVpZ2h0KTtcbiAgYm1kLmN0eC5maWxsU3R5bGUgPSB0aGlzLmNvbmZpZy5iZy5jb2xvcjtcbiAgYm1kLmN0eC5iZWdpblBhdGgoKTtcbiAgYm1kLmN0eC5yZWN0KDAsIDAsIHRoaXMuY29uZmlnLndpZHRoLCB0aGlzLmNvbmZpZy5oZWlnaHQpO1xuICBibWQuY3R4LmZpbGwoKTtcblxuICB0aGlzLmJnU3ByaXRlID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUodGhpcy54LCB0aGlzLnksIGJtZCk7XG4gIHRoaXMuYmdTcHJpdGUuYW5jaG9yLnNldCgwLjUpO1xuXG4gIGlmKHRoaXMuZmxpcHBlZCl7XG4gICAgdGhpcy5iZ1Nwcml0ZS5zY2FsZS54ID0gLTE7XG4gIH1cbn07XG5cbkhlYWx0aEJhci5wcm90b3R5cGUuZHJhd0hlYWx0aEJhciA9IGZ1bmN0aW9uKCkge1xuICB2YXIgYm1kID0gdGhpcy5nYW1lLmFkZC5iaXRtYXBEYXRhKHRoaXMuY29uZmlnLndpZHRoLCB0aGlzLmNvbmZpZy5oZWlnaHQpO1xuICBibWQuY3R4LmZpbGxTdHlsZSA9IHRoaXMuY29uZmlnLmJhci5jb2xvcjtcbiAgYm1kLmN0eC5iZWdpblBhdGgoKTtcbiAgYm1kLmN0eC5yZWN0KDAsIDAsIHRoaXMuY29uZmlnLndpZHRoLCB0aGlzLmNvbmZpZy5oZWlnaHQpO1xuICBibWQuY3R4LmZpbGwoKTtcblxuICB0aGlzLmJhclNwcml0ZSA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHRoaXMueCAtIHRoaXMuYmdTcHJpdGUud2lkdGgvMiwgdGhpcy55LCBibWQpO1xuICB0aGlzLmJhclNwcml0ZS5hbmNob3IueSA9IDAuNTtcblxuICBpZih0aGlzLmZsaXBwZWQpe1xuICAgIHRoaXMuYmFyU3ByaXRlLnNjYWxlLnggPSAtMTtcbiAgfVxufTtcblxuSGVhbHRoQmFyLnByb3RvdHlwZS5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gIHRoaXMueCA9IHg7XG4gIHRoaXMueSA9IHk7XG5cbiAgaWYodGhpcy5iZ1Nwcml0ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuYmFyU3ByaXRlICE9PSB1bmRlZmluZWQpe1xuICAgIHRoaXMuYmdTcHJpdGUucG9zaXRpb24ueCA9IHg7XG4gICAgdGhpcy5iZ1Nwcml0ZS5wb3NpdGlvbi55ID0geTtcblxuICAgIHRoaXMuYmFyU3ByaXRlLnBvc2l0aW9uLnggPSB4IC0gdGhpcy5jb25maWcud2lkdGgvMjtcbiAgICB0aGlzLmJhclNwcml0ZS5wb3NpdGlvbi55ID0geTtcbiAgfVxufTtcblxuXG5IZWFsdGhCYXIucHJvdG90eXBlLnNldFBlcmNlbnQgPSBmdW5jdGlvbihuZXdWYWx1ZSl7XG4gIGlmIChuZXdWYWx1ZSA8IDApIG5ld1ZhbHVlID0gMDtcbiAgaWYgKG5ld1ZhbHVlID4gMTAwKSBuZXdWYWx1ZSA9IDEwMDtcblxuICB2YXIgbmV3V2lkdGggPSAobmV3VmFsdWUgKiB0aGlzLmNvbmZpZy53aWR0aCkgLyAxMDA7XG5cbiAgdGhpcy5zZXRXaWR0aChuZXdXaWR0aCk7XG59O1xuXG5IZWFsdGhCYXIucHJvdG90eXBlLnNldFdpZHRoID0gZnVuY3Rpb24obmV3V2lkdGgpe1xuICBpZiAodGhpcy5mbGlwcGVkKSB7XG4gICAgbmV3V2lkdGggPSAtMSAqIG5ld1dpZHRoO1xuICB9XG4gIHRoaXMuZ2FtZS5hZGQudHdlZW4odGhpcy5iYXJTcHJpdGUpLnRvKCB7IHdpZHRoOiBuZXdXaWR0aCB9LCB0aGlzLmNvbmZpZy5hbmltYXRpb25EdXJhdGlvbiwgUGhhc2VyLkVhc2luZy5MaW5lYXIuTm9uZSwgdHJ1ZSk7XG59O1xuXG5IZWFsdGhCYXIucHJvdG90eXBlLnNldEZpeGVkVG9DYW1lcmEgPSBmdW5jdGlvbihmaXhlZFRvQ2FtZXJhKSB7XG4gIHRoaXMuYmdTcHJpdGUuZml4ZWRUb0NhbWVyYSA9IGZpeGVkVG9DYW1lcmE7XG4gIHRoaXMuYmFyU3ByaXRlLmZpeGVkVG9DYW1lcmEgPSBmaXhlZFRvQ2FtZXJhO1xufTtcblxuSGVhbHRoQmFyLnByb3RvdHlwZS5raWxsID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuYmdTcHJpdGUua2lsbCgpO1xuICB0aGlzLmJhclNwcml0ZS5raWxsKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEhlYWx0aEJhcjtcbiIsIi8qXG4gKiBJY29uXG4gKiA9PT09XG4gKlxuICogSWNvbiBiYXNlIGNsYXNzIChtYXNrZWQgc3ByaXRlIGdyb3VwKVxuICovXG5cbid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBJY29uO1xuXG5mdW5jdGlvbiBJY29uKGdhbWUsIHgsIHksIGFzc2V0LCBtYXNrLCBib3JkZXIsIHdpZHRoID0gMTAwLjAvKiwgVE9ETzogaGVpZ2h0ID0gMTAwLjAgLi4uYXJncyovKSB7XG4gIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCBhc3NldC8qLCAuLi5hcmdzKi8pO1xuXG4gIC8vIFBST1BFUlRJRVNcbiAgLy8gLSBtYXNrU3ByaXRlXG4gIHRoaXMubWFza1Nwcml0ZTtcbiAgLy8gLSBib3JkZXJTcHJpdGVcbiAgdGhpcy5ib3JkZXJTcHJpdGU7XG4gIC8vIC0gYXNzZXQga2V5XG4gIHRoaXMuaWQgPSBhc3NldDtcblxuICB0aGlzLl9nYW1lID0gZ2FtZTtcbiAgLy8gZXhwYW5kcyBib3JkZXJzIG9mIG1hc2sgc2xpZ2h0bHlcbiAgdmFyIHNjYWxlUmVsYXggPSAxLjA1O1xuXG4gIGlmICh0eXBlb2YgbWFzayAhPT0gJ3VuZGVmaW5lZCcgJiYgbWFzayAhPT0gbnVsbCkge1xuICAgIHRoaXMubWFza1Nwcml0ZSA9IGdhbWUubWFrZS5zcHJpdGUoeCx5LCBtYXNrKTtcblxuICAgIHRoaXMubWFza1Nwcml0ZS5zY2FsZS5zZXRUbyh0aGlzLndpZHRoKnNjYWxlUmVsYXggLyB0aGlzLm1hc2tTcHJpdGUud2lkdGgpO1xuXG4gICAgdmFyIG1hc2tlZEJtZCA9IGdhbWUubWFrZS5iaXRtYXBEYXRhKHRoaXMubWFza1Nwcml0ZS53aWR0aCwgdGhpcy5tYXNrU3ByaXRlLmhlaWdodCk7XG4gICAgbWFza2VkQm1kLmFscGhhTWFzayh0aGlzLCB0aGlzLm1hc2tTcHJpdGUpO1xuICAgIC8vIHJlcGxhY2UgbWFpbiBzcHJpdGUgd2l0aCBiaXRtYXAgZGF0YSBtYXNrXG4gICAgdGhpcy5sb2FkVGV4dHVyZShtYXNrZWRCbWQpO1xuICB9XG5cbiAgdGhpcy5zY2FsZS5zZXRUbyh3aWR0aCAvIHRoaXMud2lkdGgpO1xuICB2YXIgcGFyZW50U2NhbGUgPSB0aGlzLnNjYWxlLng7XG5cbiAgaWYgKHR5cGVvZiBib3JkZXIgIT09ICd1bmRlZmluZWQnICYmIGJvcmRlciAhPT0gbnVsbCkge1xuICAgIHRoaXMuYm9yZGVyU3ByaXRlID0gZ2FtZS5tYWtlLnNwcml0ZSgwLDAsIGJvcmRlcik7XG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLmJvcmRlclNwcml0ZSk7XG4gICAgdGhpcy5ib3JkZXJTcHJpdGUuc2NhbGUuc2V0VG8oKHdpZHRoIC8gdGhpcy5ib3JkZXJTcHJpdGUud2lkdGgpIC8gcGFyZW50U2NhbGUpO1xuICB9XG5cbn1cblxuSWNvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcbkljb24ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSWNvbjtcblxuSWNvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICB2YXIgaSA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoO1xuICB3aGlsZSAoaS0tKSB7XG4gICAgdGhpcy5nZXRDaGlsZEF0KGkpLnVwZGF0ZSgpO1xuICB9XG59O1xuIiwiLypcbiAqIE1lbW9yeUJhbmtXaW5kb3dcbiAqID09PT09PT09PT09PT09PVxuICpcbiAqIFVJIHdpbmRvdyBmb3IgdGhlIG1lbW9yeSBiYW5rXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgaXRlbXMgPSByZXF1aXJlKCcuLi8uLi9zdGF0aWMvYXNzZXRzL2l0ZW1zLmpzb24nKTtcbnZhciBJY29uID0gcmVxdWlyZSgnLi9JY29uJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gTWVtb3J5QmFua1dpbmRvdztcblxuZnVuY3Rpb24gbWVtb3J5QmFua0J1dHRvblRvZ2dsZSgpIHtcbiAgLy8gdW5yZXNwb25zaXZlIHdoaWxlIGFuaW1hdGluZ1xuICBpZiAodGhpcy5faXNUd2VlbmluZylcbiAgICByZXR1cm47XG5cbiAgdGhpcy5faXNUd2VlbmluZyA9IHRydWU7XG4gIHZhciB0aW1lVG9Ud2VlbiA9IDUwMDsgIC8vIG1pbGxpc2Vjb25kc1xuXG4gIC8vIGhpZGUgcGFuZWxcbiAgaWYgKHRoaXMucGFuZWwudmlzaWJsZSkge1xuICAgIHRoaXMuX2dhbWUuc291bmQucGxheSgnc3dpc2gtY2xvc2UnKTtcbiAgICB0aGlzLl9nYW1lLmFkZC50d2Vlbih0aGlzLnBhbmVsKS50byhcbiAgICAgICAge3g6IHRoaXMuX2Jhc2VYICsgdGhpcy5wYW5lbFdpZHRoICsgdGhpcy5fbWVtb3J5UGFkZGluZ30sIHRpbWVUb1R3ZWVuLCBQaGFzZXIuRWFzaW5nLkV4cG9uZW50aWFsLk91dCwgdHJ1ZVxuICAgICAgKS5vbkNvbXBsZXRlLmFkZChcbiAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRoaXMucGFuZWwudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuX2lzVHdlZW5pbmcgPSBmYWxzZTtcbiAgICAgICAgfSwgdGhpc1xuICAgICAgKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBzaG93IHBhbmVsXG5cbiAgLy8gaWYgYXJlYSB0cmFuc2l0aW9uIHdpbmRvdyBpcyBvcGVuLCBjbG9zZSBpdFxuICBpZiAodGhpcy5fZ2FtZS5hcmVhVHJhbnNpdGlvbldpbmRvdy5wYW5lbC52aXNpYmxlKSB7XG4gICAgdGhpcy5fZ2FtZS5hcmVhVHJhbnNpdGlvbldpbmRvdy5wYW5lbC52aXNpYmxlID0gZmFsc2U7XG4gIH1cbiAgdGhpcy5wYW5lbC52aXNpYmxlID0gdHJ1ZTtcbiAgdGhpcy5kaXNwbGF5KCk7XG5cbiAgdGhpcy5wYW5lbC54ID0gdGhpcy5fYmFzZVggKyB0aGlzLnBhbmVsV2lkdGggKyB0aGlzLl9tZW1vcnlQYWRkaW5nO1xuICB0aGlzLl9nYW1lLnNvdW5kLnBsYXkoJ3N3aXNoLW9wZW4nKTtcbiAgdGhpcy5fZ2FtZS5hZGQudHdlZW4odGhpcy5wYW5lbCkudG8oXG4gICAgICB7eDogdGhpcy5fYmFzZVh9LCB0aW1lVG9Ud2VlbiwgUGhhc2VyLkVhc2luZy5FeHBvbmVudGlhbC5PdXQsIHRydWVcbiAgICApLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHsgdGhpcy5faXNUd2VlbmluZyA9IGZhbHNlOyB9LCB0aGlzKTtcbn1cblxuZnVuY3Rpb24gTWVtb3J5QmFua1dpbmRvdyhnYW1lLyosIC4uLmFyZ3MqLykge1xuICBQaGFzZXIuR3JvdXAuY2FsbCh0aGlzLCBnYW1lLyosIC4uLmFyZ3MqLyk7XG5cbiAgdGhpcy5fZ2FtZSA9IGdhbWU7XG5cbiAgLy8gcHJpdmF0ZSBtZW1iZXJzIHNwZWNpZnlpbmcgbWFyZ2luIGFuZCBwYWRkaW5nXG4gIHRoaXMuX21lbW9yeVRleHRPcmlnaW5YID0gMTAwO1xuICB0aGlzLl9tZW1vcnlUZXh0T3JpZ2luWSA9IDE1NTtcbiAgdGhpcy5fbWVtb3J5UGFkZGluZyA9IDMyO1xuICB0aGlzLl9pdGVtT3JpZ2luWCA9IDgwO1xuICB0aGlzLl9pdGVtT3JpZ2luWSA9IDI1O1xuICB0aGlzLl9iYXNlWCA9IHRoaXMuX21lbW9yeVBhZGRpbmcgLyAyO1xuICB0aGlzLl9iYXNlWSA9IHRoaXMuX21lbW9yeVBhZGRpbmcgKiAyO1xuXG4gIC8vIG1lbW9yeSBiYW5rIHdpbmRvdyBkaW1lbnNpb25zXG4gIHRoaXMucGFuZWxIZWlnaHQgPSBnYW1lLmhlaWdodCAqIDEvMiAtIHRoaXMuX21lbW9yeVBhZGRpbmcgLyAyO1xuICB0aGlzLnBhbmVsV2lkdGggPSBnYW1lLndpZHRoIC0gdGhpcy5fbWVtb3J5UGFkZGluZztcbiAgdGhpcy5fcm93Q2FwYWNpdHkgPSA1OyAgLy8gaXRlbXMgcGVyIHJvd1xuICB0aGlzLl9pdGVtU3RhcnQgPSAwOyAgLy8gZGV0ZXJtaW5lcyB3aGljaCByb3cgdG8gc2hvd1xuXG4gIC8vIHdpbmRvdy1kZXBlbmRlbnQgcHJpdmF0ZSBtZW1iZXIgZGltZW5zaW9uc1xuICB0aGlzLl9tZW1vcnlUZXh0V2lkdGggPSB0aGlzLnBhbmVsV2lkdGggLSAxODU7XG4gIHRoaXMuX2l0ZW1QYWRkaW5nID0gdGhpcy5wYW5lbFdpZHRoIC8gNTA7XG4gIHRoaXMuX25leHRPcmlnaW5YID0gdGhpcy5wYW5lbFdpZHRoIC0gNTU7XG4gIHRoaXMuX25leHRPcmlnaW5ZID0gMDtcbiAgdGhpcy5fcHJldk9yaWdpblggPSAtMTg7XG4gIHRoaXMuX3ByZXZPcmlnaW5ZID0gMDtcblxuICAvKipcbiAgICogUGFuZWxcbiAgICovXG5cbiAgZ2FtZS5zbGlja1VJLmFkZChcbiAgICB0aGlzLnBhbmVsID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KFxuICAgICAgdGhpcy5fYmFzZVgsIHRoaXMuX2Jhc2VZLCBnYW1lLm1ha2Uuc3ByaXRlKDAsMCwgJ21lbW9yeS1iYW5rJyksXG4gICAgICB0aGlzLnBhbmVsV2lkdGgsIHRoaXMucGFuZWxIZWlnaHQpKTtcbiAgdGhpcy5wYW5lbC5kaXNwbGF5T2JqZWN0LndpZHRoID0gdGhpcy5wYW5lbFdpZHRoO1xuICB0aGlzLnBhbmVsLmRpc3BsYXlPYmplY3QuaGVpZ2h0ID0gdGhpcy5wYW5lbEhlaWdodDtcblxuICAvLyBieSBkZWZhdWx0LCBub3QgZGlzcGxheWVkXG4gIHRoaXMucGFuZWwudmlzaWJsZSA9IGZhbHNlO1xuICB0aGlzLnBhbmVsLmFscGhhID0gMC44O1xuXG4gIC8qKlxuICAgKiBUb2dnbGUgYnV0dG9uXG4gICAqL1xuICAvLyB1bnRpbCB5b3UgY2xpY2sgb24gdGhlIHRvZ2dsZSBidXR0b25cbiAgZ2FtZS5zbGlja1VJLmFkZChcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvbiA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICAgIDAsdGhpcy5fbWVtb3J5UGFkZGluZywgZ2FtZS5tYWtlLmJ1dHRvbigwLDAsICdtZW1vcnktYmFuay1idXR0b24nKSkpO1xuICAvLyBzZXQgc2NhbGUgc3VjaCB0aGF0IHdpZHRoID0gMS84IHBhbmVsIHdpZHRoXG4gIHRoaXMudG9nZ2xlQnV0dG9uLmRpc3BsYXlPYmplY3Quc2NhbGUuc2V0VG8oXG4gICAgKHRoaXMucGFuZWxXaWR0aCAvIDgpIC8gdGhpcy50b2dnbGVCdXR0b24uZGlzcGxheU9iamVjdC53aWR0aCk7XG4gIHRoaXMudG9nZ2xlQnV0dG9uLnggPSBnYW1lLndpZHRoIC0gdGhpcy5fbWVtb3J5UGFkZGluZyAtIHRoaXMudG9nZ2xlQnV0dG9uLmRpc3BsYXlPYmplY3Qud2lkdGg7XG4gIC8vIHNob3cgcGFuZWwgY2FsbGJhY2tcbiAgdGhpcy50b2dnbGVCdXR0b24uZXZlbnRzLm9uSW5wdXREb3duLmFkZChtZW1vcnlCYW5rQnV0dG9uVG9nZ2xlLCB0aGlzKTtcbiAgdGhpcy50b2dnbGVCdXR0b24uYWxwaGEgPSAwLjk7XG5cbiAgLyoqXG4gICAqIFRleHQgLSBuYW1lIGFuZCBkZXNjcmlwdGlvblxuICAgKi9cbiAgdmFyIG5hbWVUZXh0U3R5bGUgPSB7IGZvbnQ6ICcxNHB4IEdvdWR5IEJvb2tsZXR0ZXIgMTkxMScsIGZpbGw6ICcjNDhmMmZmJywgd29yZFdyYXA6IHRydWUsIHdvcmRXcmFwV2lkdGg6IHRoaXMuX21lbW9yeVRleHRXaWR0aCwgZm9udFdlaWdodDogJ2JvbGQnLCBib3VuZHNBbGlnbkg6ICdjZW50ZXInIH07XG4gIHRoaXMucGFuZWwuYWRkKFxuICAgIHRoaXMubmFtZVRleHQgPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoXG4gICAgICB0aGlzLl9tZW1vcnlUZXh0T3JpZ2luWCxcbiAgICAgIHRoaXMuX21lbW9yeVRleHRPcmlnaW5ZLFxuICAgICAgZ2FtZS5tYWtlLnRleHQoMCwwLCAnJywgbmFtZVRleHRTdHlsZSksIHRoaXMuX21lbW9yeVRleHRXaWR0aCkpO1xuICAvLyBmb3IgYWxpZ25tZW50IHB1cnBvc2VzXG4gIHZhciBuYW1lVGV4dEhlaWdodCA9IHRoaXMubmFtZVRleHQuZGlzcGxheU9iamVjdC5nZXRCb3VuZHMoKS5oZWlnaHQ7XG4gIHRoaXMubmFtZVRleHQuZGlzcGxheU9iamVjdC5zZXRUZXh0Qm91bmRzKDAsMCwgdGhpcy5fbWVtb3J5VGV4dFdpZHRoLCBuYW1lVGV4dEhlaWdodCk7XG5cbiAgdmFyIGRlc2NUZXh0U3R5bGUgPSB7IGZvbnQ6ICcxNHB4IE9wZW4gU2FucycsIGZpbGw6ICcjNDhmMmZmJywgd29yZFdyYXA6IHRydWUsIHdvcmRXcmFwV2lkdGg6IHRoaXMuX21lbW9yeVRleHRXaWR0aCwgYWxpZ246ICdsZWZ0JyB9O1xuICB0aGlzLnBhbmVsLmFkZChcbiAgICB0aGlzLmRlc2NUZXh0ID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KFxuICAgICAgdGhpcy5fbWVtb3J5VGV4dE9yaWdpblgsXG4gICAgICB0aGlzLl9tZW1vcnlUZXh0T3JpZ2luWSArIG5hbWVUZXh0SGVpZ2h0LFxuICAgICAgZ2FtZS5tYWtlLnRleHQoMCwwLCAnJywgZGVzY1RleHRTdHlsZSksIHRoaXMuX21lbW9yeVRleHRXaWR0aCkpO1xuXG4gIC8qKlxuICAgKiBCb29ra2VlcGluZ1xuICAgKi9cbiAgLy8gYXJlIHdlIGN1cnJlbnRseSBhbmltYXRpbmc/XG4gIHRoaXMuX2lzVHdlZW5pbmcgPSBmYWxzZTtcbiAgdGhpcy5faXRlbURpc3BsYXlPYmplY3RzID0gW107IC8vIGZvciBkZWxldGlvbiBwdXJwb3Nlc1xuICB0aGlzLl9uYXZCdXR0b25zID0gW107XG59XG5cbk1lbW9yeUJhbmtXaW5kb3cucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuR3JvdXAucHJvdG90eXBlKTtcbk1lbW9yeUJhbmtXaW5kb3cucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTWVtb3J5QmFua1dpbmRvdztcblxuTWVtb3J5QmFua1dpbmRvdy5wcm90b3R5cGUuZGlzcGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5jbGVhbldpbmRvdygpO1xuICB0aGlzLmRpc3BsYXlJdGVtcygpO1xuICB0aGlzLnNob3dOYXZCdXR0b25zKCk7XG59O1xuXG5NZW1vcnlCYW5rV2luZG93LnByb3RvdHlwZS5jbGVhbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9pdGVtRGlzcGxheU9iamVjdHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgaXRlbSA9IHRoaXMuX2l0ZW1EaXNwbGF5T2JqZWN0c1tpXTtcbiAgICBpdGVtLmNvbnRhaW5lci5kaXNwbGF5R3JvdXAucmVtb3ZlQWxsKHRydWUpO1xuICAgIGl0ZW0uY29udGFpbmVyLmRpc3BsYXlHcm91cC5kZXN0cm95KCk7XG4gIH1cbiAgZm9yIChpID0gMDsgaSA8IHRoaXMuX25hdkJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbmF2QnV0dG9uID0gdGhpcy5fbmF2QnV0dG9uc1tpXTtcbiAgICBuYXZCdXR0b24uY29udGFpbmVyLmRpc3BsYXlHcm91cC5yZW1vdmVBbGwodHJ1ZSk7XG4gICAgbmF2QnV0dG9uLmNvbnRhaW5lci5kaXNwbGF5R3JvdXAuZGVzdHJveSgpO1xuICB9XG4gIHRoaXMuX2l0ZW1EaXNwbGF5T2JqZWN0cyA9IFtdO1xuICB0aGlzLl9uYXZCdXR0b25zID0gW107XG59O1xuXG5NZW1vcnlCYW5rV2luZG93LnByb3RvdHlwZS5kaXNwbGF5SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBpbnZlbnRvcnkgPSB0aGlzLl9nYW1lLnBsYXllci5pbnZlbnRvcnk7XG5cbiAgdmFyIGl0ZW1FbmQgPSB0aGlzLl9pdGVtU3RhcnQgKyB0aGlzLl9yb3dDYXBhY2l0eSA8IGludmVudG9yeS5sZW5ndGhcbiAgICA/IHRoaXMuX2l0ZW1TdGFydCArIHRoaXMuX3Jvd0NhcGFjaXR5XG4gICAgOiBpbnZlbnRvcnkubGVuZ3RoO1xuXG4gIC8vIEFzc3VtZXMgSW52ZW50b3J5SXRlbSBvYmplY3RzIGluIGludmVudG9yeS5cbiAgZm9yICh2YXIgaSA9IHRoaXMuX2l0ZW1TdGFydDsgaSA8IGl0ZW1FbmQ7IGkrKykge1xuICAgIHZhciBpdGVtSWQgPSBpbnZlbnRvcnlbaV07XG5cbiAgICAvLyBzY2FsZWQgd2lkdGggPSAxLzcgcGFuZWwgd2lkdGg7XG4gICAgdmFyIGRlc2lyZWRXaWR0aCA9ICh0aGlzLnBhbmVsV2lkdGggLyA3KTtcbiAgICB2YXIgaXRlbUljb24gPSBuZXcgSWNvbih0aGlzLl9nYW1lLCAwLDAsXG4gICAgICBpdGVtSWQsICdtZW1vcnktYmFuay1pY29uLW1hc2snLCAnbWVtb3J5LWJhbmstaWNvbicgLyogYm9yZGVyICovLCBkZXNpcmVkV2lkdGgpO1xuXG4gICAgdmFyIHNsaWNrSXRlbTtcbiAgICB0aGlzLnBhbmVsLmFkZChzbGlja0l0ZW0gPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoXG4gICAgICB0aGlzLl9pdGVtT3JpZ2luWCArIChpIC0gdGhpcy5faXRlbVN0YXJ0KSoodGhpcy5faXRlbVBhZGRpbmcgKyBkZXNpcmVkV2lkdGgpLCB0aGlzLl9pdGVtT3JpZ2luWSxcbiAgICAgIGl0ZW1JY29uKSk7XG5cbiAgICBpdGVtSWNvbi5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgIGl0ZW1JY29uLmlucHV0LnVzZUhhbmRDdXJzb3IgPSB0cnVlO1xuICAgIGl0ZW1JY29uLmV2ZW50cy5vbklucHV0T3Zlci5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5uYW1lVGV4dC5kaXNwbGF5T2JqZWN0LnRleHQgPSBpdGVtc1t0aGlzLml0ZW1JZF1bJ25hbWUnXS50b1VwcGVyQ2FzZSgpO1xuICAgICAgdGhpcy5kZXNjVGV4dC5kaXNwbGF5T2JqZWN0LnRleHQgPSBpdGVtc1t0aGlzLml0ZW1JZF1bJ2Rlc2MnXTtcbiAgICB9LCB7bmFtZVRleHQ6IHRoaXMubmFtZVRleHQsIGRlc2NUZXh0OiB0aGlzLmRlc2NUZXh0LCBpdGVtSWQ6IGl0ZW1JZH0pO1xuXG4gICAgdGhpcy5faXRlbURpc3BsYXlPYmplY3RzLnB1c2goc2xpY2tJdGVtKTtcbiAgfVxufTtcblxuTWVtb3J5QmFua1dpbmRvdy5wcm90b3R5cGUuc2hvd05hdkJ1dHRvbnMgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIG5leHQgYnV0dG9uc1xuICBpZiAodGhpcy5faXRlbVN0YXJ0ICsgdGhpcy5fcm93Q2FwYWNpdHkgPCB0aGlzLl9nYW1lLnBsYXllci5pbnZlbnRvcnkubGVuZ3RoKSB7XG4gICAgdmFyIG5leHRCdXR0b24gPSB0aGlzLl9nYW1lLm1ha2UuYnV0dG9uKDAsMCwnbWVtb3J5LWJhbmstbmV4dCcpO1xuICAgIHZhciBzbGlja05leHQ7XG4gICAgdGhpcy5wYW5lbC5hZGQoc2xpY2tOZXh0ID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KFxuICAgICAgdGhpcy5fbmV4dE9yaWdpblgsIHRoaXMuX25leHRPcmlnaW5ZLCBuZXh0QnV0dG9uKSk7XG4gICAgLy8gc2NhbGVkIGJ5IGhlaWdodCwgZXF1YWwgdG8gcGFuZWwgaGVpZ2h0XG4gICAgbmV4dEJ1dHRvbi5zY2FsZS5zZXRUbyh0aGlzLnBhbmVsSGVpZ2h0IC8gbmV4dEJ1dHRvbi5oZWlnaHQpO1xuICAgIHRoaXMuX25hdkJ1dHRvbnMucHVzaChzbGlja05leHQpO1xuXG4gICAgbmV4dEJ1dHRvbi5ldmVudHMub25JbnB1dFVwLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnN3aXRjaFJvdyh0cnVlKTtcbiAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgIH0sIHRoaXMpO1xuXG4gIH1cblxuICAvLyBwcmV2IGJ1dHRvbnNcbiAgaWYgKHRoaXMuX2l0ZW1TdGFydCA+IDApIHtcbiAgICB2YXIgcHJldkJ1dHRvbiA9IHRoaXMuX2dhbWUubWFrZS5idXR0b24oMCwwLCdtZW1vcnktYmFuay1uZXh0Jyk7XG4gICAgLy8gcm90YXRlIHNwcml0ZVxuICAgIHByZXZCdXR0b24uYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcbiAgICBwcmV2QnV0dG9uLnNjYWxlLnkgKj0gLTE7XG4gICAgcHJldkJ1dHRvbi5hbmNob3Iuc2V0VG8oMSwxKTtcblxuICAgIHZhciBzbGlja1ByZXY7XG4gICAgdGhpcy5wYW5lbC5hZGQoc2xpY2tQcmV2ID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KFxuICAgICAgdGhpcy5fcHJldk9yaWdpblgsIHRoaXMuX3ByZXZPcmlnaW5ZLFxuICAgICAgcHJldkJ1dHRvbikpO1xuICAgIHRoaXMuX25hdkJ1dHRvbnMucHVzaChzbGlja1ByZXYpO1xuXG4gICAgcHJldkJ1dHRvbi5zY2FsZS5zZXRUbyh0aGlzLnBhbmVsSGVpZ2h0IC8gcHJldkJ1dHRvbi5oZWlnaHQpO1xuXG4gICAgcHJldkJ1dHRvbi5ldmVudHMub25JbnB1dFVwLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnN3aXRjaFJvdyhmYWxzZSk7XG4gICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICB9LCB0aGlzKTtcblxuICB9XG59O1xuXG5NZW1vcnlCYW5rV2luZG93LnByb3RvdHlwZS5zd2l0Y2hSb3cgPSBmdW5jdGlvbiAod2FudHNOZXh0Um93KSB7XG4gIHZhciBpbnZlbnRvcnkgPSB0aGlzLl9nYW1lLnBsYXllci5pbnZlbnRvcnk7XG4gIGlmICh3YW50c05leHRSb3cgJiYgdGhpcy5faXRlbVN0YXJ0ICsgdGhpcy5fcm93Q2FwYWNpdHkgPCBpbnZlbnRvcnkubGVuZ3RoKSB7XG4gICAgdGhpcy5faXRlbVN0YXJ0ICs9IHRoaXMuX3Jvd0NhcGFjaXR5O1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoIXdhbnRzTmV4dFJvdyAmJiB0aGlzLl9pdGVtU3RhcnQgLSB0aGlzLl9yb3dDYXBhY2l0eSA+PSAwKSB7XG4gICAgdGhpcy5faXRlbVN0YXJ0IC09IHRoaXMuX3Jvd0NhcGFjaXR5O1xuICAgIHJldHVybjtcbiAgfVxufTtcblxuTWVtb3J5QmFua1dpbmRvdy5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAvLyBUT0RPOiBTdHViLlxufTtcbiIsIi8qXG4gKiBOUENcbiAqID09PT1cbiAqXG4gKiBBIHNhbXBsZSBwcmVmYWIgKGV4dGVuZGVkIGdhbWUgb2JqZWN0IGNsYXNzKSwgZGlzcGxheWluZyBhbiBOUEMgaW4gYSByb29tLlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIG5wY3MgPSByZXF1aXJlKCcuLi8uLi9zdGF0aWMvYXNzZXRzL25wY3MuanNvbicpO1xudmFyIFRvYXN0ID0gcmVxdWlyZSgnLi9Ub2FzdCcpO1xuXG5mdW5jdGlvbiBOUEMoZ2FtZSwgeCwgeSwgaWQsIGhlaWdodCwgd2lkdGgpIHtcbiAgdGhpcy5pZCA9IGlkO1xuICB0aGlzLmltZyA9IG5wY3NbaWRdWydpbWFnZSddO1xuICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgdGhpcy5pbWcpO1xuICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICB0aGlzLm5hbWUgPSBucGNzW2lkXVsnbmFtZSddO1xuXG4gIHRoaXMuX2dhbWUgPSBnYW1lO1xuICB0aGlzLmNvbnYgPSBucGNzW2lkXVsnY29udiddO1xuICB0aGlzLmFuY2hvci5zZXQoMC41KTtcbiAgdGhpcy5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICB0aGlzLmlucHV0LnVzZUhhbmRDdXJzb3IgPSB0cnVlO1xuICB0aGlzLmV2ZW50cy5vbklucHV0RG93bi5hZGQoY2xpY2ssIHRoaXMpO1xuICB0aGlzLmV2ZW50cy5vbklucHV0T3Zlci5hZGQobW91c2VvdmVyLCB0aGlzKTtcbiAgdGhpcy5ldmVudHMub25JbnB1dE91dC5hZGQobW91c2VvdXQsIHRoaXMpO1xuXG4gIHRoaXMuaW5wdXQucGl4ZWxQZXJmZWN0T3ZlciA9IHRydWU7ICAgLy8gY2hlY2tzIHBpeGVscyBzbyB0aGF0IGNvbGxpc2lvbiBvbmx5IGhhcHBlbnMgd2l0aCBub24tdHJhbnNwYXJlbnQgYXJlYXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21wdXRhdGlvbmFsbHkgZXhwZW5zaXZlLCBidXQgbWF5YmUgbmVjZXNzYXJ5IGZvciByZWFsaXNtIHB1cnBvc2VzP1xufVxuXG5OUEMucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XG5tb2R1bGUuZXhwb3J0cyA9IE5QQy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBOUEM7XG5cbmZ1bmN0aW9uIGNsaWNrKCkge1xuICB0aGlzLmhpZGUoKTtcbiAgdGhpcy5fZ2FtZS5kaWFsb2d1ZVdpbmRvdy5iZWdpbih0aGlzLmNvbnYpO1xufVxuXG5mdW5jdGlvbiBtb3VzZW92ZXIoKSB7XG4gIHRoaXMuX2dhbWUuYWRkLmV4aXN0aW5nKHRoaXMudG9hc3QgPSBuZXcgVG9hc3QodGhpcy5fZ2FtZSwgdGhpcy5uYW1lLCA1KSk7XG59XG5cbmZ1bmN0aW9uIG1vdXNlb3V0KCkge1xuICBpZiAodGhpcy50b2FzdCkge1xuICAgIHRoaXMudG9hc3QudG9hc3QuY29udGFpbmVyLmRpc3BsYXlHcm91cC5yZW1vdmVBbGwoKTtcbiAgICB0aGlzLnRvYXN0LmRlc3Ryb3koKTtcbiAgfVxufVxuXG5OUEMucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGZhZGVJblR3ZWVuID0gdGhpcy5fZ2FtZS5hZGQudHdlZW4odGhpcyk7XG4gIHZhciBmYWRlSW4gPSAyMDA7XG4gIGZhZGVJblR3ZWVuLnRvKHthbHBoYTogMX0sIGZhZGVJbiwgUGhhc2VyLkVhc2luZy5MaW5lYXIuTm9uZSwgdHJ1ZSk7XG4gIHRoaXMuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbn07XG5cbk5QQy5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgZmFkZU91dFR3ZWVuID0gdGhpcy5fZ2FtZS5hZGQudHdlZW4odGhpcyk7XG4gIHZhciBmYWRlT3V0ID0gMjAwO1xuICBmYWRlT3V0VHdlZW4udG8oe2FscGhhOiAwfSwgZmFkZU91dCwgUGhhc2VyLkVhc2luZy5MaW5lYXIuTm9uZSwgdHJ1ZSk7XG4gIHRoaXMuaW5wdXRFbmFibGVkID0gZmFsc2U7XG59O1xuIiwiLypcbiAqIFBsYWNlYWJsZVxuICogPT09PVxuICpcbiAqIEEgc2FtcGxlIHByZWZhYiAoZXh0ZW5kZWQgZ2FtZSBvYmplY3QgY2xhc3MpLCBkaXNwbGF5aW5nIGFuIG9iamVjdCBpbiBhIHJvb21cbiAqICh1c3VhbGx5IGxhcmdlciB0aGFuIGEgY2xpY2thYmxlKSB0aGF0IGNhbiBiZSBjbGlja2VkIG9uIHRvIGRpc3BsYXkgYSBtZXNzYWdlLFxuICogYnV0IG5vdCBhZGRlZCB0byB0aGUgcGxheWVyJ3MgaW52ZW50b3J5LlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIFRvYXN0ID0gcmVxdWlyZSgnLi9Ub2FzdCcpO1xudmFyIGl0ZW1zID0gcmVxdWlyZSgnLi4vLi4vc3RhdGljL2Fzc2V0cy9pdGVtcy5qc29uJyk7XG5cbmZ1bmN0aW9uIFBsYWNlYWJsZShnYW1lLCB4LCB5LCBpZCwgaGVpZ2h0LCB3aWR0aCkge1xuICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgaWQpO1xuICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgdGhpcy53aWR0aCA9IHdpZHRoO1xuXG4gIHRoaXMuX2dhbWUgPSBnYW1lO1xuICB0aGlzLmlkID0gaWQ7XG4gIHRoaXMubmFtZSA9IGl0ZW1zW2lkXVsnbmFtZSddO1xuICB0aGlzLm1lc3NhZ2UgPSBpdGVtc1tpZF1bJ21lc3NhZ2UnXTtcbiAgdGhpcy5hbmNob3Iuc2V0KDAuNSk7XG4gIHRoaXMuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgdGhpcy5pbnB1dC51c2VIYW5kQ3Vyc29yID0gdHJ1ZTtcbiAgdGhpcy5ldmVudHMub25JbnB1dERvd24uYWRkKGNsaWNrLCB0aGlzKTtcbiAgdGhpcy5ldmVudHMub25JbnB1dE92ZXIuYWRkKG1vdXNlb3ZlciwgdGhpcyk7XG4gIHRoaXMuZXZlbnRzLm9uSW5wdXRPdXQuYWRkKG1vdXNlb3V0LCB0aGlzKTtcblxuICB0aGlzLmlucHV0LnBpeGVsUGVyZmVjdE92ZXIgPSB0cnVlOyAgIC8vIGNoZWNrcyBwaXhlbHMgc28gdGhhdCBjb2xsaXNpb24gb25seSBoYXBwZW5zIHdpdGggbm9uLXRyYW5zcGFyZW50IGFyZWFzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tcHV0YXRpb25hbGx5IGV4cGVuc2l2ZSwgYnV0IG1heWJlIG5lY2Vzc2FyeSBmb3IgcmVhbGlzbSBwdXJwb3Nlcz9cbn1cblxuZnVuY3Rpb24gY2xpY2soKSB7XG4gIHRoaXMuX2dhbWUuYWRkLmV4aXN0aW5nKG5ldyBUb2FzdCh0aGlzLl9nYW1lLCB0aGlzLm1lc3NhZ2UsIDUpKTtcbn1cblxuZnVuY3Rpb24gbW91c2VvdmVyKCkge1xuICB0aGlzLl9nYW1lLmFkZC5leGlzdGluZyh0aGlzLnRvYXN0ID0gbmV3IFRvYXN0KHRoaXMuX2dhbWUsIHRoaXMubmFtZSwgNSkpO1xufVxuXG5mdW5jdGlvbiBtb3VzZW91dCgpIHtcbiAgaWYgKHRoaXMudG9hc3QpIHtcbiAgICB0aGlzLnRvYXN0LnRvYXN0LmNvbnRhaW5lci5kaXNwbGF5R3JvdXAucmVtb3ZlQWxsKCk7XG4gICAgdGhpcy50b2FzdC5kZXN0cm95KCk7XG4gIH1cbn1cblxuUGxhY2VhYmxlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xubW9kdWxlLmV4cG9ydHMgPSBQbGFjZWFibGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUGxhY2VhYmxlOyIsIi8qXG4qIFBsYXllclxuKiA9PT09XG4qXG4qIFRoZSBwbGF5ZXIgb2JqZWN0IGNsYXNzLlxuKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBQbGF5ZXIoZ2FtZSkge1xuICBQaGFzZXIuR3JvdXAuY2FsbCh0aGlzLCBnYW1lKTtcbiAgdGhpcy5pbnZlbnRvcnkgPSBbXTtcbiAgdGhpcy5tZW1vcnlCYW5rID0gW107XG4gIHRoaXMuc2VlbkFyZWFzID0gW107IC8vYXJlYXMgc2VlbiB0byB0cmFjayB3aGF0IGNhbiBnbyBpbiBhcmVhIHRyYW5zaXRpb24gd2luZG93XG4gIHRoaXMudmFyaWFibGVzID0ge307XG4gIHRoaXMuY3VycmVudFJvb20gPSBudWxsO1xuICB0aGlzLmNvbnZvSWR4ID0gMDtcbiAgdGhpcy5zaG93bkNvbnZvID0gW107XG4gIHRoaXMuY29udm9GaWxlID0gbnVsbDtcblxufVxuXG5QbGF5ZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuR3JvdXAucHJvdG90eXBlKTtcbm1vZHVsZS5leHBvcnRzID0gUGxheWVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFBsYXllcjtcblxuUGxheWVyLnByb3RvdHlwZS5zZXJpYWxpemUgPSBmdW5jdGlvbihnYW1lKXtcbiAgdmFyIGZpZWxkcyA9IFtcbiAgICAnaW52ZW50b3J5JyxcbiAgICAnbWVtb3J5QmFuaycsXG4gICAgJ3NlZW5BcmVhcycsXG4gICAgJ3ZhcmlhYmxlcydcbiAgXTtcblxuICB2YXIgb2JqID0ge307XG5cbiAgZm9yIChsZXQgaSBpbiBmaWVsZHMpe1xuICAgIGxldCBmaWVsZCA9IGZpZWxkc1tpXTtcbiAgICBvYmpbZmllbGRdID0gdGhpc1tmaWVsZF07XG4gIH1cbiAgLy9zaW5jZSB0aGUgcm9vbSBpbmZvIGNvbnRhaW5zIGFsbCB0aGUgb2JqZWN0cyBpbiByb29tLCBjYW4gSSBwb3Agb2ZmIHRoZXJlP1xuICBvYmpbJ2N1cnJlbnRSb29tJ10gPSBnYW1lLnJvb20uYXJlYTtcbiAgb2JqWydjb252b0lkeCddID0gZ2FtZS5kaWFsb2d1ZVdpbmRvdy5jb252b01hbmFnZXIuaWR4O1xuICBvYmpbJ3Nob3duQ29udm8nXSA9IGdhbWUuZGlhbG9ndWVXaW5kb3cuY29udm9NYW5hZ2VyLnNob3duO1xuICAvL3NpbmNlIHRoZSBjb252b0ZpbGUgaXMgbm90IHN0b3JlZCBpbiB0aGUgZ2FtZSwgd2Ugd2lsbCBqdXN0IHN0b3JlIGl0IHdpdGggdGhlXG4gIC8vcGxheWVyIHdoZW5ldmVyIGEgbmV3IGZpbGUgaXMgc3RhcnRlZC5cbiAgLy9vciB3ZSBjb3VsZCBzdG9yZSB0aGF0IGFsc28gaW4gdGhlIERpYWxvZ3VlIG1hbmFnZXI/P1xuICBvYmpbJ2NvbnZvRmlsZSddID0gZ2FtZS5kaWFsb2d1ZVdpbmRvdy5jb252b0ZpbGU7XG4gIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmopO1xufTtcblxuUGxheWVyLnVuc2VyaWFsaXplID0gZnVuY3Rpb24ocGxheWVyU3RhdGUsIGdhbWUpe1xuXG4gIGlmICh0eXBlb2YgcGxheWVyU3RhdGUgPT09ICdzdHJpbmcnKXtcbiAgICBwbGF5ZXJTdGF0ZSA9IEpTT04ucGFyc2UocGxheWVyU3RhdGUsIChrZXksIHZhbHVlKSA9PiB7XG4gICAgICByZXR1cm4gdmFsdWU7ICAgICAvLyByZXR1cm4gdGhlIHVuY2hhbmdlZCBwcm9wZXJ0eSB2YWx1ZS5cbiAgICB9KTtcbiAgfVxuXG4gIGdhbWUucGxheWVyID0gZ2FtZS5hZGQuZXhpc3RpbmcobmV3IFBsYXllcihnYW1lKSk7XG5cbiAgZm9yIChsZXQgZmllbGQgaW4gcGxheWVyU3RhdGUpe1xuICAgIGdhbWUucGxheWVyW2ZpZWxkXSA9IHBsYXllclN0YXRlW2ZpZWxkXTtcbiAgfVxuXG59O1xuIiwiLypcbiAqIFJvb21cbiAqID09PT1cbiAqXG4gKiBBIHNhbXBsZSBwcmVmYWIgKGV4dGVuZGVkIGdhbWUgb2JqZWN0IGNsYXNzKSwgZGlzcGxheWluZyBhIHJvb20gYmFja2dyb3VuZC5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBDbGlja2FibGUgPSByZXF1aXJlKCcuLi9vYmplY3RzL0NsaWNrYWJsZScpO1xudmFyIFBsYWNlYWJsZSA9IHJlcXVpcmUoJy4uL29iamVjdHMvUGxhY2VhYmxlJyk7XG52YXIgTlBDID0gcmVxdWlyZSgnLi4vb2JqZWN0cy9OUEMnKTtcbnZhciBhcmVhcyA9IHJlcXVpcmUoJy4uLy4uL3N0YXRpYy9hc3NldHMvYXJlYXMuanNvbicpO1xuXG5mdW5jdGlvbiBSb29tKGdhbWUsIHJvb20pIHtcbiAgdGhpcy5fZ2FtZSA9IGdhbWU7XG4gIHRoaXMubmFtZSA9IHJvb207XG5cbiAgdGhpcy5hcmVhID0gYXJlYXNbcm9vbV07XG4gIHRoaXMuaXRlbXMgPSBbXTtcbiAgdGhpcy5wbGFjZWFibGVzID0gW107XG4gIHRoaXMubnBjcyA9IFtdOy8vaG93IGRvZXMgdGhpcyBpbnRlcmFjdCB3aXRoIHRoZSBjb252ZXJzYXRpb24gbWFuYWdlcj9cbiAgLy90aGlzIGlzIGNhdXNpbmcgdGhlIGdsaXRjaCB3aGVyZSB0aGUgcm9vbSBibGlua3Mgb24gbG9hZFxuICAvL3Rob3VnaCBldmVuIGEgbmV3IGdhbWUgYmxpbmtzXG4gIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCBnYW1lLndvcmxkLmNlbnRlclgsIGdhbWUud29ybGQuY2VudGVyWSwgdGhpcy5hcmVhWydiZyddKTtcbiAgdGhpcy5hbmNob3Iuc2V0KDAuNSk7XG5cbn1cblxuUm9vbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcbm1vZHVsZS5leHBvcnRzID0gUm9vbS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBSb29tO1xuXG5Sb29tLnByb3RvdHlwZS5hZGRJdGVtcyA9IGZ1bmN0aW9uKCkge1xuICAvL3dvdWxkIHByZWZlciB0aGlzIGluIGxvYWQgYXJlYXMgVE9ETyByZXN0cnVjdHVyZVxuICBpZiAodHlwZW9mIHRoaXMuX2dhbWUubXVzaWMgIT09ICd1bmRlZmluZWQnICYmIHRoaXMuX2dhbWUubXVzaWMgIT09IG51bGwpXG4gICAgdGhpcy5fZ2FtZS5tdXNpYy5mYWRlT3V0KDEwMDApOyAvLyBmYWRlIG91dCBwcmV2aW91cyBtdXNpY1xuICB0aGlzLl9nYW1lLm11c2ljID0gdGhpcy5fZ2FtZS5zb3VuZC5wbGF5KHRoaXMuYXJlYS5tdXNpYyk7XG4gIHRoaXMuX2dhbWUubXVzaWMubG9vcEZ1bGwoMSk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmFyZWFbJ2l0ZW1zJ10ubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgaXRlbSA9IHRoaXMuYXJlYVsnaXRlbXMnXVtpXTtcbiAgICB0aGlzLl9nYW1lLmFkZC5leGlzdGluZyhpdGVtID0gbmV3IENsaWNrYWJsZSh0aGlzLl9nYW1lLCBpdGVtWyd4J10sIGl0ZW1bJ3knXSwgaXRlbVsnaWQnXSwgaXRlbVsnaGVpZ2h0J10sIGl0ZW1bJ3dpZHRoJ10pKTtcbiAgICB0aGlzLml0ZW1zLnB1c2goaXRlbSk7XG4gIH1cbiAgZm9yIChpID0gMDsgaSA8IHRoaXMuYXJlYVsncGxhY2VhYmxlcyddLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHBsYWNlYWJsZSA9IHRoaXMuYXJlYVsncGxhY2VhYmxlcyddW2ldO1xuICAgIHRoaXMuX2dhbWUuYWRkLmV4aXN0aW5nKHBsYWNlYWJsZSA9IG5ldyBQbGFjZWFibGUodGhpcy5fZ2FtZSwgcGxhY2VhYmxlWyd4J10sIHBsYWNlYWJsZVsneSddLCBwbGFjZWFibGVbJ2lkJ10sIHBsYWNlYWJsZVsnaGVpZ2h0J10sIHBsYWNlYWJsZVsnd2lkdGgnXSkpO1xuICAgIHRoaXMucGxhY2VhYmxlcy5wdXNoKHBsYWNlYWJsZSk7XG4gIH1cbiAgZm9yIChpID0gMDsgaSA8IHRoaXMuYXJlYVsnbnBjcyddLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIG5wYyA9IHRoaXMuYXJlYVsnbnBjcyddW2ldO1xuXG4gICAgdmFyIHNob3dOUEMgPSB0cnVlOyAgICAgICAvLyBjaGVjayB0byBzZWUgaWYgTlBDIG1lZXRzIGNvbmRpdGlvbnMgdG8gYmUgc2hvd24gaW4gdGhpcyBhcmVhXG4gICAgaWYgKCdzaG93aWYnIGluIG5wYykge1xuICAgICAgZm9yICh2YXIgY29uZGl0aW9uIGluIG5wY1snc2hvd2lmJ10pIHtcbiAgICAgICAgaWYgKHRoaXMuX2dhbWUucGxheWVyLnZhcmlhYmxlc1tjb25kaXRpb25dICE9IG5wY1snc2hvd2lmJ11bY29uZGl0aW9uXSkge1xuICAgICAgICAgIHNob3dOUEMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXNob3dOUEMpIHtcbiAgICAgIGNvbnRpbnVlOyAvLyBpZiBOUEMgZG9lc24ndCBtZWV0IGNvbmRpdGlvbnMgdG8gYmUgc2hvd24sIHNraXAgdGhlbVxuICAgIH1cbiAgICB0aGlzLl9nYW1lLmFkZC5leGlzdGluZyhucGMgPSBuZXcgTlBDKHRoaXMuX2dhbWUsIG5wY1sneCddLCBucGNbJ3knXSwgbnBjWydpZCddLCBucGNbJ2hlaWdodCddLCBucGNbJ3dpZHRoJ10pKTtcbiAgICBpZiAobnBjLmNvbnYgPT09IHRoaXMuX2dhbWUucGxheWVyLmNvbnZvRmlsZSl7XG4gICAgICBucGMuYWxwaGEgPSAwO1xuICAgIH1cbiAgICAvLyBpZiB3ZSB3YW50IHRvIHJlLWVudGVyIGEgcm9vbSBhbmQgdGFsayB0byBhIGNoYXJhY3RlciBhZ2FpblxuICAgIC8vIHRoZW4gd2UgZG9uJ3Qgd2FudCB0byBwb3AgdGhlbSBvZmYgb2YgdGhlIHN0YWNrXG4gICAgdGhpcy5ucGNzLnB1c2gobnBjKTtcbiAgfVxuICB0aGlzLl9nYW1lLndvcmxkLmJyaW5nVG9Ub3AodGhpcy5fZ2FtZS5zbGlja1VJLmNvbnRhaW5lci5kaXNwbGF5R3JvdXApO1xufTtcblxuUm9vbS5wcm90b3R5cGUuY2xlYXJJdGVtcyA9IGZ1bmN0aW9uKCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICB0aGlzLml0ZW1zW2ldLmRlc3Ryb3koKTtcbiAgfVxuICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5wbGFjZWFibGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdGhpcy5wbGFjZWFibGVzW2ldLmRlc3Ryb3koKTtcbiAgfVxuICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5ucGNzLmxlbmd0aDsgaSsrKSB7XG4gICAgdGhpcy5ucGNzW2ldLmRlc3Ryb3koKTtcbiAgfVxuICB0aGlzLml0ZW1zID0gW107XG4gIHRoaXMucGxhY2VhYmxlcyA9IFtdO1xuICB0aGlzLm5wY3MgPSBbXTtcbn07XG5cblJvb20ucHJvdG90eXBlLmxvYWRBcmVhID0gZnVuY3Rpb24oYXJlYSkge1xuICB0aGlzLmFyZWEgPSBhcmVhc1thcmVhXTtcblxuICAvL2JlbG93IHNob3VsZCB0cmFjayBhcmVhcyBzZWVuIHNvIHRoYXQgd2hlbiBhcmVhIHRyYW5zaXRpb24gaXMgcHJlc3NlZFxuICAvL2l0IHdpbGwgdXBkYXRlIHdpdGggd2hhdCB0aGUgc3BlY2lmaWMgcGxheWVyIGhhcyBhY2Nlc3MgdG8uXG4gIGlmICghdGhpcy5fZ2FtZS5wbGF5ZXIuc2VlbkFyZWFzLmluY2x1ZGVzKGFyZWEpKXtcbiAgICB0aGlzLl9nYW1lLnBsYXllci5zZWVuQXJlYXMucHVzaChhcmVhKTtcbiAgfVxuICB0aGlzLm5hbWUgPSBhcmVhO1xuICB0aGlzLl9nYW1lLmNhbWVyYS5mYWRlKCcjMDAwMDAwJywgMjAwMCk7XG4gIHRoaXMuX2dhbWUuY2FtZXJhLm9uRmFkZUNvbXBsZXRlLmFkZE9uY2UoZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jbGVhckl0ZW1zKCk7XG4gICAgdGhpcy5fZ2FtZS5jYW1lcmEuZmxhc2goJyMwMDAwMDAnLCAyMDAwKTtcbiAgICB0aGlzLmxvYWRUZXh0dXJlKHRoaXMuYXJlYVsnYmcnXSk7XG4gICAgdGhpcy5hZGRJdGVtcygpO1xuICB9LCB0aGlzKTtcbn07XG4iLCIvKlxuICogU2F2ZUJ1dHRvblxuICogPT09PVxuICogU2F2ZSBidXR0b24sIGZsdXNoIHBsYXllciBPYmplY3QgdG8gbG9jYWwgc3RvcmUuXG4gKlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIFRvYXN0ID0gcmVxdWlyZSgnLi9Ub2FzdCcpO1xuXG5mdW5jdGlvbiBTYXZlQnV0dG9uKGdhbWUpIHtcbiAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIDI1LCAyMCwgJ3NhdmVCdXR0b24nKTtcbiAgdGhpcy5oZWlnaHQgPSAzMDtcbiAgdGhpcy53aWR0aCA9IDUwO1xuXG4gIHRoaXMuX2dhbWUgPSBnYW1lO1xuICB0aGlzLmlkID0gJ3NhdmVCdXR0b24nO1xuICB0aGlzLm5hbWUgPSAnU2F2ZSBCdXR0b24nO1xuICB0aGlzLmFuY2hvci5zZXQoMC41KTtcbiAgdGhpcy5hbHBoYSA9IDAuNTtcbiAgdGhpcy5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICB0aGlzLmlucHV0LnVzZUhhbmRDdXJzb3IgPSB0cnVlO1xuICB0aGlzLmV2ZW50cy5vbklucHV0RG93bi5hZGQoY2xpY2ssIHRoaXMpO1xuICB0aGlzLmV2ZW50cy5vbklucHV0T3Zlci5hZGQobW91c2VvdmVyLCB0aGlzKTtcbiAgdGhpcy5ldmVudHMub25JbnB1dE91dC5hZGQobW91c2VvdXQsIHRoaXMpO1xufVxuXG5mdW5jdGlvbiBjbGljaygpIHtcbiAgdGhpcy5fZ2FtZS5zb3VuZC5wbGF5KCdzYXZlLW5vdGlmaWNhdGlvbicpO1xuICB0aGlzLl9nYW1lLmFkZC5leGlzdGluZyhuZXcgVG9hc3QodGhpcy5fZ2FtZSwgJ0dhbWUgU2F2ZWQhJywgNSkpO1xuICB0aGlzLl9nYW1lLmRpYWxvZ3VlV2luZG93LmRpc3BsYXkodHJ1ZSk7IC8vIHJlZnJlc2ggZGlhbG9ndWUgZGlzcGxheVxuICB2YXIgc2F2ZVN0cmluZyA9IHRoaXMuX2dhbWUucGxheWVyLnNlcmlhbGl6ZSh0aGlzLl9nYW1lKTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BsYXllclN0YXRlJywgc2F2ZVN0cmluZyk7XG59XG5cbmZ1bmN0aW9uIG1vdXNlb3ZlcigpIHtcbiAgdGhpcy5hbHBoYSA9IDE7XG4gIHRoaXMuX2dhbWUuYWRkLmV4aXN0aW5nKHRoaXMudG9hc3QgPSBuZXcgVG9hc3QodGhpcy5fZ2FtZSwgdGhpcy5uYW1lLCAzKSk7XG59XG5cbmZ1bmN0aW9uIG1vdXNlb3V0KCkge1xuICBpZiAodGhpcy50b2FzdCkge1xuICAgIHRoaXMuYWxwaGEgPSAwLjU7XG4gICAgdGhpcy50b2FzdC50b2FzdC5jb250YWluZXIuZGlzcGxheUdyb3VwLnJlbW92ZUFsbCgpO1xuICAgIHRoaXMudG9hc3QuZGVzdHJveSgpO1xuICB9XG59XG5cblNhdmVCdXR0b24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XG5tb2R1bGUuZXhwb3J0cyA9IFNhdmVCdXR0b24ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gU2F2ZUJ1dHRvbjtcbiIsIi8qXG4gKiBTY3JvbGxiYXJcbiAqID09PT09PT09PVxuICpcbiAqIEJpdG1hcCBzY3JvbGxiYXIgdGhhdCBmb2xsb3dzIGEgc2V0IG9mIGdpdmVuIHBvaW50cy5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0gU2Nyb2xsYmFyO1xuXG5mdW5jdGlvbiBTY3JvbGxiYXIoZ2FtZSwgeCwgeSwgdWlQYXJlbnQsIHBvaW50cywgbWF4U2Nyb2xsLCBsaW5lV2lkdGggPSAyLCBzY3JvbGxiYXJXaWR0aCA9IDYpIHtcbiAgUGhhc2VyLkdyb3VwLmNhbGwodGhpcywgZ2FtZS8qLCAuLi5hcmdzKi8pO1xuXG4gIHRoaXMuX2dhbWUgPSBnYW1lO1xuICAvLyBEaXNwYXRjaCBzaWduYWxzOyBvdGhlcnMgbWF5IGF0dGFjaCBldmVudHMgdG8gdGhlc2Ugc2lnbmFsc1xuICB0aGlzLm9uRHJhZ1N0YXJ0ID0gbmV3IFBoYXNlci5TaWduYWwoKTtcbiAgdGhpcy5vbkRyYWcgPSBuZXcgUGhhc2VyLlNpZ25hbCgpO1xuICB0aGlzLm9uRHJhZ1N0b3AgPSBuZXcgUGhhc2VyLlNpZ25hbCgpO1xuICB0aGlzLm9uU2V0VmFsdWUgPSBuZXcgUGhhc2VyLlNpZ25hbCgpO1xuXG4gIC8vIEluaXRpYWwgdmFsdWVcbiAgdGhpcy5fdmFsdWUgPSAwO1xuICAvLyBIb3cgd2lkZSBpcyBvdXIgc2Nyb2xsYmFyP1xuICB0aGlzLl9zY3JvbGxiYXJXaWR0aCA9IHNjcm9sbGJhcldpZHRoO1xuICAvLyBIb3cgbWFueSBwaXhlbHMgZG93biBjYW4gd2Ugc2Nyb2xsP1xuICB0aGlzLl9tYXhTY3JvbGwgPSBtYXhTY3JvbGw7XG4gIC8vIERldGVybWluZXMgcGF0aCBvZiBzY3JvbGxiYXIsIGFzIHdlbGwgYXMgYm91bmRzXG4gIHRoaXMucG9pbnRzID0gcG9pbnRzO1xuXG4gIC8vIERyYXcgYml0bWFwIHBhdGhcbiAgdGhpcy5tYXhXaWR0aCA9IE1hdGgubWF4KC4uLnRoaXMucG9pbnRzLngpO1xuICB0aGlzLm1heEhlaWdodCA9IE1hdGgubWF4KC4uLnRoaXMucG9pbnRzLnkpO1xuXG4gIHZhciBibWRQYXRoID0gdGhpcy5fZ2FtZS5tYWtlLmJpdG1hcERhdGEodGhpcy5tYXhXaWR0aCArIGxpbmVXaWR0aCwgdGhpcy5tYXhIZWlnaHQgKyBsaW5lV2lkdGgpO1xuICB2YXIgaW50ZXJwSW5jID0gMSAvIHRoaXMubWF4SGVpZ2h0O1xuICBmb3IgKHZhciBpID0gMDsgaSA8IDE7IGkgKz0gaW50ZXJwSW5jKSB7XG4gICAgdmFyIHB4ID0gdGhpcy5fZ2FtZS5tYXRoLmxpbmVhckludGVycG9sYXRpb24odGhpcy5wb2ludHMueCwgaSk7XG4gICAgdmFyIHB5ID0gdGhpcy5fZ2FtZS5tYXRoLmxpbmVhckludGVycG9sYXRpb24odGhpcy5wb2ludHMueSwgaSk7XG4gICAgYm1kUGF0aC5yZWN0KHB4LCBweSwgbGluZVdpZHRoLCBsaW5lV2lkdGgsICcjNDhmMmZmJyk7XG4gIH1cblxuICB0aGlzLnNjcm9sbGJhckxpbmUgPSBuZXcgU2xpY2tVSS5FbGVtZW50LkRpc3BsYXlPYmplY3QoXG4gICAgeCwgeSwgdGhpcy5fZ2FtZS5tYWtlLnNwcml0ZSgwLDAsIGJtZFBhdGgpKTtcblxuICAvLyBEcmF3IHNjcm9sbGJhclxuICB0aGlzLl9zY3JvbGxiYXJSYXRpbyA9ICh0aGlzLm1heEhlaWdodCArIHRoaXMuX3Njcm9sbGJhcldpZHRoIC0gdGhpcy5fbWF4U2Nyb2xsKSAvIHRoaXMubWF4SGVpZ2h0O1xuXG4gIC8vIEJpdG1hcCBkYXRhIGZvciBzY3JvbGxiYXJcbiAgdGhpcy5fYm1kU2Nyb2xsID0gdGhpcy5fZ2FtZS5tYWtlLmJpdG1hcERhdGEoXG4gICAgdGhpcy5tYXhXaWR0aCArIHRoaXMuX3Njcm9sbGJhcldpZHRoLCBcbiAgICB0aGlzLm1heEhlaWdodCArIHRoaXMuX3Njcm9sbGJhcldpZHRoKTtcblxuICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5fc2Nyb2xsYmFyUmF0aW87IGkgKz0gaW50ZXJwSW5jKSB7XG4gICAgcHggPSB0aGlzLl9nYW1lLm1hdGgubGluZWFySW50ZXJwb2xhdGlvbihwb2ludHMueCwgaSk7XG4gICAgcHkgPSB0aGlzLl9nYW1lLm1hdGgubGluZWFySW50ZXJwb2xhdGlvbihwb2ludHMueSwgaSk7XG4gICAgdGhpcy5fYm1kU2Nyb2xsLnJlY3QocHgsIHB5LCB0aGlzLl9zY3JvbGxiYXJXaWR0aCwgdGhpcy5fc2Nyb2xsYmFyV2lkdGgsICcjNDhmMmZmJyk7XG4gIH1cbiAgdmFyIHNjcm9sbGJhclNwcml0ZSA9IHRoaXMuX2dhbWUubWFrZS5zcHJpdGUoMCwwLCB0aGlzLl9ibWRTY3JvbGwpO1xuICB0aGlzLnNjcm9sbGJhciA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdChcbiAgICB4LXRoaXMuX3Njcm9sbGJhcldpZHRoLzIsIFxuICAgIHktdGhpcy5fc2Nyb2xsYmFyV2lkdGgvMiwgXG4gICAgc2Nyb2xsYmFyU3ByaXRlKTtcblxuICAvLyBEaXNwbGF5IGV2ZW50c1xuICBzY3JvbGxiYXJTcHJpdGUuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgc2Nyb2xsYmFyU3ByaXRlLmlucHV0LnVzZUhhbmRDdXJzb3IgPSB0cnVlO1xuICBcbiAgLy8gSGFuZGxlIG1vdXNlIGlucHV0XG4gIHNjcm9sbGJhclNwcml0ZS5ldmVudHMub25JbnB1dERvd24uYWRkKGZ1bmN0aW9uIChzcHJpdGUsIHBvaW50ZXIpIHtcbiAgICB0aGlzLl9kcmFnZ2luZyA9IHRydWU7XG4gICAgdGhpcy5fZHJhZ1BvaW50ID0gcG9pbnRlci55O1xuICAgIHRoaXMuX2RyYWdWYWx1ZSA9IHRoaXMuX3ZhbHVlO1xuXG4gICAgdGhpcy5vbkRyYWdTdGFydC5kaXNwYXRjaCh0aGlzLl92YWx1ZSk7XG4gIH0sIHRoaXMpO1xuICBzY3JvbGxiYXJTcHJpdGUuZXZlbnRzLm9uSW5wdXRVcC5hZGQoZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuX2RyYWdnaW5nID0gZmFsc2U7XG5cbiAgICB0aGlzLm9uRHJhZ1N0b3AuZGlzcGF0Y2godGhpcy5fdmFsdWUpO1xuICB9LCB0aGlzKTtcblxuICB0aGlzLl9nYW1lLmlucHV0LmFkZE1vdmVDYWxsYmFjayhmdW5jdGlvbiAocG9pbnRlciwgcG9pbnRlclgsIHBvaW50ZXJZKSB7XG4gICAgaWYgKCF0aGlzLl9kcmFnZ2luZylcbiAgICAgIHJldHVybjtcblxuICAgIC8vIE1lYXN1cmUgc2Nyb2xsIHJlbGF0aXZlIHRvIGRyYWdQb2ludFxuICAgIHZhciBzdGFydCA9IHRoaXMuX2RyYWdQb2ludCAtIHRoaXMuX2RyYWdWYWx1ZSp0aGlzLl9tYXhTY3JvbGw7XG4gICAgdmFyIGNsYW1wZWREZWx0YSA9IE1hdGgubWluKE1hdGgubWF4KDAsIHBvaW50ZXJZIC0gc3RhcnQpLCB0aGlzLl9tYXhTY3JvbGwpO1xuXG4gICAgLy8gVXBkYXRlIHZhbHVlXG4gICAgdGhpcy5fdmFsdWUgPSAoMS90aGlzLl9tYXhTY3JvbGwpKmNsYW1wZWREZWx0YTtcblxuICAgIC8vIFJlZHJhdyBiaXRtYXAgdG8gdXBkYXRlIHNwcml0ZVxuICAgIHRoaXMucmVkcmF3KCk7XG5cbiAgICB0aGlzLm9uRHJhZy5kaXNwYXRjaCh0aGlzLl92YWx1ZSk7XG4gICAgXG4gIH0sIHRoaXMpO1xuXG4gIC8vIEFkZCB0byBTbGlja1VJIHBhcmVudFxuICB1aVBhcmVudC5hZGQodGhpcy5zY3JvbGxiYXJMaW5lKTtcbiAgdWlQYXJlbnQuYWRkKHRoaXMuc2Nyb2xsYmFyKTtcbiAgXG59XG5TY3JvbGxiYXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuR3JvdXAucHJvdG90eXBlKTtcblNjcm9sbGJhci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBTY3JvbGxiYXI7XG5cblNjcm9sbGJhci5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLl9ibWRTY3JvbGwuY2xlYXIoKTtcbiAgLy8gUmVkcmF3IGJpdG1hcCB0byB1cGRhdGUgc3ByaXRlXG4gIHZhciBzdGFydEJpdG1hcCA9IHRoaXMuX3ZhbHVlKnRoaXMuX21heFNjcm9sbCAvIHRoaXMubWF4SGVpZ2h0O1xuICB2YXIgaW50ZXJwSW5jID0gMS90aGlzLm1heEhlaWdodDtcbiAgZm9yICh2YXIgaSA9IHN0YXJ0Qml0bWFwOyBpIDwgc3RhcnRCaXRtYXAgKyB0aGlzLl9zY3JvbGxiYXJSYXRpbzsgaSArPSBpbnRlcnBJbmMpIHtcbiAgICB2YXIgcHggPSB0aGlzLl9nYW1lLm1hdGgubGluZWFySW50ZXJwb2xhdGlvbih0aGlzLnBvaW50cy54LCBpKTtcbiAgICB2YXIgcHkgPSB0aGlzLl9nYW1lLm1hdGgubGluZWFySW50ZXJwb2xhdGlvbih0aGlzLnBvaW50cy55LCBpKTtcbiAgICB0aGlzLl9ibWRTY3JvbGwucmVjdChweCwgcHksIHRoaXMuX3Njcm9sbGJhcldpZHRoLCB0aGlzLl9zY3JvbGxiYXJXaWR0aCwgJyM0OGYyZmYnKTtcbiAgfVxufTtcblxuU2Nyb2xsYmFyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAvLyBpZiBkaXNwbGF5IGNvbnRhaW5lciBleGlzdHMgKGkuZS4gbm90IGRlc3Ryb3llZClcbiAgaWYgKHR5cGVvZiB0aGlzLnNjcm9sbGJhckxpbmUuY29udGFpbmVyICE9PSAndW5kZWZpbmVkJyAmJiB0aGlzLnNjcm9sbGJhckxpbmUuY29udGFpbmVyICE9PSBudWxsKSB7XG4gICAgdGhpcy5zY3JvbGxiYXJMaW5lLmNvbnRhaW5lci5kaXNwbGF5R3JvdXAucmVtb3ZlQWxsKHRydWUpO1xuICAgIHRoaXMuc2Nyb2xsYmFyTGluZS5jb250YWluZXIuZGlzcGxheUdyb3VwLmRlc3Ryb3koKTtcbiAgICB0aGlzLnNjcm9sbGJhckxpbmUuY29udGFpbmVyID0gdW5kZWZpbmVkO1xuICB9XG4gIFxuICBpZiAodHlwZW9mIHRoaXMuc2Nyb2xsYmFyLmNvbnRhaW5lciAhPT0gJ3VuZGVmaW5lZCcgJiYgdGhpcy5zY3JvbGxiYXIuY29udGFpbmVyICE9PSBudWxsKSB7XG4gICAgdGhpcy5zY3JvbGxiYXIuY29udGFpbmVyLmRpc3BsYXlHcm91cC5yZW1vdmVBbGwodHJ1ZSk7XG4gICAgdGhpcy5zY3JvbGxiYXIuY29udGFpbmVyLmRpc3BsYXlHcm91cC5kZXN0cm95KCk7XG4gICAgdGhpcy5zY3JvbGxiYXIuY29udGFpbmVyID0gdW5kZWZpbmVkO1xuICB9XG4gIHRoaXMuc2Nyb2xsYmFyTGluZS5zcHJpdGUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuc2Nyb2xsYmFyLnNwcml0ZSA9IHVuZGVmaW5lZDtcbn07XG5cblNjcm9sbGJhci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAvLyBUT0RPOiBTdHViLlxufTtcblxuLyoqIEV4cGxpY2l0bHkgZGVmaW5lIHNldHRlcnMgYW5kIGdldHRlcnMgKi9cbi8vIHZhbHVlXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsYmFyLnByb3RvdHlwZSwgJ3ZhbHVlJywge1xuICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gIH0sXG4gIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgdGhpcy5fdmFsdWUgPSBNYXRoLm1pbihNYXRoLm1heCgwLCB2YWx1ZSksIDEpO1xuICAgIHRoaXMucmVkcmF3KCk7XG4gICAgdGhpcy5vblNldFZhbHVlLmRpc3BhdGNoKHRoaXMuX3ZhbHVlKTtcbiAgfVxufSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBDYXJkID0gcmVxdWlyZSgnLi9DYXJkJyk7XG52YXIgdGFjdGljcyA9IHJlcXVpcmUoJy4uLy4uL3N0YXRpYy9hc3NldHMvdGFjdGljcy5qc29uJyk7XG5cbmZ1bmN0aW9uIFRhY3RpYyhnYW1lLCB4LCB5LCBhc3NldE5hbWUsIG11bHRpVXNlID0gZmFsc2UpIHtcbiAgQ2FyZC5jYWxsKHRoaXMsIGdhbWUsIHgsIHksIGFzc2V0TmFtZSwgbXVsdGlVc2UpO1xufVxuXG5UYWN0aWMucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShDYXJkLnByb3RvdHlwZSk7XG5tb2R1bGUuZXhwb3J0cyA9IFRhY3RpYy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBUYWN0aWM7XG5cbi8qIEJFR0lOIE9WRVJSSURFIEZVTkNUSU9OUyAqL1xuVGFjdGljLnByb3RvdHlwZS5nZXROYW1lID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGFjdGljc1t0aGlzLmtleV1bJ25hbWUnXTtcbn07XG5cblRhY3RpYy5wcm90b3R5cGUuZ2V0RGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0YWN0aWNzW3RoaXMua2V5XVsnZGVzYyddO1xufTtcbi8qIEVORCBPVkVSUklERSBGVU5DVElPTlMgKi8iLCIvKlxuICogVG9hc3RcbiAqID09PT1cbiAqXG4gKiBBIHNhbXBsZSBwcmVmYWIgKGV4dGVuZGVkIGdhbWUgb2JqZWN0IGNsYXNzKSwgZGlzcGxheWluZyBhIHRvYXN0IChwb3B1cCBhdCB0b3Agb2YgZ2FtZSBzY3JlZW4pIHRoYXQgZGlzcGxheXNcbiAqIHRleHQgYW5kIGRpc2FwcGVhcnMgYWZ0ZXIgc2V2ZXJhbCBzZWNvbmRzLlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHRleHRzdHlsZXMgPSByZXF1aXJlKCcuLi8uLi9zdGF0aWMvYXNzZXRzL3RleHRzdHlsZXMuanNvbicpO1xuXG5mdW5jdGlvbiBUb2FzdChnYW1lLCBtZXNzYWdlLCB0aW1lb3V0KSB7XG4gIFBoYXNlci5Hcm91cC5jYWxsKHRoaXMsIGdhbWUpO1xuXG4gIHRoaXMuX2dhbWUgPSBnYW1lO1xuICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICB0aGlzLnRpbWVvdXQgPSB0aW1lb3V0O1xuXG4gIGlmIChnYW1lLnRvYXN0KSB7XG4gICAgZ2FtZS50b2FzdC50b2FzdC5jb250YWluZXIuZGlzcGxheUdyb3VwLnJlbW92ZUFsbCgpO1xuICAgIGdhbWUudG9hc3QuZGVzdHJveSgpO1xuICB9XG5cbiAgLy8gcHJpdmF0ZSBtZW1iZXJzIHNwZWNpZnlpbmcgbWFyZ2luIGFuZCBwYWRkaW5nXG4gIHRoaXMudG9hc3RUZXh0WSA9IDE2O1xuXG4gIHRoaXMudG9hc3RIZWlnaHQgPSBnYW1lLmhlaWdodCAqIDEvMTI7XG4gIHRoaXMudG9hc3RXaWR0aCA9IGdhbWUud2lkdGggKiAxLzI7XG5cbiAgdGhpcy50b2FzdFggPSBnYW1lLndpZHRoICogMS8yIC0gdGhpcy50b2FzdFdpZHRoICogMS8yO1xuICB0aGlzLnRvYXN0WSA9IDg7XG5cbiAgZ2FtZS5zbGlja1VJLmFkZCh0aGlzLnRvYXN0ID0gbmV3IFNsaWNrVUkuRWxlbWVudC5EaXNwbGF5T2JqZWN0KFxuICAgIHRoaXMudG9hc3RYLCB0aGlzLnRvYXN0WSwgZ2FtZS5tYWtlLnNwcml0ZSgwLCAwLCAndG9hc3QnKSxcbiAgICB0aGlzLnRvYXN0V2lkdGgsIHRoaXMudG9hc3RIZWlnaHQpKTtcbiAgdGhpcy50b2FzdC5kaXNwbGF5T2JqZWN0LndpZHRoID0gdGhpcy50b2FzdFdpZHRoO1xuICB0aGlzLnRvYXN0LmRpc3BsYXlPYmplY3QuaGVpZ2h0ID0gdGhpcy50b2FzdEhlaWdodDtcblxuICBnYW1lLnRvYXN0ID0gdGhpcztcblxuICB0aGlzLnRvYXN0LmFkZChcbiAgICB0aGlzLnRvYXN0VGV4dCA9IG5ldyBTbGlja1VJLkVsZW1lbnQuRGlzcGxheU9iamVjdCgwLCAwLCBcbiAgICAgIGdhbWUubWFrZS50ZXh0KDAsIHRoaXMudG9hc3RUZXh0WSwgbWVzc2FnZSwgdGV4dHN0eWxlc1sndG9hc3QnXSkpXG4gICk7XG4gIHRoaXMudG9hc3RUZXh0LmRpc3BsYXlPYmplY3Quc2V0VGV4dEJvdW5kcygwLCB0aGlzLnRvYXN0VGV4dFksIHRoaXMudG9hc3RXaWR0aCwgdGhpcy50b2FzdEhlaWdodCk7XG5cbiAgdGhpcy50b2FzdC5hbHBoYSA9IDAuODtcblxuICBnYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogdGltZW91dCwgZGVzdHJveVBvcHVwLCB0aGlzKTtcbn1cblxuZnVuY3Rpb24gZGVzdHJveVBvcHVwKCkge1xuICB0aGlzLnRvYXN0LmNvbnRhaW5lci5kaXNwbGF5R3JvdXAucmVtb3ZlQWxsKCk7XG4gIHRoaXMuZGVzdHJveSgpO1xufVxuXG5Ub2FzdC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5Hcm91cC5wcm90b3R5cGUpO1xubW9kdWxlLmV4cG9ydHMgPSBUb2FzdC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBUb2FzdDsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBDYXJkID0gcmVxdWlyZSgnLi4vb2JqZWN0cy9DYXJkJyk7XG52YXIgVGFjdGljID0gcmVxdWlyZSgnLi4vb2JqZWN0cy9UYWN0aWMnKTtcbnZhciBBcmd1bWVudCA9IHJlcXVpcmUoJy4uL29iamVjdHMvQXJndW1lbnQnKTtcbnZhciBpdGVtcyA9IHJlcXVpcmUoJy4uLy4uL3N0YXRpYy9hc3NldHMvaXRlbXMuanNvbicpO1xudmFyIFBsYXllciA9IHJlcXVpcmUoJy4uL29iamVjdHMvUGxheWVyJyk7XG52YXIgUm9vbSA9IHJlcXVpcmUoJy4uL29iamVjdHMvUm9vbScpO1xuXG52YXIgQmF0dGxlVWkgPSByZXF1aXJlKCcuLi9vYmplY3RzL0JhdHRsZVVpLmpzJyk7XG52YXIgQXJndW1lbnRNYW5hZ2VyID0gcmVxdWlyZSgnLi4vb2JqZWN0cy9Bcmd1bWVudE1hbmFnZXInKTtcbnZhciBEaWFsb2d1ZVdpbmRvdyA9IHJlcXVpcmUoJy4uL29iamVjdHMvRGlhbG9ndWVXaW5kb3cnKTtcbnZhciBDdXN0b21BY3Rpb25zID0gcmVxdWlyZSgnLi4vdXRpbHMvQ3VzdG9tQWN0aW9ucycpO1xuXG5leHBvcnRzLnByZWxvYWQgPSBmdW5jdGlvbihnYW1lKSB7XG4gIC8vIHByZWxvYWQgYWxsIFVJIG1lbnUgdGhlbWVzLlxuICBnYW1lLnNsaWNrVUkubG9hZCgndWkva2VubmV5LXRoZW1lL2tlbm5leS5qc29uJyk7XG59O1xuXG5leHBvcnRzLmNyZWF0ZSA9IGZ1bmN0aW9uIChnYW1lKSB7XG4gIGlmIChnYW1lLnBsYXllciA9PT0gbnVsbCB8fCB0eXBlb2YgZ2FtZS5wbGF5ZXIgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgZ2FtZS5wbGF5ZXIgPSBnYW1lLmFkZC5leGlzdGluZyhuZXcgUGxheWVyKGdhbWUpKTtcbiAgICAvLyBEVU1NWSBEQVRBXG4gICAgZ2FtZS5wbGF5ZXIuaW52ZW50b3J5LnB1c2goJ2xpc3RlbmVyJyk7XG4gICAgZ2FtZS5wbGF5ZXIuaW52ZW50b3J5LnB1c2goJ25vdGUnKTtcbiAgICBnYW1lLnJvb20gPSAobmV3IFJvb20oZ2FtZSwgJ2hhbmdhcicpKTtcbiAgICAvLyBFTkQgRFVNTVkgREFUQVxuICB9XG4gIC8vIENvbXBhbmlvbnNcbiAgZ2FtZS5jb21wYW5pb25zID0gWydNeXN0ZXJpb3VzIFZvaWNlJywgJ0tpc21ldCddOyAgLy8gRFVNTVkgREFUQVxuXG4gIC8vIE11c2ljXG4gIFxuXG4gIGdhbWUuYXJndW1lbnRNYW5hZ2VyID0gbmV3IEFyZ3VtZW50TWFuYWdlcihnYW1lKTtcbiAgdmFyIGN1c3RvbUFjdGlvbnMgPSBuZXcgQ3VzdG9tQWN0aW9ucyhnYW1lKTtcbiAgZ2FtZS5hcmd1bWVudE1hbmFnZXIgPSBuZXcgQXJndW1lbnRNYW5hZ2VyKGdhbWUsIGN1c3RvbUFjdGlvbnMpO1xuXG4gIGdhbWUuYXJndW1lbnRNYW5hZ2VyLmxvYWRKU09OQ29udmVyc2F0aW9uKCdiYXR0bGUwMScpO1xuICBnYW1lLmN1cnJlbnRBcmd1bWVudCA9IDA7XG4gIGdhbWUucGxheWVyVHVybiA9IHRydWU7XG4gIGdhbWUuY3JlZCA9IDQ7XG4gIGdhbWUucGVyc3Vhc2lvbiA9IDU7XG4gIGdhbWUudHVybkNvdW50ID0gMDtcblxuICAvLyBhZGRpbmcgaW4gcGxheWVyIGNhcmRzIGFuZCBmYWNlXG4gIGdhbWUucGxheWVyRGVjayA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGdhbWUucGxheWVyLmludmVudG9yeS5sZW5ndGg7IGkrKykge1xuICAgIGdhbWUucGxheWVyRGVjay5wdXNoKG5ldyBDYXJkKGdhbWUsIDAsMCwgaXRlbXNbZ2FtZS5wbGF5ZXIuaW52ZW50b3J5W2ldXVsnaWQnXSkpO1xuICB9XG5cbiAgLy8gYWRkaW5nIG9wcG9uZW50IGZhY2UgYW5kIG9wcG9uZW50IGNhcmRzIC0tdG8gZG86IGZldGNoIHRoZXNlIGZyb20gbWFpbiBnYW1lIHN0YXRlXG4gIGdhbWUub3Bwb25lbnREZWNrID0gW107XG4gIGdhbWUuYXJncyA9IGdhbWUuYXJndW1lbnRNYW5hZ2VyLmdldEFsbEFyZ3VtZW50cygpO1xuICBmb3IgKGkgPSAwOyBpIDwgZ2FtZS5hcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gVE9ETzogc3VwcG9ydCBmb3IgbXVsdGlwbGUgY291bnRlcnNcbiAgICBpZiAoJ2JsdWZmJyBpbiBnYW1lLmFyZ3NbaV0gJiYgZ2FtZS5hcmdzW2ldWydibHVmZiddID09PSB0cnVlKSB7XG4gICAgICAvLyBkbyBub3QgaW5jbHVkZSBibHVmZnNcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZ2FtZS5hcmdzW2ldWydjb3VudGVycyddLmxlbmd0aCA8PSAwKVxuICAgICAgY29udGludWU7XG4gICAgZ2FtZS5vcHBvbmVudERlY2sucHVzaChuZXcgQXJndW1lbnQoZ2FtZSwgMCwwLCBnYW1lLmFyZ3NbaV1bJ2lkJ10sIGdhbWUuYXJnc1tpXVsnY291bnRlcnMnXVswXSwgaSkpO1xuICB9XG5cbiAgZ2FtZS5iYXR0bGVVaSA9IG5ldyBCYXR0bGVVaShnYW1lLCBnYW1lLnBsYXllckRlY2ssIGdhbWUub3Bwb25lbnREZWNrKTtcbiAgZ2FtZS5iYXR0bGVVaS5jYXJkU2lnbmFsLmFkZChjYXJkQWN0aW9uLCB0aGlzKTtcbiAgZ2FtZS5iYXR0bGVVaS5jb21wYW5pb25TaWduYWwuYWRkKGNvbXBhbmlvblRleHQsIHRoaXMpO1xuXG4gIGdhbWUuZGlhbG9ndWVXaW5kb3cgPSBuZXcgRGlhbG9ndWVXaW5kb3coZ2FtZSwgZ2FtZS5hcmd1bWVudE1hbmFnZXIpO1xuICBzdGFydExvZ2ljQmF0dGxlKGdhbWUpO1xufTtcblxuZnVuY3Rpb24gc3RhcnRMb2dpY0JhdHRsZShnYW1lKSB7XG4gIC8vIExvYWQgSlNPTlxuICBnYW1lLmRpYWxvZ3VlV2luZG93LmxvYWRKU09OQ29udmVyc2F0aW9uKCdiYXR0bGUwMScpO1xuXG4gIC8vIFBsYXkgaW50cm8gc2VxdWVuY2UgYW5kIGRpc3BsYXlcbiAgZ2FtZS5hcmd1bWVudE1hbmFnZXIuc3RhcnRTcGVjaWFsQXJndW1lbnQoJ2ludHJvJyk7XG4gIGdhbWUuZGlhbG9ndWVXaW5kb3cuZGlzcGxheSgpO1xuXG4gIC8vIERpc2FibGUgYW5kIHRoZW4gcmVlbmFibGUgaW5wdXRcbiAgZ2FtZS5iYXR0bGVVaS5jYXJkc0lucHV0RW5hYmxlZChmYWxzZSk7XG4gIGdhbWUuYXJndW1lbnRNYW5hZ2VyLnNwZWNpYWxDb21wbGV0ZVNpZ25hbC5hZGQoZnVuY3Rpb24gKCkge1xuICAgIC8qIEZ1biBpbnRybyBkaXNwbGF5IHN0dWZmICovXG4gICAgLy8gRGlzcGxheSBvdmVybGF5IGFuZCBpbnRybyB0ZXh0XG4gICAgdmFyIGludHJvVHdlZW4gPSBnYW1lLmJhdHRsZVVpLmludHJvVHdlZW5zKCk7XG4gICAgaW50cm9Ud2Vlbi5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICBnYW1lLmJhdHRsZVVpLmJhdHRsZVN0YXJ0KCk7ICAvLyBlbmFibGUgY2FyZHMgYW5kIHJldmVhbCBjdXJyZW50IGFyZ1xuICAgICAgZ2FtZS5kaWFsb2d1ZVdpbmRvdy5kaXNwbGF5KCk7XG4gICBcbiAgICAgIC8vIFN0YXJ0IG11c2ljXG4gICAgICBpZiAodHlwZW9mIGdhbWUubXVzaWMgIT09ICd1bmRlZmluZWQnICYmIGdhbWUubXVzaWMgIT09IG51bGwpXG4gICAgICAgIGdhbWUubXVzaWMuZmFkZU91dCgxMDAwKTsgLy8gZmFkZSBvdXQgcHJldmlvdXMgbXVzaWNcbiAgICAgIGdhbWUubXVzaWMgPSBnYW1lLnNvdW5kLnBsYXkoJ29mZi1saW1pdHMnKTtcbiAgICAgIGdhbWUubXVzaWMuZmFkZUluKDEwMDApO1xuICAgICAgZ2FtZS5tdXNpYy5sb29wRnVsbCgxKTtcbiAgICB9KTtcblxuICAgIGdhbWUuYXJndW1lbnRNYW5hZ2VyLnNwZWNpYWxDb21wbGV0ZVNpZ25hbC5yZW1vdmVBbGwoKTtcbiAgfSk7XG5cbiAgZ2FtZS50dXJuQ291bnQgPSAxO1xufVxuXG5mdW5jdGlvbiBjYXJkQWN0aW9uKGdhbWUsIGNhcmQpIHtcbiAgaWYgKGdhbWUucGxheWVyVHVybikge1xuICAgIGdhbWUuZGlhbG9ndWVXaW5kb3cuc2tpcFRleHQoKTtcblxuICAgIGdhbWUucGxheWVyVHVybiA9IGZhbHNlO1xuICAgIGdhbWUuYmF0dGxlVWkuY2FyZHNJbnB1dEVuYWJsZWQoZmFsc2UpO1xuXG4gICAgdmFyIGFyZ3VtZW50ID0gZ2FtZS5vcHBvbmVudERlY2tbZ2FtZS5jdXJyZW50QXJndW1lbnRdO1xuXG4gICAgdmFyIGlzQ29ycmVjdCA9IGNhcmQua2V5ID09PSBhcmd1bWVudC5rZXk7XG5cbiAgICBpZiAoaXNDb3JyZWN0KSB7XG5cbiAgICAgIGdhbWUuYmF0dGxlVWkucGxheUNhcmRBbmltYXRpb24oY2FyZCwgYXJndW1lbnQsIHRydWUpO1xuICAgICAgZ2FtZS5vcHBvbmVudERlY2tbZ2FtZS5jdXJyZW50QXJndW1lbnRdID0gdW5kZWZpbmVkO1xuICAgICAgYXJndW1lbnQuZGVzdHJveSgpO1xuICAgICAgaWYgKCFjYXJkLm11bHRpVXNlKSB7XG4gICAgICAgIGNhcmQuZGVzdHJveSgpO1xuICAgICAgfVxuICAgICAgICBcbiAgICB9IGVsc2Uge1xuICAgICAgZ2FtZS5iYXR0bGVVaS5wbGF5Q2FyZEFuaW1hdGlvbihjYXJkLCBhcmd1bWVudCwgZmFsc2UpO1xuXG4gICAgfVxuXG4gICAgdmFyIHRleHRUeXBlID0gaXNDb3JyZWN0ID8gJ2NvcnJlY3QnIDogJ2luY29ycmVjdCc7XG5cbiAgICBnYW1lLmJhdHRsZVVpLmNhcmRBbmltQ29tcGxldGVTaWduYWwuYWRkKGFyZ3VtZW50SW50ZXJsdWRlLCB0aGlzLCBnYW1lLCB0ZXh0VHlwZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY29tcGFuaW9uVGV4dChnYW1lLCBzcGVha2VyKSB7XG4gIGlmIChnYW1lLnBsYXllclR1cm4pIHtcbiAgICBnYW1lLmRpYWxvZ3VlV2luZG93LnNraXBUZXh0KCk7XG4gICAgZ2FtZS5iYXR0bGVVaS5jYXJkc0lucHV0RW5hYmxlZChmYWxzZSk7XG5cbiAgICBnYW1lLmFyZ3VtZW50TWFuYWdlci5zdGFydEludGVybHVkZShzcGVha2VyKTtcbiAgICBnYW1lLmRpYWxvZ3VlV2luZG93LmRpc3BsYXkoKTtcblxuICAgIGdhbWUuYXJndW1lbnRNYW5hZ2VyLmludGVybHVkZUNvbXBsZXRlU2lnbmFsLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICBnYW1lLmJhdHRsZVVpLmNhcmRzSW5wdXRFbmFibGVkKHRydWUpO1xuICAgICAgZ2FtZS5kaWFsb2d1ZVdpbmRvdy5kaXNwbGF5KCk7XG4gICAgICBnYW1lLmFyZ3VtZW50TWFuYWdlci5pbnRlcmx1ZGVDb21wbGV0ZVNpZ25hbC5yZW1vdmVBbGwoKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBhcmd1bWVudEludGVybHVkZShnYW1lLCB0eXBlKSB7XG4gIGdhbWUuYXJndW1lbnRNYW5hZ2VyLnN0YXJ0SW50ZXJsdWRlKHR5cGUpO1xuICBnYW1lLmRpYWxvZ3VlV2luZG93LmRpc3BsYXkoKTtcbiAgZ2FtZS5hcmd1bWVudE1hbmFnZXIuaW50ZXJsdWRlQ29tcGxldGVTaWduYWwuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICBvcHBvbmVudFR1cm4oZ2FtZSk7XG4gICAgZ2FtZS5hcmd1bWVudE1hbmFnZXIuaW50ZXJsdWRlQ29tcGxldGVTaWduYWwucmVtb3ZlQWxsKCk7XG4gIH0pO1xuXG4gIGdhbWUuYmF0dGxlVWkuY2FyZEFuaW1Db21wbGV0ZVNpZ25hbC5yZW1vdmVBbGwoKTtcbn1cblxuZnVuY3Rpb24gZ2xlYW1pbmdTaG9hbEJsdWZmKGdhbWUpIHtcbiAgZ2FtZS5hcmd1bWVudE1hbmFnZXIuc3RhcnRTcGVjaWFsQXJndW1lbnQoJ2FiaWxpdHknLCAnYmx1ZmYnKTtcbiAgZ2FtZS5kaWFsb2d1ZVdpbmRvdy5kaXNwbGF5KCk7XG5cbiAgLy8gc3BlY2lhbCBibHVmZi4gaGFyZC1jb2RlZC5cbiAgdmFyIGxhc3RBcmd1bWVudCA9IGdhbWUub3Bwb25lbnREZWNrLnBvcCgpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGdhbWUuYXJncy5sZW5ndGg7IGkrKykge1xuICAgIGlmICgnYmx1ZmYnIGluIGdhbWUuYXJnc1tpXSAmJiBnYW1lLmFyZ3NbaV1bJ2JsdWZmJ10gPT09IHRydWUpIHtcbiAgICAgIC8vIFRPRE86IHVzZSBNZXJzZW5uZS1Ud2lzdGVyIGZvciBtb3JlIHJhbmRvbW5lc3NcbiAgICAgIHZhciByYW5kUG9zaXRpb24gPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgdmFyIG5ld0JsdWZmID0gbmV3IEFyZ3VtZW50KGdhbWUsIDAsMCwgZ2FtZS5hcmdzW2ldWydpZCddLCBnYW1lLmFyZ3NbaV1bJ2NvdW50ZXJzJ11bMF0sIGkpO1xuICAgICAgaWYgKHJhbmRQb3NpdGlvbiA+IDAuNSkge1xuICAgICAgICBnYW1lLm9wcG9uZW50RGVjay51bnNoaWZ0KG5ld0JsdWZmKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdhbWUub3Bwb25lbnREZWNrLnB1c2gobmV3Qmx1ZmYpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBhZGQgbGFzdCBhcmd1bWVudCB0byB0aGUgZW5kLlxuICBnYW1lLm9wcG9uZW50RGVjay5wdXNoKGxhc3RBcmd1bWVudCk7XG59XG5cbmZ1bmN0aW9uIGdpdmVDYWxsQmx1ZmZUYWN0aWMoZ2FtZSkge1xuICAvLyBHaXZlIHBsYXllciBhIHNwZWNpYWwgQ2FsbCBCbHVmZiB0YWN0aWMuXG4gIHZhciBjYWxsQmx1ZmYgPSBuZXcgVGFjdGljKGdhbWUsIDAsIDAsICdjYWxsLWJsdWZmJywgdHJ1ZSAvKiBtdWx0aVVzZSAqLyk7XG4gIGdhbWUucGxheWVyRGVjay5wdXNoKGNhbGxCbHVmZik7XG4gIGdhbWUuYmF0dGxlVWkubWFrZUNhcmRJY29uKGNhbGxCbHVmZik7XG59XG5cbi8qKiBUT0RPOiBIQVJEQ09ERUQgU1BFQ0lBTCBBQ1RJT05TID0gQVdGVUwgKi9cbmZ1bmN0aW9uIGNoZWNrU3BlY2lhbEFjdGlvbnMoZ2FtZSkge1xuICByZXR1cm4gZ2FtZS50dXJuQ291bnQgPT09IDI7XG59XG5mdW5jdGlvbiBzcGVjaWFsQWN0aW9ucyhnYW1lKSB7XG4gIGlmIChnYW1lLnR1cm5Db3VudCA9PT0gMikge1xuICAgIC8vIG9uIHRoZSBzZWNvbmQgdHVybiwgYmx1ZmZcbiAgICBnbGVhbWluZ1Nob2FsQmx1ZmYoZ2FtZSk7IC8vIGFkZHMgYXJndW1lbnRzIGludG8gbW9kZWxcbiAgICAvLyB3aGVuIHdlIGZpbmlzaCB0aGUgYWJpbGl0eSB0ZXh0Li4uXG4gICAgZ2FtZS5hcmd1bWVudE1hbmFnZXIuc3BlY2lhbENvbXBsZXRlU2lnbmFsLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBzaHVmZmxlXG4gICAgICB2YXIgcm91bGV0dGVUd2VlbiA9IGdhbWUuYmF0dGxlVWkucm91bGV0dGVBcmd1bWVudHMoKTtcbiAgICAgIHJvdWxldHRlVHdlZW4ub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBhZGQgYXJndW1lbnRzIGludG8gdWkgdmlld1xuICAgICAgICB1cGRhdGVDdXJyZW50QXJndW1lbnQoZ2FtZSk7XG4gICAgICAgIGdhbWUuYmF0dGxlVWkudXBkYXRlQXJndW1lbnRzKGdhbWUub3Bwb25lbnREZWNrLCBnYW1lLmN1cnJlbnRBcmd1bWVudCk7XG4gICAgICAgIGdhbWUuYmF0dGxlVWkucG9zaXRpb25Bcmd1bWVudHMoZ2FtZSk7XG4gICAgICAgIGdhbWUuYmF0dGxlVWkuYXJnQW5pbUNvbXBsZXRlU2lnbmFsLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZmluaXNoT3Bwb25lbnRUdXJuKGdhbWUpO1xuICAgICAgICAgIGdpdmVDYWxsQmx1ZmZUYWN0aWMoZ2FtZSk7XG4gICAgICAgICAgZ2FtZS5iYXR0bGVVaS5hcmdBbmltQ29tcGxldGVTaWduYWwucmVtb3ZlQWxsKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgdGhpcyk7XG4gICAgICBnYW1lLmFyZ3VtZW50TWFuYWdlci5zcGVjaWFsQ29tcGxldGVTaWduYWwucmVtb3ZlQWxsKCk7XG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgLy8gVE9ETzogcmFuZG9tbHkgZW50cmVuY2ggb3Igc2h1ZmZsZVxuICBpZiAoZ2FtZS50dXJuQ291bnQgPiAyKSB7XG4gICAgLy8gZG8gbm90aGluZyBmb3Igbm93LlxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBvcHBvbmVudFR1cm4oZ2FtZSkge1xuICBnYW1lLnR1cm5Db3VudCsrO1xuXG4gIGlmIChnYW1lLm9wcG9uZW50RGVja1tnYW1lLmN1cnJlbnRBcmd1bWVudF0gPT09IHVuZGVmaW5lZCkge1xuICAgIGdhbWUucGVyc3Vhc2lvbiAtPSAxO1xuICAgIGdhbWUuYmF0dGxlVWkudXBkYXRlUGVyc3Vhc2lvbkJhcigpOyAgICBcbiAgfSBlbHNlIGlmIChnYW1lLm9wcG9uZW50RGVja1tnYW1lLmN1cnJlbnRBcmd1bWVudF0pIHtcblxuICAgIGdhbWUuY3JlZCAtPSAxO1xuICAgIGdhbWUuYmF0dGxlVWkudXBkYXRlQ3JlZEJhcihnYW1lLmNyZWQsIHRydWUpOyAvLyB1cGRhdGUgY3JlZCBiYXIgd2l0aCBkYW1hZ2UgaW5kaWNhdGlvblxuICB9IGVsc2Uge1xuICAgIGdhbWUucGVyc3Vhc2lvbiAtPSAxO1xuICAgIGdhbWUuYmF0dGxlVWkudXBkYXRlUGVyc3Vhc2lvbkJhcigpO1xuICB9XG5cbiAgdXBkYXRlQ3VycmVudEFyZ3VtZW50KGdhbWUpO1xuICBnYW1lLmJhdHRsZVVpLnVwZGF0ZUFyZ3VtZW50cyhnYW1lLm9wcG9uZW50RGVjaywgZ2FtZS5jdXJyZW50QXJndW1lbnQpO1xuICBnYW1lLmJhdHRsZVVpLnBvc2l0aW9uQXJndW1lbnRzKGdhbWUsIHRydWUpO1xuICAvLyBEaXNwbGF5IGFyZ3VtZW50cyBvbiBhbmltYXRpb24gY29tcGxldGlvblxuICBnYW1lLmJhdHRsZVVpLmFyZ0FuaW1Db21wbGV0ZVNpZ25hbC5hZGQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBoYXNTcGVjaWFsQWN0aW9uID0gY2hlY2tTcGVjaWFsQWN0aW9ucyhnYW1lKTtcbiAgICBpZiAoaGFzU3BlY2lhbEFjdGlvbikge1xuICAgICAgZ2FtZS5iYXR0bGVVaS5hcmdBbmltQ29tcGxldGVTaWduYWwucmVtb3ZlQWxsKCk7XG4gICAgICBzcGVjaWFsQWN0aW9ucyhnYW1lKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZmluaXNoT3Bwb25lbnRUdXJuKGdhbWUpO1xuICAgIGdhbWUuYmF0dGxlVWkuYXJnQW5pbUNvbXBsZXRlU2lnbmFsLnJlbW92ZUFsbCgpO1xuICB9LCB0aGlzKTtcblxufVxuXG5mdW5jdGlvbiBmaW5pc2hPcHBvbmVudFR1cm4oZ2FtZSkge1xuICAvLyB1cG9uIGZpbmlzaGluZyBhcmd1bWVudCBwb3NpdGlvbmluZ1xuICAvLyByZXZlYWwgY3VycmVudCBhcmd1bWVudFxuICBnYW1lLmJhdHRsZVVpLnJldmVhbEN1cnJlbnQoKTtcblxuICAvLyByZWVuYWJsZSBwbGF5ZXIgaW5wdXQgYW5kIHN0YXJ0IHBsYXllciB0dXJuXG4gIHVwZGF0ZUFyZ3VtZW50V2luZG93KGdhbWUpO1xuICBnYW1lLmJhdHRsZVVpLnBvc2l0aW9uQ2FyZHMoKTtcbiAgZ2FtZS5iYXR0bGVVaS5jYXJkc0lucHV0RW5hYmxlZCh0cnVlKTtcbiAgZ2FtZS5wbGF5ZXJUdXJuID0gdHJ1ZTtcbn1cblxuLy8gRm9yIEFyZ3VtZW50TWFuYWdlclxuZnVuY3Rpb24gY3VycmVudEFyZ3VtZW50SnNvbklkeChnYW1lKSB7XG4gIHZhciBjdXJyZW50QXJndW1lbnQgPSBnYW1lLm9wcG9uZW50RGVja1tnYW1lLmN1cnJlbnRBcmd1bWVudF07XG4gIGlmICghY3VycmVudEFyZ3VtZW50KVxuICAgIHJldHVybiAtMTtcbiAgcmV0dXJuIGN1cnJlbnRBcmd1bWVudC5qc29uSWR4O1xufVxuXG5mdW5jdGlvbiB1cGRhdGVBcmd1bWVudFdpbmRvdyhnYW1lKSB7XG4gIGdhbWUuYXJndW1lbnRNYW5hZ2VyLmFkdmFuY2VUb1RhcmdldChjdXJyZW50QXJndW1lbnRKc29uSWR4KGdhbWUpKTtcbiAgaWYoZ2FtZS5jcmVkID09PSAwKSB7XG4gICAgZ2FtZS5hcmd1bWVudE1hbmFnZXIuc3RhcnRTcGVjaWFsQXJndW1lbnQoJ2xvc2UnKTtcbiAgfVxuICBpZihnYW1lLnBlcnN1YXNpb24gPT09IDApIHtcbiAgICBnYW1lLmFyZ3VtZW50TWFuYWdlci5zdGFydFNwZWNpYWxBcmd1bWVudCgnd2luJyk7XG4gIH1cbiAgZ2FtZS5kaWFsb2d1ZVdpbmRvdy5kaXNwbGF5KCk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRBcmd1bWVudChnYW1lKSB7XG4gIGdhbWUuY3VycmVudEFyZ3VtZW50ICs9IDE7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBnYW1lLm9wcG9uZW50RGVjay5sZW5ndGg7IGkrKykge1xuICAgIHZhciBpZHggPSBnYW1lLmN1cnJlbnRBcmd1bWVudCArIGk7XG4gICAgaWYgKGlkeCA+PSBnYW1lLm9wcG9uZW50RGVjay5sZW5ndGgpXG4gICAgICBpZHggLT0gZ2FtZS5vcHBvbmVudERlY2subGVuZ3RoO1xuICAgIC8vIGlmIGV4aXN0c1xuICAgIGlmICh0eXBlb2YgZ2FtZS5vcHBvbmVudERlY2tbaWR4XSAhPT0gJ3VuZGVmaW5lZCcgJiYgZ2FtZS5vcHBvbmVudERlY2tbaWR4XSAhPT0gbnVsbCkge1xuICAgICAgZ2FtZS5jdXJyZW50QXJndW1lbnQgPSBpZHg7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIC8vIGV4aXRpbmcgbWVhbnMgd2UgaGF2ZSBubyBtb3JlIGFyZ3VtZW50c1xufVxuIiwiLypcbiAqIEJvb3Qgc3RhdGVcbiAqID09PT09PT09PT1cbiAqXG4gKiBUaGUgZmlyc3Qgc3RhdGUgb2YgdGhlIGdhbWUsIHJlc3BvbnNpYmxlIGZvciBzZXR0aW5nIHVwIHNvbWUgUGhhc2VyXG4gKiBmZWF0dXJlcy4gQWRqdXN0IHRoZSBnYW1lIGFwcGVhcmFuY2UsIG51bWJlciBvZiBpbnB1dCBwb2ludGVycywgc2NyZWVuXG4gKiBvcmllbnRhdGlvbiBoYW5kbGluZyBldGMuIHVzaW5nIHRoaXMgZ2FtZSBzdGF0ZS5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBhc3NldHMgPSByZXF1aXJlKCcuLi9hc3NldHMnKTtcblxuZXhwb3J0cy5wcmVsb2FkID0gZnVuY3Rpb24gKGdhbWUpIHtcbiAgLy8gUG9pbnQgdGhlIFBoYXNlciBBc3NldCBMb2FkZXIgdG8gd2hlcmUgeW91ciBnYW1lIGFzc2V0cyBsaXZlLlxuICBnYW1lLmxvYWQucGF0aCA9ICdhc3NldHMvJztcblxuICAvLyBJbml0aWFsaXplIHBoeXNpY3MgZW5naW5lcyBoZXJlLiBSZW1lbWJlciB0aGF0IFBoYXNlciBidWlsZHMgaW5jbHVkaW5nXG4gIC8vIEFyY2FkZSBQaHlzaWNzIGhhdmUgaXQgZW5hYmxlZCBieSBkZWZhdWx0LlxuICAvL2dhbWUucGh5c2ljcy5zdGFydFN5c3RlbShQaGFzZXIuUGh5c2ljcy5QMik7XG5cbiAgLy8gQWRqdXN0IGhvdyBtYW55IHBvaW50ZXJzIFBoYXNlciB3aWxsIGNoZWNrIGZvciBpbnB1dCBldmVudHMuXG4gIGdhbWUuaW5wdXQubWF4UG9pbnRlcnMgPSAyO1xuXG4gIC8vIFNldCB0aGUgYWxpZ25tZW50IG9mIHRoZSBnYW1lIGNhbnZhcyB3aXRoaW4gdGhlIHBhZ2UuXG4gIGdhbWUuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcblxuICAvLyBBZGp1c3QgdGhlIHNjYWxpbmcgbW9kZSBvZiB0aGUgZ2FtZSBjYW52YXMuXG4gIC8vIEV4YW1wbGU6IElmIHlvdSdyZSBkZXZlbG9waW5nIGEgcGl4ZWwtYXJ0IGdhbWUsIHNldCBpdCB0byAnVVNFUl9TQ0FMRScuXG4gIGdhbWUuc2NhbGUuc2NhbGVNb2RlID0gUGhhc2VyLlNjYWxlTWFuYWdlci5OT19TQ0FMRTtcblxuICAvLyBXaGVuIHVzaW5nICdVU0VSX1NDQUxFJyBzY2FsaW5nIG1vZGUsIHVzZSB0aGlzIG1ldGhvZCB0byBhZGp1c3QgdGhlXG4gIC8vIHNjYWxpbmcgZmFjdG9yLlxuICAvL2dhbWUuc2NhbGUuc2V0VXNlclNjYWxlKDIpO1xuXG4gIC8vIFVuY29tbWVudCB0aGUgZm9sbG93aW5nIGxpbmUgdG8gYWRqdXN0IHRoZSByZW5kZXJpbmcgb2YgdGhlIGNhbnZhcyB0b1xuICAvLyBjcmlzcCBncmFwaGljcy4gR3JlYXQgZm9yIHBpeGVsLWFydCFcbiAgLy9QaGFzZXIuQ2FudmFzLnNldEltYWdlUmVuZGVyaW5nQ3Jpc3AoZ2FtZS5jYW52YXMpO1xuXG4gIC8vIFVuY29tbWVudCB0aGlzIGxpbmUgdG8gZGlzYWJsZSBzbW9vdGhpbmcgb2YgdGV4dHVyZXMuXG4gIC8vZ2FtZS5zdGFnZS5zbW9vdGhlZCA9IGZhbHNlO1xuXG4gIC8vIElmIHRoZSBnYW1lIGNhbnZhcyBsb3NlcyBmb2N1cywga2VlcCB0aGUgZ2FtZSBsb29wIHJ1bm5pbmcuXG4gIGdhbWUuc3RhZ2UuZGlzYWJsZVZpc2liaWxpdHlDaGFuZ2UgPSB0cnVlO1xuXG4gIC8vIFdoZXRoZXIgdG8gdXNlIGZyYW1lLWJhc2VkIGludGVycG9sYXRpb25zIG9yIG5vdC5cbiAgZ2FtZS50d2VlbnMuZnJhbWVCYXNlZCA9IGZhbHNlO1xuXG4gIC8vIExvYWQgdGhlIGdyYXBoaWNhbCBhc3NldHMgcmVxdWlyZWQgdG8gc2hvdyB0aGUgc3BsYXNoIHNjcmVlbiBsYXRlcixcbiAgLy8gdXNpbmcgdGhlIGFzc2V0IHBhY2sgZGF0YS5cbiAgZ2FtZS5sb2FkLnBhY2soJ2Jvb3QnLCBudWxsLCBhc3NldHMpO1xufTtcblxuZXhwb3J0cy5jcmVhdGUgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICAvLyBBZnRlciBhcHBseWluZyB0aGUgZmlyc3QgYWRqdXN0bWVudHMgYW5kIGxvYWRpbmcgdGhlIHNwbGFzaCBzY3JlZW5cbiAgLy8gYXNzZXRzLCBtb3ZlIHRvIHRoZSBuZXh0IGdhbWUgc3RhdGUuXG4gIGdhbWUuc3RhdGUuc3RhcnQoJ1ByZWxvYWRlcicpO1xufTtcbiIsIi8qXG4qIENyZWRpdHMgc3RhdGVcbiogPT09PT09PT09PT09PVxuKlxuKiBUaGUgcGxheWVyIHNob3VsZCBiZSBhYmxlIHRvIHJldHVybiB0byB0aGUgbWFpbiBtZW51LlxuKlxuKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5kZXNjcmlwdGlvbiA9ICdDb25ncmF0dWxhdGlvbnMhIFlvdVxcJ3ZlIHJlYWNoZWQgdGhlIGVuZCBvZiBvdXIgcGxheWFibGUgZGVtby4gXFxcbiAgV2UgaG9wZSB5b3UgZW5qb3llZCB0aGUgZmlyc3QgY2hhcHRlciBvZiBRdWFzYXJpYSBhcyBtdWNoIGFzIHdlIGVuam95ZWQgbWFraW5nIGl0ISc7XG4gIHRoaXMuY3JlZGl0cyA9ICdEZXZlbG9wZWQgYnk6XFxuQWxleGFuZHJvcyBDaHJpc3RvZG91bG91LVJ1YmFsY2F2YVxcbkhhbmEgTGVlXFxuQW1iZXIgVGhvbWFzXFxuRWR3YXJkIFdhbmcnO1xufTtcblxuZXhwb3J0cy5jcmVhdGUgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICB0aGlzLmNhbWVyYS5mbGFzaCgnIzAwMDAwMCcsIDIwMDApO1xuXG5cbiAgaWYgKHR5cGVvZiBnYW1lLm11c2ljICE9PSAndW5kZWZpbmVkJyAmJiBnYW1lLm11c2ljICE9PSBudWxsKVxuICAgIGdhbWUubXVzaWMuZmFkZU91dCgxMDAwKTsgLy8gZmFkZSBvdXQgcHJldmlvdXMgbXVzaWNcbiAgZ2FtZS5tdXNpYyA9IGdhbWUuc291bmQucGxheSgnc3VucmlzZS1mcm9tLW9yYml0Jyk7XG4gIGdhbWUubXVzaWMubG9vcEZ1bGwoMSk7XG4gIFxuXG4gIC8vbWlnaHQgbm90IGJlIGluIHF1b3RlcywgaXRzIGFuIGlzc3VlIGJlbG93XG4gIHZhciBzY3JlZW4gPSBnYW1lLmFkZC5zcHJpdGUoZ2FtZS53b3JsZC5jZW50ZXJYLCBnYW1lLndvcmxkLmNlbnRlclksICdtZW51X3NjcmVlbicpO1xuICBzY3JlZW4uYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuICBsZXQgc2NyZWVuRm9udCA9ICdDaW56ZWwgRGVjb3JhdGl2ZSc7XG4gIGxldCBmaWxsQ29sb3IgPSAnIzQyZGZmNCc7XG5cbiAgdmFyIGRlc2NUZXh0ID0gZ2FtZS5hZGQudGV4dChnYW1lLndvcmxkLmNlbnRlclgsIGdhbWUud29ybGQuY2VudGVyWSAtIDEwMCwgdGhpcy5kZXNjcmlwdGlvbiwge1xuICAgIGZvbnQ6ICcxNnB4ICcgKyBzY3JlZW5Gb250LFxuICAgIGZpbGw6IGZpbGxDb2xvcixcbiAgICBhbGlnbjogJ2NlbnRlcicsXG4gICAgd29yZFdyYXA6IHRydWUsXG4gICAgd29yZFdyYXBXaWR0aDogZ2FtZS53aWR0aCAtIDMwMFxuICB9KTtcblxuICB2YXIgY3JlZGl0c1RleHQgPSBnYW1lLmFkZC50ZXh0KGdhbWUud29ybGQuY2VudGVyWCwgZ2FtZS53b3JsZC5jZW50ZXJZICsgMTIwLCB0aGlzLmNyZWRpdHMsIHtcbiAgICBmb250OiAnMTZweCAnICsgc2NyZWVuRm9udCxcbiAgICBmaWxsOiBmaWxsQ29sb3IsXG4gICAgYWxpZ246ICdjZW50ZXInLFxuICAgIHdvcmRXcmFwOiB0cnVlLFxuICAgIHdvcmRXcmFwV2lkdGg6IGdhbWUud2lkdGggLSAzMDBcbiAgfSk7XG5cbiAgdmFyIG1haW5NZW51VGV4dCA9IGdhbWUuYWRkLnRleHQoZ2FtZS53b3JsZC5jZW50ZXJYLCBnYW1lLndvcmxkLmNlbnRlclksICdNYWluIE1lbnUnLCB7XG4gICAgZm9udDogJzUwcHggJyArIHNjcmVlbkZvbnQsXG4gICAgZmlsbDogZmlsbENvbG9yLFxuICAgIGFsaWduOiAnY2VudGVyJ1xuICB9KTtcblxuICBkZXNjVGV4dC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuICBjcmVkaXRzVGV4dC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuXG4gIG1haW5NZW51VGV4dC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuICBtYWluTWVudVRleHQuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgbWFpbk1lbnVUZXh0LmV2ZW50cy5vbklucHV0T3Zlci5hZGQoZnVuY3Rpb24oKSB7XG4gICAgbWFpbk1lbnVUZXh0LmZpbGwgPSAnI2ZmMDBmZic7XG4gIH0sIHRoaXMpO1xuXG4gIG1haW5NZW51VGV4dC5ldmVudHMub25JbnB1dE91dC5hZGQoZnVuY3Rpb24oKSB7XG4gICAgbWFpbk1lbnVUZXh0LmZpbGwgPSAnIzQyZGZmNCc7XG4gIH0sIHRoaXMpO1xuXG4gIG1haW5NZW51VGV4dC5ldmVudHMub25JbnB1dERvd24uYWRkKGZ1bmN0aW9uICgpIHtcbiAgICBnYW1lLnN0YXRlLnN0YXJ0KCdNYWluTWVudScpO1xuICB9LCB0aGlzKTtcblxufTtcbiIsIi8qXG4qIEdhbWUgc3RhdGVcbiogPT09PT09PT09PVxuKlxuKiBBIHNhbXBsZSBHYW1lIHN0YXRlLCBkaXNwbGF5aW5nIHRoZSBQaGFzZXIgbG9nby5cbiovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIFJvb20gPSByZXF1aXJlKCcuLi9vYmplY3RzL1Jvb20nKTtcbnZhciBQbGF5ZXIgPSByZXF1aXJlKCcuLi9vYmplY3RzL1BsYXllcicpO1xudmFyIERpYWxvZ3VlV2luZG93ID0gcmVxdWlyZSgnLi4vb2JqZWN0cy9EaWFsb2d1ZVdpbmRvdycpO1xudmFyIENvbnZlcnNhdGlvbk1hbmFnZXIgPSByZXF1aXJlKCcuLi9vYmplY3RzL0NvbnZlcnNhdGlvbk1hbmFnZXInKTtcbnZhciBDdXN0b21BY3Rpb25zID0gcmVxdWlyZSgnLi4vdXRpbHMvQ3VzdG9tQWN0aW9ucycpO1xudmFyIE1lbW9yeUJhbmtXaW5kb3cgPSByZXF1aXJlKCcuLi9vYmplY3RzL01lbW9yeUJhbmtXaW5kb3cnKTtcbnZhciBBcmVhVHJhbnNpdGlvbldpbmRvdyA9IHJlcXVpcmUoJy4uL29iamVjdHMvQXJlYVRyYW5zaXRpb25XaW5kb3cnKTtcbnZhciBTYXZlQnV0dG9uID0gcmVxdWlyZSgnLi4vb2JqZWN0cy9TYXZlQnV0dG9uJyk7XG5cbmV4cG9ydHMucHJlbG9hZCA9IGZ1bmN0aW9uKGdhbWUpIHtcbiAgLy8gcHJlbG9hZCBhbGwgVUkgbWVudSB0aGVtZXMuXG4gIGdhbWUuc2xpY2tVSS5sb2FkKCd1aS9rZW5uZXktdGhlbWUva2VubmV5Lmpzb24nKTtcbn07XG5cbmV4cG9ydHMuaW5pdCA9IGZ1bmN0aW9uKGdhbWUsIHJlc3VtZUdhbWUsIGZyb21CYXR0bGUpe1xuXG4gIGxldCBwbGF5ZXJTdGF0ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwbGF5ZXJTdGF0ZScpO1xuICBpZiAoZnJvbUJhdHRsZSkge1xuICAgIGdhbWUucm9vbSA9IG5ldyBSb29tKGdhbWUsICdoYW5nYXInKTsgIFxuICB9IGVsc2UgaWYgKHJlc3VtZUdhbWUgJiYgcGxheWVyU3RhdGUgIT09IG51bGwpe1xuICAgIFBsYXllci51bnNlcmlhbGl6ZShwbGF5ZXJTdGF0ZSwgZ2FtZSk7XG4gICAgLy9jdXJyZW50IHJvb20gaXMgYWN0dWFsbHkgcm9vbS5hcmVhXG4gICAgLy9uZWVkIHRvIGRlZXAgY29weSwgb3RoZXJ3aXNlIHdlIHdpbGwgbG9vc2UgdGhlIGFyZWEgaW5mb1xuICAgIHZhciBhcmVhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShnYW1lLnBsYXllci5jdXJyZW50Um9vbSkpO1xuICAgIGdhbWUucm9vbSA9IChuZXcgUm9vbShnYW1lLCBhcmVhLmlkKSk7XG4gICAgZ2FtZS5yb29tLmFyZWEgPSBhcmVhO1xuXG4gIH0gZWxzZSB7IC8vY2hlY2sgaWYgb2xkIG1vZGVsIGJsaW5rc1xuICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpO1xuICAgIGdhbWUucGxheWVyID0gKG5ldyBQbGF5ZXIoZ2FtZSkpO1xuICAgIC8vIGdhbWUucGxheWVyLnZhcmlhYmxlc1snZGVidWcnXSA9ICd0cnVlJzsgICAgLy8gY29tbWVudCB0aGlzIG91dCB0byBnZXQgcmlkIG9mIERFQlVHIC0gU0tJUCBUTyBFTkQgY29udmVyc2F0aW9uIG9wdGlvbnNcbiAgICBnYW1lLnBsYXllci5jb252b0ZpbGUgPSAncHJvbG9ndWUwMSc7XG4gICAgZ2FtZS5yb29tID0gKG5ldyBSb29tKGdhbWUsICdzaHV0dGxlJykpO1xuXG4gIH1cblxufTtcblxuZXhwb3J0cy5jcmVhdGUgPSBmdW5jdGlvbiAoZ2FtZSkge1xuXG4gIHRoaXMuY2FtZXJhLmZsYXNoKCcjMDAwMDAwJywgMjAwMCk7XG4gIGdhbWUuYWRkLmV4aXN0aW5nKGdhbWUucGxheWVyKTtcblxuICBnYW1lLmFkZC5leGlzdGluZyhnYW1lLnJvb20pO1xuICBnYW1lLnJvb20uYWRkSXRlbXMoKTtcblxuXG4gIC8vIHdlIHByZXZpb3VzbHkgaGFkIG11c2ljIGluIHRoZSBnYW1lIHN0YXRlLCBidXQgSSBtb3ZlIGl0IHRvIHRoZSByb29tIG9iamVjdFxuICAvLyBzbyB0aGF0IHdlIGNhbiBoYXZlIGRpZmZlcmVudCB0aGVtZXMgZm9yIGRpZmZlcmVudCByb29tc1xuICAvLyBuZWVkIHRvIHNldCB0aGUgbXVzaWMgaW4gdGhlIG90aGVyIHN0YXRlcyBsaWtlIGxvZ2ljIGJhdHRsZXNcblxuICBnYW1lLmFkZC5leGlzdGluZyhuZXcgU2F2ZUJ1dHRvbihnYW1lKSk7XG5cbiAgLy8gY3VzdG9tIGFjdGlvbnMgZm9yIGNvbnZlcnNhdGlvbnNcbiAgdmFyIGN1c3RvbUFjdGlvbnMgPSBuZXcgQ3VzdG9tQWN0aW9ucyhnYW1lKTtcbiAgLy8gY29udmVyc2F0aW9uIG1hbmFnZXJcbiAgdmFyIGNvbnZvTWFuYWdlciA9IG5ldyBDb252ZXJzYXRpb25NYW5hZ2VyKGdhbWUsIGN1c3RvbUFjdGlvbnMpO1xuICBjb252b01hbmFnZXIuaWR4ID0gZ2FtZS5wbGF5ZXIuY29udm9JZHg7XG4gIGNvbnZvTWFuYWdlci5zaG93biA9IGdhbWUucGxheWVyLnNob3duQ29udm87XG5cbiAgLy8gZGlhbG9ndWUgd2luZG93IG9iamVjdFxuICBnYW1lLmRpYWxvZ3VlV2luZG93ID0gbmV3IERpYWxvZ3VlV2luZG93KGdhbWUsIGNvbnZvTWFuYWdlcik7XG4gIC8vIG1lbW9yeSBiYW5rIHdpbmRvdyBvYmplY3RcbiAgZ2FtZS5tZW1vcnlCYW5rV2luZG93ID0gbmV3IE1lbW9yeUJhbmtXaW5kb3coZ2FtZSk7XG4gIC8vIGFyZWEgdHJhbnNpdGlvbiB3aW5kb3cgb2JqZWN0XG4gIGdhbWUuYXJlYVRyYW5zaXRpb25XaW5kb3cgPSBuZXcgQXJlYVRyYW5zaXRpb25XaW5kb3coZ2FtZSk7XG5cbiAgZ2FtZS5kaWFsb2d1ZVdpbmRvdy5iZWdpbihnYW1lLnBsYXllci5jb252b0ZpbGUpO1xuXG59O1xuIiwiLypcbiogR2FtZSBPdmVyIHN0YXRlXG4qID09PT09PT09PT09PT09PVxuKlxuKiBUaGUgcGxheWVyIHNob3VsZCBiZSBhYmxlIHRvIHJlc3RhcnQgYSBzYXZlZCBnYW1lIG9yIHJldHVybiB0byB0aGUgbWFpbiBtZW51Li5cbipcbiovXG5cbid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5pbml0ID0gZnVuY3Rpb24oZ2FtZSwgZ2FtZU92ZXJUZXh0KSB7XG4gIHRoaXMuZ2FtZU92ZXJUZXh0ID0gZ2FtZU92ZXJUZXh0O1xufTtcblxuZXhwb3J0cy5jcmVhdGUgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICB0aGlzLmNhbWVyYS5mbGFzaCgnIzAwMDAwMCcsIDIwMDApO1xuXG4gIGlmICh0eXBlb2YgZ2FtZS5tdXNpYyAhPT0gJ3VuZGVmaW5lZCcgJiYgZ2FtZS5tdXNpYyAhPT0gbnVsbClcbiAgICBnYW1lLm11c2ljLmZhZGVPdXQoMTAwMCk7IC8vIGZhZGUgb3V0IHByZXZpb3VzIG11c2ljXG4gIGdhbWUubXVzaWMgPSBnYW1lLnNvdW5kLnBsYXkoJ2NvbGQtbW9vbicpO1xuICBnYW1lLm11c2ljLmxvb3BGdWxsKDEpO1xuICAvL21pZ2h0IG5vdCBiZSBpbiBxdW90ZXMsIGl0cyBhbiBpc3N1ZSBiZWxvd1xuICB2YXIgc2NyZWVuID0gZ2FtZS5hZGQuc3ByaXRlKGdhbWUud29ybGQuY2VudGVyWCwgZ2FtZS53b3JsZC5jZW50ZXJZLCAnbWVudV9zY3JlZW4nKTtcbiAgc2NyZWVuLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG5cbiAgbGV0IHNjcmVlbkZvbnQgPSAnQ2luemVsIERlY29yYXRpdmUnO1xuICBsZXQgZmlsbENvbG9yID0gJyM0MmRmZjQnO1xuXG4gIHZhciB0aXRsZVRleHQgPSBnYW1lLmFkZC50ZXh0KGdhbWUud29ybGQuY2VudGVyWCwgZ2FtZS53b3JsZC5jZW50ZXJZLSA4NSwgJ0dhbWUgT3ZlcicsIHtcbiAgICBmb250OiAnNzVweCAnICsgc2NyZWVuRm9udCxcbiAgICBmb250V2VpZ2h0OiAnYm9sZCcsXG4gICAgZmlsbDogZmlsbENvbG9yLFxuICAgIGFsaWduOiAnY2VudGVyJ1xuICB9KTtcblxuICB2YXIgZGVzY1RleHQgPSBnYW1lLmFkZC50ZXh0KGdhbWUud29ybGQuY2VudGVyWCwgZ2FtZS53b3JsZC5jZW50ZXJZIC0gMjAsIHRoaXMuZ2FtZU92ZXJUZXh0LCB7XG4gICAgZm9udDogJzI1cHggJyArIHNjcmVlbkZvbnQsXG4gICAgZmlsbDogZmlsbENvbG9yLFxuICAgIGFsaWduOiAnY2VudGVyJ1xuICB9KTtcblxuICB2YXIgY29udFRleHQgPSBnYW1lLmFkZC50ZXh0KGdhbWUud29ybGQuY2VudGVyWCwgZ2FtZS53b3JsZC5jZW50ZXJZICsgMzAsICdSZWxvYWQnLCB7XG4gICAgZm9udDogJzUwcHggJyArIHNjcmVlbkZvbnQsXG4gICAgZmlsbDogZmlsbENvbG9yLFxuICAgIGFsaWduOiAnY2VudGVyJ1xuICB9KTtcblxuICB2YXIgbWFpbk1lbnVUZXh0ID0gZ2FtZS5hZGQudGV4dChnYW1lLndvcmxkLmNlbnRlclgsIGdhbWUud29ybGQuY2VudGVyWSArIDg1LCAnTWFpbiBNZW51Jywge1xuICAgIGZvbnQ6ICc1MHB4ICcgKyBzY3JlZW5Gb250LFxuICAgIGZpbGw6IGZpbGxDb2xvcixcbiAgICBhbGlnbjogJ2NlbnRlcidcbiAgfSk7XG5cbiAgdGl0bGVUZXh0LmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG5cbiAgZGVzY1RleHQuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuICBjb250VGV4dC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuICBjb250VGV4dC5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICBjb250VGV4dC5ldmVudHMub25JbnB1dE92ZXIuYWRkKGZ1bmN0aW9uKCkge1xuICAgIGNvbnRUZXh0LmZpbGwgPSAnI2ZmMDBmZic7XG4gIH0sIHRoaXMpO1xuXG4gIGNvbnRUZXh0LmV2ZW50cy5vbklucHV0T3V0LmFkZChmdW5jdGlvbigpIHtcbiAgICBjb250VGV4dC5maWxsID0gJyM0MmRmZjQnO1xuICB9LCB0aGlzKTtcblxuICBjb250VGV4dC5ldmVudHMub25JbnB1dERvd24uYWRkKGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcmVzdW1lR2FtZSA9IHRydWU7XG4gICAgZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScsIHRydWUsIGZhbHNlLCBnYW1lLCByZXN1bWVHYW1lKTtcbiAgfSwgdGhpcyk7XG5cbiAgbWFpbk1lbnVUZXh0LmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG4gIG1haW5NZW51VGV4dC5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICBtYWluTWVudVRleHQuZXZlbnRzLm9uSW5wdXRPdmVyLmFkZChmdW5jdGlvbigpIHtcbiAgICBtYWluTWVudVRleHQuZmlsbCA9ICcjZmYwMGZmJztcbiAgfSwgdGhpcyk7XG5cbiAgbWFpbk1lbnVUZXh0LmV2ZW50cy5vbklucHV0T3V0LmFkZChmdW5jdGlvbigpIHtcbiAgICBtYWluTWVudVRleHQuZmlsbCA9ICcjNDJkZmY0JztcbiAgfSwgdGhpcyk7XG5cbiAgbWFpbk1lbnVUZXh0LmV2ZW50cy5vbklucHV0RG93bi5hZGQoZnVuY3Rpb24gKCkge1xuICAgIGdhbWUuc3RhdGUuc3RhcnQoJ01haW5NZW51Jyk7XG4gIH0sIHRoaXMpO1xuXG59O1xuIiwiLypcbiogTWFpbiBNZW51IHN0YXRlXG4qID09PT09PT09PT09PT09PVxuKlxuKiBUaGUgcGxheWVyIHNob3VsZCBiZSBhYmxlIHRvIHJlc3RhcnQgYSBzYXZlZCBnYW1lIG9yIHN0YXJ0IGEgbmV3IGdhbWUuXG4qXG4qL1xuXG4ndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMuY3JlYXRlID0gZnVuY3Rpb24gKGdhbWUpIHtcblxuICAvL21pZ2h0IG5vdCBiZSBpbiBxdW90ZXMsIGl0cyBhbiBpc3N1ZSBiZWxvd1xuICBpZiAodHlwZW9mIGdhbWUubXVzaWMgIT09ICd1bmRlZmluZWQnICYmIGdhbWUubXVzaWMgIT09IG51bGwpXG4gICAgZ2FtZS5tdXNpYy5mYWRlT3V0KDEwMDApOyAvLyBmYWRlIG91dCBwcmV2aW91cyBtdXNpY1xuICBnYW1lLm11c2ljID0gZ2FtZS5zb3VuZC5wbGF5KCdtZW51LXRoZW1lLXRlcnJhZm9ybScpO1xuICBnYW1lLm11c2ljLmxvb3BGdWxsKDEpO1xuXG4gIHZhciBzY3JlZW4gPSBnYW1lLmFkZC5zcHJpdGUoZ2FtZS53b3JsZC5jZW50ZXJYLCBnYW1lLndvcmxkLmNlbnRlclksICdtZW51X3NjcmVlbicpO1xuICBzY3JlZW4uYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuICB2YXIgbG9nbyA9IGdhbWUuYWRkLnNwcml0ZShnYW1lLndvcmxkLmNlbnRlclgsIGdhbWUud29ybGQuY2VudGVyWSAtIDMwLCAncXVhc2FyaWEtbG9nby1NTScpO1xuICBsb2dvLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG4gIGxvZ28uYWxwaGEgPSAuMTtcblxuICBsZXQgc2NyZWVuRm9udCA9ICdDaW56ZWwgRGVjb3JhdGl2ZSc7XG4gIGxldCBmaWxsQ29sb3IgPSAnIzQyZGZmNCc7XG5cbiAgdmFyIHRpdGxlVGV4dCA9IGdhbWUuYWRkLnRleHQoZ2FtZS53b3JsZC5jZW50ZXJYLCBnYW1lLndvcmxkLmNlbnRlclktIDc1LCAnUXVhc2FyaWEnLCB7XG4gICAgZm9udDogJzc1cHggJyArIHNjcmVlbkZvbnQsXG4gICAgZm9udFdlaWdodDogJ2JvbGQnLFxuICAgIGZpbGw6IGZpbGxDb2xvcixcbiAgICBhbGlnbjogJ2NlbnRlcidcbiAgfSk7XG5cbiAgdmFyIGNvbnRUZXh0ID0gZ2FtZS5hZGQudGV4dChnYW1lLndvcmxkLmNlbnRlclgsIGdhbWUud29ybGQuY2VudGVyWSwgJ0NvbnRpbnVlJywge1xuICAgIGZvbnQ6ICc1MHB4ICcgKyBzY3JlZW5Gb250LFxuICAgIGZpbGw6IGZpbGxDb2xvcixcbiAgICBhbGlnbjogJ2NlbnRlcidcbiAgfSk7XG5cbiAgdmFyIG5ld0dhbWVUZXh0ID0gZ2FtZS5hZGQudGV4dChnYW1lLndvcmxkLmNlbnRlclgsIGdhbWUud29ybGQuY2VudGVyWSArIDU1LCAnTmV3IEdhbWUnLCB7XG4gICAgZm9udDogJzUwcHggJyArIHNjcmVlbkZvbnQsXG4gICAgZmlsbDogZmlsbENvbG9yLFxuICAgIGFsaWduOiAnY2VudGVyJ1xuICB9KTtcblxuICB0aXRsZVRleHQuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuXG4gIGNvbnRUZXh0LmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG4gIGNvbnRUZXh0LmlucHV0RW5hYmxlZCA9IHRydWU7XG4gIGNvbnRUZXh0LmV2ZW50cy5vbklucHV0T3Zlci5hZGQoZnVuY3Rpb24oKSB7XG4gICAgY29udFRleHQuZmlsbCA9ICcjZmYwMGZmJztcbiAgfSwgdGhpcyk7XG5cbiAgY29udFRleHQuZXZlbnRzLm9uSW5wdXRPdXQuYWRkKGZ1bmN0aW9uKCkge1xuICAgIGNvbnRUZXh0LmZpbGwgPSAnIzQyZGZmNCc7XG4gIH0sIHRoaXMpO1xuXG4gIGNvbnRUZXh0LmV2ZW50cy5vbklucHV0RG93bi5hZGQoZnVuY3Rpb24gKCkge1xuICAgIGxldCByZXN1bWVHYW1lID0gdHJ1ZTtcbiAgICBnYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJywgdHJ1ZSwgZmFsc2UsIGdhbWUsIHJlc3VtZUdhbWUpO1xuICB9LCB0aGlzKTtcblxuICBuZXdHYW1lVGV4dC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuICBuZXdHYW1lVGV4dC5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICBuZXdHYW1lVGV4dC5ldmVudHMub25JbnB1dE92ZXIuYWRkKGZ1bmN0aW9uKCkge1xuICAgIG5ld0dhbWVUZXh0LmZpbGwgPSAnI2ZmMDBmZic7XG4gIH0sIHRoaXMpO1xuXG4gIG5ld0dhbWVUZXh0LmV2ZW50cy5vbklucHV0T3V0LmFkZChmdW5jdGlvbigpIHtcbiAgICBuZXdHYW1lVGV4dC5maWxsID0gJyM0MmRmZjQnO1xuICB9LCB0aGlzKTtcblxuICBuZXdHYW1lVGV4dC5ldmVudHMub25JbnB1dERvd24uYWRkKGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcmVzdW1lR2FtZSA9IGZhbHNlO1xuICAgIGdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnLCB0cnVlLCBmYWxzZSwgZ2FtZSwgcmVzdW1lR2FtZSk7XG4gIH0sIHRoaXMpO1xuXG59O1xuIiwiLypcbiAqIFByZWxvYWRlciBzdGF0ZVxuICogPT09PT09PT09PT09PT09XG4gKlxuICogVGFrZXMgY2FyZSBvZiBsb2FkaW5nIHRoZSBtYWluIGdhbWUgYXNzZXRzLCBpbmNsdWRpbmcgZ3JhcGhpY3MgYW5kIHNvdW5kXG4gKiBlZmZlY3RzLCB3aGlsZSBkaXNwbGF5aW5nIGEgYnVzeSBzcGxhc2ggc2NyZWVuLlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIGFzc2V0cyA9IHJlcXVpcmUoJy4uL2Fzc2V0cycpO1xuXG5cbmZ1bmN0aW9uIHNob3dTcGxhc2hTY3JlZW4gKGdhbWUpIHtcbiAgZ2FtZS5hZGQuaW1hZ2UoMCwgMCwgJ3NwbGFzaC1zY3JlZW4nKTtcbiAgZ2FtZS5sb2FkLnNldFByZWxvYWRTcHJpdGUoZ2FtZS5hZGQuaW1hZ2UoODIsIDI4MiwgJ3Byb2dyZXNzLWJhcicpKTtcbn1cblxuZXhwb3J0cy5wcmVsb2FkID0gZnVuY3Rpb24gKGdhbWUpIHtcbiAgc2hvd1NwbGFzaFNjcmVlbihnYW1lKTtcbiAgZ2FtZS5sb2FkLnBhY2soJ2dhbWUnLCBudWxsLCBhc3NldHMpO1xuICBnYW1lLmxvYWQucGFjaygnbWFpbl9tZW51JywgbnVsbCwgYXNzZXRzKTtcbiAgZ2FtZS5sb2FkLnBhY2soJ3VpJywgbnVsbCwgYXNzZXRzKTtcbiAgZ2FtZS5sb2FkLnBhY2soJ2NvbnZlcnNhdGlvbnMnLCBudWxsLCBhc3NldHMpO1xuICBnYW1lLmxvYWQucGFjaygnc291bmRzJywgbnVsbCwgYXNzZXRzKTtcbiAgZ2FtZS5sb2FkLnBhY2soJ2xvZ2ljX2JhdHRsZScsIG51bGwsIGFzc2V0cyk7XG59O1xuXG5leHBvcnRzLmNyZWF0ZSA9IGZ1bmN0aW9uIChnYW1lKSB7XG4gIC8vIEhlcmUgaXMgYSBnb29kIHBsYWNlIHRvIGluaXRpYWxpemUgcGx1Z2lucyBkZXBlbmRlbnQgb2YgYW55IGdhbWUgYXNzZXQuXG4gIC8vIERvbid0IGZvcmdldCB0byBgcmVxdWlyZWAgdGhlbSBmaXJzdC4gRXhhbXBsZTpcbiAgLy9nYW1lLm15UGx1Z2luID0gZ2FtZS5wbHVnaW5zLmFkZChNeVBsdWdpbi8qLCAuLi4gcGFyYW1ldGVycyAuLi4gKi8pO1xuXG4gIC8vIFNsaWNrIFVJIGluaXRpYWxpemF0aW9uOyBhZGRlZCBmcm9tIGluZGV4Lmh0bWxcbiAgLy8gTk9URTogc2xpY2sgVUkgbG9hZHMgdGhlbWUgZnJvbSBjYWNoZVxuICAvLyBiZXR3ZWVuIHByZWxvYWQgYW5kIGNyZWF0ZSBmdW5jdGlvbnMgRk9SIEVBQ0ggU1RBVEVcbiAgZ2FtZS5zbGlja1VJID0gZ2FtZS5wbHVnaW5zLmFkZChQaGFzZXIuUGx1Z2luLlNsaWNrVUkpO1xuXG4gIGdhbWUuc3RhdGUuc3RhcnQoJ01haW5NZW51Jyk7XG5cbn07XG4iLCIvKlxuICogYHN0YXRlc2AgbW9kdWxlXG4gKiA9PT09PT09PT09PT09PT1cbiAqXG4gKiBEZWNsYXJlcyBhbGwgcHJlc2VudCBnYW1lIHN0YXRlcy5cbiAqIEV4cG9zZSB0aGUgcmVxdWlyZWQgZ2FtZSBzdGF0ZXMgdXNpbmcgdGhpcyBtb2R1bGUuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLkJvb3QgPSByZXF1aXJlKCcuL0Jvb3QnKTtcbmV4cG9ydHMuUHJlbG9hZGVyID0gcmVxdWlyZSgnLi9QcmVsb2FkZXInKTtcbmV4cG9ydHMuTWFpbk1lbnUgPSByZXF1aXJlKCcuL01haW5NZW51Jyk7XG5leHBvcnRzLkdhbWUgPSByZXF1aXJlKCcuL0dhbWUnKTtcbmV4cG9ydHMuQmF0dGxlZ3JvdW5kID0gcmVxdWlyZSgnLi9CYXR0bGVncm91bmQnKTtcbmV4cG9ydHMuR2FtZU92ZXIgPSByZXF1aXJlKCcuL0dhbWVPdmVyJyk7XG5leHBvcnRzLkNyZWRpdHMgPSByZXF1aXJlKCcuL0NyZWRpdHMnKTsiLCIvKlxuICogQ3VzdG9tIEFjdGlvbnNcbiAqID09PT09PT09PT09PT09PT09PT1cbiAqXG4gKiBTdG9yZXMgY29kZSBmb3IgY3VzdG9tIGFjdGlvbnMgdG8gYmUgdGFrZW4gZHVyaW5nIGNvbnZlcnNhdGlvbnMuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEN1c3RvbUFjdGlvbnM7XG5cbmZ1bmN0aW9uIEN1c3RvbUFjdGlvbnMoZ2FtZS8qLCAuLi5hcmdzKi8pIHtcbiAgUGhhc2VyLkdyb3VwLmNhbGwodGhpcywgZ2FtZS8qLCAuLi5hcmdzKi8pO1xuICB0aGlzLl9nYW1lID0gZ2FtZTtcbn1cblxuQ3VzdG9tQWN0aW9ucy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5Hcm91cC5wcm90b3R5cGUpO1xuQ3VzdG9tQWN0aW9ucy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDdXN0b21BY3Rpb25zO1xuXG5DdXN0b21BY3Rpb25zLnByb3RvdHlwZS5jdXN0b21BY3Rpb24gPSBmdW5jdGlvbihhY3Rpb24pIHtcbiAgaWYgKGFjdGlvbi5zdGFydHNXaXRoKCdmYWRlSW5BbmRPdXQnKSkge1xuICAgIHRoaXMuZmFkZUluQW5kT3V0KHBhcnNlSW50KGFjdGlvbi5zdWJzdHJpbmcoJ2ZhZGVJbkFuZE91dCcubGVuZ3RoKSkpO1xuICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gJ3N0YXJ0Q29udjpwcm9sb2d1ZTAyJykge1xuICAgIHRoaXMuX2dhbWUuY2FtZXJhLmZhZGUoJyMwMDAwMDAnLCAyMDAwKTtcbiAgICB0aGlzLl9nYW1lLmNhbWVyYS5vbkZhZGVDb21wbGV0ZS5hZGRPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZ2FtZS5jYW1lcmEuZmxhc2goJyMwMDAwMDAnLCAyMDAwKTtcbiAgICAgIHRoaXMuc3RhcnRDb252ZXJzYXRpb24oJ3Byb2xvZ3VlMDInKTtcbiAgICB9LCB0aGlzKTtcbiAgfSBlbHNlIGlmIChhY3Rpb24uc3RhcnRzV2l0aCgnbW92ZVRvQXJlYTonKSkge1xuICAgIHRoaXMubW92ZVRvQXJlYShhY3Rpb24uc3Vic3RyaW5nKCdtb3ZlVG9BcmVhOicubGVuZ3RoKSk7XG4gIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnc3RhcnRCYXR0bGUnKSB7XG4gICAgdGhpcy5sb2FkQmF0dGxlKCk7ICBcbiAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICdsb2FkTWFpbkdhbWVTdGF0ZScpIHtcbiAgICB0aGlzLl9nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJywgdHJ1ZSwgZmFsc2UsIHRoaXMuX2dhbWUsIGZhbHNlLCB0cnVlKTtcbiAgfSBlbHNlIGlmIChhY3Rpb24uc3RhcnRzV2l0aCgnZ2FtZW92ZXInKSkge1xuICAgIHRoaXMuX2dhbWUuc3RhdGUuc3RhcnQoJ0dhbWVPdmVyJywgdHJ1ZSwgZmFsc2UsIHRoaXMuX2dhbWUsIGFjdGlvbi5zdWJzdHJpbmcoJ2dhbWVvdmVyJy5sZW5ndGgpKTtcbiAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICdjcmVkaXRzJykge1xuICAgIHRoaXMuX2dhbWUuc3RhdGUuc3RhcnQoJ0NyZWRpdHMnLCB0cnVlLCBmYWxzZSwgdGhpcy5fZ2FtZSk7XG4gIH1cbn07XG5cblxuXG5cbkN1c3RvbUFjdGlvbnMucHJvdG90eXBlLmxvYWRCYXR0bGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5fZ2FtZS5kaWFsb2d1ZVdpbmRvdy5oaWRlKCk7XG4gIHRoaXMuX2dhbWUuc3RhdGUuc3RhcnQoJ0JhdHRsZWdyb3VuZCcsIHRydWUsIGZhbHNlKTtcbn07XG5cbkN1c3RvbUFjdGlvbnMucHJvdG90eXBlLnN0YXJ0Q29udmVyc2F0aW9uID0gZnVuY3Rpb24oY29udikge1xuICB0aGlzLl9nYW1lLmRpYWxvZ3VlV2luZG93LmJlZ2luKGNvbnYpO1xufTtcblxuQ3VzdG9tQWN0aW9ucy5wcm90b3R5cGUubW92ZVRvQXJlYSA9IGZ1bmN0aW9uKGFyZWEpIHtcbiAgdGhpcy5fZ2FtZS5yb29tLmxvYWRBcmVhKGFyZWEpO1xufTtcblxuQ3VzdG9tQWN0aW9ucy5wcm90b3R5cGUuZmFkZUluQW5kT3V0ID0gZnVuY3Rpb24oZHVyYXRpb24pIHtcbiAgdGhpcy5fZ2FtZS5jYW1lcmEuZmFkZSgnIzAwMDAwMCcsIGR1cmF0aW9uLzIpO1xuICB0aGlzLl9nYW1lLmRpYWxvZ3VlV2luZG93LmF2YXRhci52aXNpYmxlID0gZmFsc2U7XG4gIHRoaXMuX2dhbWUuZGlhbG9ndWVXaW5kb3cuZGlhbG9nUGFuZWwudmlzaWJsZSA9IGZhbHNlO1xuICB0aGlzLl9nYW1lLmNhbWVyYS5vbkZhZGVDb21wbGV0ZS5hZGRPbmNlKGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX2dhbWUuY2FtZXJhLmZsYXNoKCcjMDAwMDAwJywgZHVyYXRpb24vMik7XG4gICAgdGhpcy5fZ2FtZS5kaWFsb2d1ZVdpbmRvdy5hdmF0YXIudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy5fZ2FtZS5kaWFsb2d1ZVdpbmRvdy5kaWFsb2dQYW5lbC52aXNpYmxlID0gdHJ1ZTtcbiAgfSwgdGhpcyk7XG59OyIsIm1vZHVsZS5leHBvcnRzPXtcblx0XCJzaHV0dGxlXCI6IHtcblx0XHRcImlkXCI6IFwic2h1dHRsZVwiLFxuXHRcdFwibmFtZVwiOiBcIlNodXR0bGVcIixcblx0XHRcImJnXCI6IFwic2h1dHRsZVwiLFxuXHRcdFwibXVzaWNcIjogXCJwdXp6bGUyXCIsXG5cdFx0XCJpdGVtc1wiOiBbXG5cdFx0XHR7XG5cdFx0XHRcdFwiaWRcIjogXCJsaXN0ZW5lclwiLFxuXHRcdFx0XHRcInhcIjogMTUwLFxuXHRcdFx0XHRcInlcIjogMTUwLFxuXHRcdFx0XHRcImhlaWdodFwiOiAxMDAsXG5cdFx0XHRcdFwid2lkdGhcIjogMTAwXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiaWRcIjogXCJub3RlXCIsXG5cdFx0XHRcdFwieFwiOiA3MjAsXG5cdFx0XHRcdFwieVwiOiAyMDAsXG5cdFx0XHRcdFwiaGVpZ2h0XCI6IDEwMCxcblx0XHRcdFx0XCJ3aWR0aFwiOiAxMDBcblx0XHRcdH1cblx0XHRdLFxuXHRcdFwicGxhY2VhYmxlc1wiOiBbXSxcblx0XHRcIm5wY3NcIjogW10sXG5cdFx0XCJuYXZpZ2FibGVcIjogZmFsc2UsXG5cdFx0XCJhcmVhQWNjZXNzXCI6IFtdXG5cdH0sXG5cdFwiaGFuZ2FyXCI6IHtcblx0XHRcImlkXCI6IFwiaGFuZ2FyXCIsXG5cdFx0XCJuYW1lXCI6IFwiSGFuZ2FyIEJheVwiLFxuXHRcdFwiYmdcIjogXCJoYW5nYXJcIixcblx0XHRcIm11c2ljXCI6IFwibG9zdGp1bmdsZVwiLFxuXHRcdFwiaXRlbXNcIjogW10sXG5cdFx0XCJwbGFjZWFibGVzXCI6IFtcblx0XHRcdHtcblx0XHRcdFx0XCJpZFwiOiBcInNodXR0bGUtcGxhY2VhYmxlXCIsXG5cdFx0XHRcdFwieFwiOiA0NzUsXG5cdFx0XHRcdFwieVwiOiAzMDAsXG5cdFx0XHRcdFwiaGVpZ2h0XCI6IDMwMCxcblx0XHRcdFx0XCJ3aWR0aFwiOiA0MDFcblx0XHRcdH1cblx0XHRdLFxuXHRcdFwibnBjc1wiOiBbXG5cdFx0XHR7XG5cdFx0XHRcdFwiaWRcIjogXCJWZXNwZXJcIixcblx0XHRcdFx0XCJ4XCI6IDEwMCxcblx0XHRcdFx0XCJ5XCI6IDM1MCxcblx0XHRcdFx0XCJoZWlnaHRcIjogMzUwLFxuXHRcdFx0XHRcIndpZHRoXCI6IDE1MFxuXHRcdFx0fSwge1xuXHRcdFx0XHRcImlkXCI6IFwiR2xlYW1pbmcgU2hvYWxcIixcblx0XHRcdFx0XCJ4XCI6IDQwMCxcblx0XHRcdFx0XCJ5XCI6IDMwMCxcblx0XHRcdFx0XCJoZWlnaHRcIjogNDAwLFxuXHRcdFx0XHRcIndpZHRoXCI6IDQwMCxcblx0XHRcdFx0XCJzaG93aWZcIjoge1xuXHRcdFx0XHRcdFwieGVub3BzeWNob2xvZ2lzdFwiOiBcImRvbmVcIixcblx0XHRcdFx0XHRcInhlbm9iaW9sb2dpc3RcIjogXCJkb25lXCJcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdF0sXG5cdFx0XCJuYXZpZ2FibGVcIjogdHJ1ZSxcblx0XHRcImFyZWFBY2Nlc3NcIjogW1wibWVkYmF5XCJdXG5cdH0sXG5cdFwibWVkYmF5XCI6IHtcblx0XHRcImlkXCI6IFwibWVkYmF5XCIsXG5cdFx0XCJuYW1lXCI6IFwiTWVkaWNhbCBCYXlcIixcblx0XHRcImJnXCI6IFwibWVkYmF5XCIsXG5cdFx0XCJtdXNpY1wiOiBcInB1enpsZTFcIixcblx0XHRcIml0ZW1zXCI6IFtdLFxuXHRcdFwicGxhY2VhYmxlc1wiOiBbXSxcblx0XHRcIm5wY3NcIjogW1xuXHRcdFx0e1xuXHRcdFx0XHRcImlkXCI6IFwiRHIuIFRhbHZpbmUgTWVzbWVyLVF1aXZlcmx5XCIsXG5cdFx0XHRcdFwieFwiOiAzMjAsXG5cdFx0XHRcdFwieVwiOiAzNDAsXG5cdFx0XHRcdFwiaGVpZ2h0XCI6IDE4Myxcblx0XHRcdFx0XCJ3aWR0aFwiOiAxMDBcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJpZFwiOiBcIkRyLiBWYWxrZW5cIixcblx0XHRcdFx0XCJ4XCI6IDYwMCxcblx0XHRcdFx0XCJ5XCI6IDI1MCxcblx0XHRcdFx0XCJoZWlnaHRcIjogMzMwLFxuXHRcdFx0XHRcIndpZHRoXCI6IDExMi41XG5cdFx0XHR9XG5cdFx0XSxcblx0XHRcIm5hdmlnYWJsZVwiOiB0cnVlLFxuXHRcdFwiYXJlYUFjY2Vzc1wiOiBbXCJoYW5nYXJcIl1cblx0fVxufVxuIiwibW9kdWxlLmV4cG9ydHM9e1xuXHRcImxpc3RlbmVyXCI6IHtcblx0XHRcImlkXCI6IFwibGlzdGVuZXJcIixcblx0XHRcInVybFwiOiBcImxpc3RlbmVyLnBuZ1wiLFxuXHRcdFwibmFtZVwiOiBcIkxpc3RlbmVyXCIsXG5cdFx0XCJkZXNjXCI6IFwiQSBzbWFsbCwgcG9ja2V0LXNpemVkIGJsdWUgb3JiIHRoYXQgaXMgbm9ybWFsbHkgY29vbCB0byB0aGUgdG91Y2gsIGJ1dCB3YXJtcyB3aGVuIHlvdXIgbXlzdGVyaW91cyByZXNjdWVyIHVzZXMgaXQgdG8gY29tbXVuaWNhdGUgd2l0aCB5b3UuIEhlL3NoZSB0b2xkIHlvdSB0byBrZWVwIHRoaXMgc2FmZSwgYW5kIGxldCBubyBvbmUga25vdyBvZiBpdHMgdHJ1ZSBwdXJwb3NlLlwiXG5cdH0sXG5cdFwibm90ZVwiOiB7XG5cdFx0XCJpZFwiOiBcIm5vdGVcIixcblx0XHRcInVybFwiOiBcIm5vdGUucG5nXCIsXG5cdFx0XCJuYW1lXCI6IFwiSW5kZWNpcGhlcmFibGUgTm90ZVwiLFxuXHRcdFwiZGVzY1wiOiBcIkEgbm90ZSBjb3ZlcmVkIGluIHN0cmFuZ2UgYWxpZW4gc3ltYm9scy4gWW91ciBteXN0ZXJpb3VzIHJlc2N1ZXIgbGVmdCB0aGlzIGZvciB5b3UsIHNheWluZyBpdCB3b3VsZCBoZWxwIGV4cGxhaW4gdGhpbmdzLCBidXQgc28gZmFyIHlvdSBjYW4ndCB1bmRlcnN0YW5kIGl0LlwiXG5cdH0sXG5cdFwic2h1dHRsZS1wbGFjZWFibGVcIjoge1xuXHRcdFwiaWRcIjogXCJzaHV0dGxlLXBsYWNlYWJsZVwiLFxuXHRcdFwidXJsXCI6IFwic2h1dHRsZS1wbGFjZWFibGUucG5nXCIsXG5cdFx0XCJuYW1lXCI6IFwiTXkgU2h1dHRsZVwiLFxuXHRcdFwibWVzc2FnZVwiOiBcIlRoYXQncyBteSBzaHV0dGxlLCBidXQgSSBjYW4ndCBnbyBpbiB0aGVyZSByaWdodCBub3cuXCJcblx0fSxcblx0XCJiaW9sb2dpc3RBcHByb3ZhbFwiOiB7XG5cdFx0XCJpZFwiOiBcImJpb2xvZ2lzdEFwcHJvdmFsXCIsXG5cdFx0XCJ1cmxcIjogXCJ0YWx2aW5lLnBuZ1wiLFxuXHRcdFwibmFtZVwiOiBcIkRyLiBUYWx2aW5lJ3MgUmVwb3J0XCIsXG5cdFx0XCJkZXNjXCI6IFwiQSBjbGVhbiBiaWxsIG9mIGhlYWx0aCBmcm9tIERyLiBUYWx2aW5lIE1lc21lci1RdWl2ZXJseSwgU3RhdGlvbiBaZXJvJ3MgeGVub2Jpb2xvZ2lzdC5cIlxuXHR9LFxuXHRcInBzeWNob2xvZ2lzdEFwcHJvdmFsXCI6IHtcblx0XHRcImlkXCI6IFwicHN5Y2hvbG9naXN0QXBwcm92YWxcIixcblx0XHRcInVybFwiOiBcInZhbGtlbi5wbmdcIixcblx0XHRcIm5hbWVcIjogXCJEci4gVmFsa2VuJ3MgUmVwb3J0XCIsXG5cdFx0XCJkZXNjXCI6IFwiQSBicmllZmluZyBvbiB5b3VyIHBzeWNob2xvZ2ljYWwgc3RhdGUgZnJvbSBEci4gVmFsa2VuLCBTdGF0aW9uIFplcm8ncyB4ZW5vcHN5Y2hvbG9naXN0LlwiXG5cdH0sXG5cdFwic2VjcmV0YXJ5Tm90ZVwiOiB7XG5cdFx0XCJpZFwiOiBcInNlY3JldGFyeU5vdGVcIixcblx0XHRcInVybFwiOiBcInNlY3JldGFyeU5vdGUucG5nXCIsXG5cdFx0XCJuYW1lXCI6IFwiTWVtbyB0byBHYXJuZXR0YVwiLFxuXHRcdFwiZGVzY1wiOiBcIlxcXCJHYXJuZXR0YToga2VlcCB0YWxraW5nIHdpdGggQ2xlYXJhbmNlIHN0YWZmLiBZb3Ugd29uJ3QgYmUgaW50ZXJydXB0ZWQuXFxcIlwiXG5cdH1cbn0iLCJtb2R1bGUuZXhwb3J0cz17XG5cdFwiTXlzdGVyaW91cyBWb2ljZVwiOiB7XG5cdFx0XCJpZFwiOiBcIk15c3RlcmlvdXMgVm9pY2VcIixcblx0XHRcIm5hbWVcIjogXCJNeXN0ZXJpb3VzIFZvaWNlXCIsXG5cdFx0XCJpbWFnZVwiOiBcIm15c3RlcmlvdXMtdm9pY2VcIixcblx0XHRcImF2YXRhclwiOiBcIm15c3RlcmlvdXMtdm9pY2VcIixcblx0fSxcblx0XCJHbGVhbWluZyBTaG9hbFwiOiB7XG5cdFx0XCJpZFwiOiBcIkdsZWFtaW5nIFNob2FsXCIsXG5cdFx0XCJuYW1lXCI6IFwiR2xlYW1pbmcgU2hvYWxcIixcblx0XHRcImltYWdlXCI6IFwiZ2xlYW1pbmctc2hvYWwtbnBjXCIsXG5cdFx0XCJhdmF0YXJcIjogXCJnbGVhbWluZy1zaG9hbFwiLFxuXHRcdFwiY29udlwiOiBcImdsZWFtaW5nLXNob2FsMDFcIlxuXHR9LFxuXHRcIlVua25vd24gQWxpZW5cIjoge1xuXHRcdFwiaWRcIjogXCJHbGVhbWluZyBTaG9hbFwiLFxuXHRcdFwibmFtZVwiOiBcIlVua25vd24gQWxpZW5cIixcblx0XHRcImltYWdlXCI6IFwidW5rbm93bi1hbGllblwiLFxuXHRcdFwiYXZhdGFyXCI6IFwidW5rbm93bi1hbGllblwiXG5cdH0sXG5cdFwiS2lzbWV0XCI6IHtcblx0XHRcImlkXCI6IFwiS2lzbWV0XCIsXG5cdFx0XCJuYW1lXCI6IFwiS2lzbWV0XCIsXG5cdFx0XCJpbWFnZVwiOiBcImtpc21ldFwiLFxuXHRcdFwiYXZhdGFyXCI6IFwia2lzbWV0XCJcblx0fSxcblx0XCJWZXNwZXJcIjoge1xuXHRcdFwiaWRcIjogXCJWZXNwZXJcIixcblx0XHRcIm5hbWVcIjogXCJWZXNwZXJcIixcblx0XHRcImltYWdlXCI6IFwidmVzcGVyLW5wY1wiLFxuXHRcdFwiYXZhdGFyXCI6IFwidmVzcGVyXCIsXG5cdFx0XCJjb252XCI6IFwidmVzcGVyMDFcIlxuXHR9LFxuXHRcIkRyLiBUYWx2aW5lIE1lc21lci1RdWl2ZXJseVwiOiB7XG5cdFx0XCJpZFwiOiBcIkRyLiBUYWx2aW5lIE1lc21lci1RdWl2ZXJseVwiLFxuXHRcdFwibmFtZVwiOiBcIkRyLiBUYWx2aW5lXCIsXG5cdFx0XCJpbWFnZVwiOiBcInRhbHZpbmUtbnBjXCIsXG5cdFx0XCJhdmF0YXJcIjogXCJ0YWx2aW5lXCIsXG5cdFx0XCJjb252XCI6IFwidGFsdmluZTAxXCJcblx0fSxcblx0XCJEci4gVmFsa2VuXCI6IHtcblx0XHRcImlkXCI6IFwiRHIuIFZhbGtlblwiLFxuXHRcdFwibmFtZVwiOiBcIkRyLiBWYWxrZW5cIixcblx0XHRcImltYWdlXCI6IFwidmFsa2VuLW5wY1wiLFxuXHRcdFwiYXZhdGFyXCI6IFwidmFsa2VuXCIsXG5cdFx0XCJjb252XCI6IFwidmFsa2VuMDFcIlxuXHR9XG59IiwibW9kdWxlLmV4cG9ydHM9e1xuXHRcImNhbGwtYmx1ZmZcIjoge1xuXHRcdFwiaWRcIjogXCJjYWxsLWJsdWZmXCIsXG5cdFx0XCJ1cmxcIjogXCJjYWxsLWJsdWZmLnBuZ1wiLFxuXHRcdFwibmFtZVwiOiBcIkNhbGwgQmx1ZmZcIixcblx0XHRcImRlc2NcIjogXCJZb3VyIGFkdmVyc2FyeSBpcyB3aWxsaW5nIHRvIG1ha2Ugc29tZSBib2xkIGNsYWltcyB0byB3aW4gdGhpcyBhcmd1bWVudC4gQ2FsbCBvdXQgdGhlaXIgdW5zdWJzdGFudGlhdGVkIGJsdWZmcyBmb3Igd2hhdCB0aGV5IGFyZS5cIlxuXHR9XG59IiwibW9kdWxlLmV4cG9ydHM9e1xuXHRcInNwZWFrZXJcIjoge1xuXHRcdFwiZm9udFwiOiBcIjIwcHggR291ZHkgQm9va2xldHRlciAxOTExXCIsIFxuXHRcdFwiZmlsbFwiOiBcIiM0OGYyZmZcIiwgXG5cdFx0XCJ3b3JkV3JhcFwiOiBmYWxzZSwgXG5cdFx0XCJhbGlnblwiOiBcImxlZnRcIlxuXHR9LFxuXHRcImRpYWxvZ3VlQm9keVwiOiB7XG5cdFx0XCJmb250XCI6IFwiMTRweCBPcGVuIFNhbnNcIiwgXG5cdFx0XCJmaWxsXCI6IFwiIzQ4ZjJmZlwiLCBcblx0XHRcIndvcmRXcmFwXCI6IHRydWUsIFxuXHRcdC8vXCJ3b3JkV3JhcFdpZHRoXCI6IFwidGhpcy5fZGlhbG9nVGV4dFdpZHRoXCIsXG5cdFx0XCJhbGlnblwiOiBcImxlZnRcIlxuXHR9LFxuXHRcImNob2ljZUJ1dHRvblwiOiB7XG5cdFx0XCJmb250XCI6IFwiMTRweCBPcGVuIFNhbnNcIixcblx0XHRcImZpbGxcIjogXCIjNDhmMmZmXCIsIFxuXHRcdFwid29yZFdyYXBcIjogdHJ1ZSxcblx0XHQvL1wid29yZFdyYXBXaWR0aFwiOiB0aGlzLl9kaWFsb2dUZXh0V2lkdGggLSBidXR0b25TaWRlUGFkZGluZywgXG5cdFx0XCJhbGlnblwiOiBcImxlZnRcIlxuXHR9LFxuXHRcInRvYXN0XCI6IHtcblx0XHRcImZvbnRcIjogXCIxNHB4IE9wZW4gU2Fuc1wiLFxuXHRcdFwiZmlsbFwiOiBcIiM0OGYyZmZcIixcblx0XHRcImJvdW5kc0FsaWduSFwiOiBcImNlbnRlclwiXG5cdH0sXG5cdFwiY3JlZGliaWxpdHlcIjoge1xuXHRcdFwiZm9udFwiOiBcIjMycHggQ2luemVsIERlY29yYXRpdmVcIiwgXG5cdFx0XCJmb250V2VpZ2h0XCI6IFwiYm9sZFwiLFxuXHRcdFwiZmlsbFwiOiBcIiM0OGYyZmZcIiwgXG5cdFx0XCJib3VuZHNBbGlnbkhcIjogXCJjZW50ZXJcIiwgXG5cdFx0XCJib3VuZHNBbGlnblZcIjogXCJtaWRkbGVcIlxuXHR9LFxuXHRcIm1haW5NZW51VGl0bGVcIjoge1xuXHRcdFwiZm9udFwiOiBcIjc1cHggQ2luemVsIERlY29yYXRpdmVcIixcblx0XHRcImZvbnRXZWlnaHRcIjogXCJib2xkXCIsXG5cdFx0XCJmaWxsXCI6IFwiIzQyZGZmNFwiLFxuXHRcdFwiYWxpZ25cIjogXCJjZW50ZXJcIlxuXHR9LCBcbn0iXX0="}